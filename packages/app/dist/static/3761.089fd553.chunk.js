"use strict";(()=>{(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3761],{33761:(wn,Nt,q)=>{q.d(Nt,{A:()=>Ls,D:()=>fr,L:()=>he,T:()=>er,W:()=>Wt,a:()=>ii,b:()=>Dr,c:()=>tr,d:()=>os,e:()=>Ei,f:()=>An,g:()=>Bs,u:()=>Un});var p=q(2784),we=q(64279),ue=q(60885),L=q(12053),G=q(95544),Se=q(79692),Fe=q(60905),bt=q(90436),ft=q(4614),xt=q(97136),Ze=q(27556),nt=q(77277),_e=q(91256),mt=q(37390),mi=q(58987),Xt=q(89571),me=q(15584),ut=q(97485),Kt=q(82113),bi=q(27616),fi=q(8284),Et=q(70660),ui=q(56939),Oi=q(29611),Pt=q(94339),Ot=q(11776),Dt=q(12231),wt=q(86136),ai=q(49378),_t=q(80030),ei=q(61837),Ge=q(85256),Mi=q(72779),Xe=q.n(Mi),ae=q(38016),be=q(84905),ze=q(30705),ke=q(57032),Ee=q(49558),zt=q(7089),Le=q(94063),Yt=q(31011),et=q(73495),Pi=q(47603),Ft=q(56881),gt=q(26228),si=q(75951),rn=q.n(si),Zi=q(34520),te=q(25417),x=q(24579),C=q(82726),I=q(12420),N=q(87685),Z=q(49423),ee=q(96401),re=q(77120),xe=q(42123),He=q(65329);const Pe=V=>(V+1)%Number.MAX_SAFE_INTEGER;function Qe(){const[,V]=(0,p.useState)(0);return(0,p.useCallback)(()=>{V(Pe)},[])}var tt=q(60497),dt=q(50536),ti=q(58985),qt=q(16303);function $t(V,...z){const Q=(0,ti.t)(),ie=(0,dt.x)(z[1]),ce=(0,p.useMemo)(()=>function(...pe){Q()&&(typeof ie.current=="function"?ie.current.apply(this,pe):typeof ie.current.handleEvent=="function"&&ie.current.handleEvent.apply(this,pe))},[]);(0,p.useEffect)(()=>{const pe=V&&(0,qt.nr)(V,"current")?V.current:V;if(!pe)return;const ve=z.slice(2);return(0,qt.on)(pe,z[0],ce,...ve),()=>{(0,qt.S1)(pe,z[0],ce,...ve)}},[V,z[0]])}var jt=q(24947);const Ct=V=>typeof V=="function"?V:typeof V=="string"?z=>z.key===V:V?qt.cI:qt.Vp,Rt=jt.jU?window:null;function xi(V,z,Q,ie={}){const{event:ce="keydown",target:pe=Rt,eventOptions:ve}=ie,$e=(0,dt.x)(z),Tt=(0,p.useMemo)(()=>{const it=Ct(V);return function(Ae){it(Ae)&&$e.current.call(this,Ae)}},Q);$t(pe,ce,Tt,ve)}function st(V){const z=(0,p.useRef)();return(0,p.useEffect)(()=>{z.current=V}),z.current}var Ye=q(2552),Ve=q(10921),Jt=q(38402),ot=q(9520),rt=q(49166),yt=q(98281),lt=q(22983),Zt=q(28113),Bt=q(6487),pt=q(99152),gi=q(7896),hi=q(96234),yi=q(59740),on=q(6277),Ci=q(15459),Lt=q(24514),zi=p.createContext({});const Ni=zi;var qi={root:{padding:0,margin:0,listStyle:"none"}};function Ki(V,z){if(V.length!==z.length)return!0;for(var Q=0;Q<V.length;Q+=1)if(V[Q]!==z[Q])return!0;return!1}var Qi=function(z,Q,ie){for(var ce=Q;ce<z.length;ce+=1)if(ie===z[ce])return ce;return-1},ri=[],Ji=[],Vn=p.forwardRef(function(z,Q){var ie=z.children,ce=z.classes,pe=z.className,ve=z.defaultCollapseIcon,$e=z.defaultEndIcon,Tt=z.defaultExpanded,it=Tt===void 0?ri:Tt,Ae=z.defaultExpandIcon,Re=z.defaultParentIcon,Me=z.defaultSelected,vt=Me===void 0?Ji:Me,qe=z.disableSelection,St=qe===void 0?!1:qe,Ri=z.multiSelect,Bi=Ri===void 0?!1:Ri,Gi=z.expanded,Ai=z.onNodeSelect,Di=z.onNodeToggle,$i=z.selected,Vt=(0,yi.Z)(z,["children","classes","className","defaultCollapseIcon","defaultEndIcon","defaultExpanded","defaultExpandIcon","defaultParentIcon","defaultSelected","disableSelection","multiSelect","expanded","onNodeSelect","onNodeToggle","selected"]),Gn=p.useState(null),oi=Gn[0],Li=Gn[1],Xi=p.useState(null),en=Xi[0],Bn=Xi[1],li=p.useRef({}),ln=p.useRef({}),ji=p.useRef([]),Ws=(0,Lt.Z)({controlled:Gi,default:it,name:"TreeView",state:"expanded"}),nr=(0,hi.Z)(Ws,2),an=nr[0],Ii=nr[1],Xn=(0,Lt.Z)({controlled:$i,default:vt,name:"TreeView",state:"selected"}),Ln=(0,hi.Z)(Xn,2),Fi=Ln[0],In=Ln[1],vn=p.useCallback(function(Ke){return Array.isArray(an)?an.indexOf(Ke)!==-1:!1},[an]),ls=p.useCallback(function(Ke){return Array.isArray(Fi)?Fi.indexOf(Ke)!==-1:Fi===Ke},[Fi]),Hs=function(Te){return oi===Te},tn=function(Te){return en===Te},sr=function(Te){var Ce=ji.current.indexOf(Te);return Ce!==-1&&Ce+1<ji.current.length?ji.current[Ce+1]:null},Vs=function(Te){var Ce=ji.current.indexOf(Te);return Ce!==-1&&Ce-1>=0?ji.current[Ce-1]:null},as=function(){return ji.current[ji.current.length-1]},Nn=function(){return ji.current[0]},dn=function(Te){return li.current[Te].parent},Ss=function(Te,Ce){var We=ji.current.indexOf(Te),At=ji.current.indexOf(Ce),It=Math.min(We,At),ci=Math.max(We,At);return ji.current.slice(It,ci+1)},Fn=function(Te){Te&&(Li(Te),Bn(Te))},Wn=function(Te){return Fn(sr(Te))},Yn=function(Te){return Fn(Vs(Te))},qn=function(){return Fn(Nn())},Qn=function(){return Fn(as())},Hn=function(Te,Ce){var We,At,It=Ce.toLowerCase(),ci=[],Si=[];Object.keys(ln.current).forEach(function(pn){var gr=ln.current[pn],Cs=li.current[pn],yr=Cs.parent?vn(Cs.parent):!0;yr&&(ci.push(pn),Si.push(gr))}),We=ci.indexOf(Te)+1,We===li.current.length&&(We=0),At=Qi(Si,We,It),At===-1&&(At=Qi(Si,0,It)),At>-1&&Fn(ci[At])},zs=function(Te){var Ce=arguments.length>1&&arguments[1]!==void 0?arguments[1]:en,We;an.indexOf(Ce)!==-1?(We=an.filter(function(At){return At!==Ce}),Li(function(At){var It=li.current[At];return At&&(It&&It.parent?It.parent.id:null)===Ce?Ce:At})):We=[Ce].concat(an),Di&&Di(Te,We),Ii(We)},wi=function(Te,Ce){var We=li.current[Ce],At=li.current[We.parent],It;if(At)It=At.children.filter(function(pn){return!vn(pn)});else{var ci=li.current[-1].children;It=ci.filter(function(pn){return!vn(pn)})}var Si=an.concat(It);It.length>0&&(Ii(Si),Di&&Di(Te,Si))},bn=p.useRef(null),Mt=p.useRef(!1),xn=p.useRef([]),hs=function(Te,Ce){var We=Fi,At=Ce.start,It=Ce.next,ci=Ce.current;!It||!ci||(xn.current.indexOf(ci)===-1&&(xn.current=[]),Mt.current?xn.current.indexOf(It)!==-1?(We=We.filter(function(Si){return Si===At||Si!==ci}),xn.current=xn.current.filter(function(Si){return Si===At||Si!==ci})):(We.push(It),xn.current.push(It)):(We.push(It),xn.current.push(ci,It)),Ai&&Ai(Te,We),In(We))},cs=function(Te,Ce){var We=Fi,At=Ce.start,It=Ce.end;Mt.current&&(We=Fi.filter(function(pn){return xn.current.indexOf(pn)===-1}));var ci=Ss(At,It);xn.current=ci;var Si=We.concat(ci);Si=Si.filter(function(pn,gr){return Si.indexOf(pn)===gr}),Ai&&Ai(Te,Si),In(Si)},rr=function(Te,Ce){var We=[];Fi.indexOf(Ce)!==-1?We=Fi.filter(function(At){return At!==Ce}):We=[Ce].concat(Fi),Ai&&Ai(Te,We),In(We)},mr=function(Te,Ce){var We=Bi?[Ce]:Ce;Ai&&Ai(Te,We),In(We)},ks=function(Te,Ce){var We=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;return Ce?(We?rr(Te,Ce):mr(Te,Ce),bn.current=Ce,Mt.current=!1,xn.current=[],!0):!1},Wi=function(Te,Ce){var We=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,At=Ce.start,It=At===void 0?bn.current:At,ci=Ce.end,Si=Ce.current;return We?hs(Te,{start:It,next:ci,current:Si}):cs(Te,{start:It,end:ci}),Mt.current=!0,!0},Oe=function(Te,Ce){bn.current||(bn.current=Ce);var We=Mt.current?bn.current:Ce;return Wi(Te,{start:We,end:Nn()})},ni=function(Te,Ce){bn.current||(bn.current=Ce);var We=Mt.current?bn.current:Ce;return Wi(Te,{start:We,end:as()})},_n=function(Te,Ce){return Wi(Te,{end:sr(Ce),current:Ce},!0)},fs=function(Te,Ce){return Wi(Te,{end:Vs(Ce),current:Ce},!0)},Wr=function(Te){return Wi(Te,{start:Nn(),end:as()})},es=function(Te,Ce){var We=li.current[Te];li.current[Te]=(0,gi.Z)({},We,{children:Ce,id:Te}),Ce.forEach(function(At){var It=li.current[At];li.current[At]=(0,gi.Z)({},It,{parent:Te,id:At})})},$s=p.useCallback(function(Ke){var Te=li.current[Ke],Ce=[];return Te&&(Ce.push(Ke),Te.children&&(Ce.concat(Te.children),Te.children.forEach(function(We){Ce.concat($s(We))}))),Ce},[]),nn=p.useCallback(function(Ke){var Te=(0,gi.Z)({},ln.current);Ke.forEach(function(Ce){Te[Ce]&&delete Te[Ce]}),ln.current=Te},[]),us=p.useCallback(function(Ke){var Te=$s(Ke);nn(Te);var Ce=(0,gi.Z)({},li.current);Te.forEach(function(We){var At=Ce[We];if(At){if(At.parent){var It=Ce[At.parent];if(It&&It.children){var ci=It.children.filter(function(Si){return Si!==We});Ce[At.parent]=(0,gi.Z)({},It,{children:ci})}}delete Ce[We]}}),li.current=Ce,Bn(function(We){return We===Ke?null:We})},[$s,nn]),js=function(Te,Ce){ln.current[Te]=Ce},or=p.useRef([]),Zs=p.useState(!1),Hi=Zs[0],Hr=Zs[1];p.useEffect(function(){var Ke=[];p.Children.forEach(ie,function(Te){p.isValidElement(Te)&&Te.props.nodeId&&Ke.push(Te.props.nodeId)}),Ki(or.current,Ke)&&(li.current[-1]={parent:null,children:Ke},Ke.forEach(function(Te,Ce){Ce===0&&Li(Te)}),ji.current=li.current[-1].children,or.current=Ke,Hr(!0))},[ie]),p.useEffect(function(){var Ke=function Te(Ce){for(var We=[],At=0;At<Ce.length;At+=1){var It=Ce[At];We.push(It);var ci=li.current[It].children;vn(It)&&ci&&(We=We.concat(Te(ci)))}return We};Hi&&(ji.current=Ke(li.current[-1].children))},[an,Hi,vn,ie]);var ds=function(){return!1};return p.createElement(Ni.Provider,{value:{icons:{defaultCollapseIcon:ve,defaultExpandIcon:Ae,defaultParentIcon:Re,defaultEndIcon:$e},focus:Fn,focusFirstNode:qn,focusLastNode:Qn,focusNextNode:Wn,focusPreviousNode:Yn,focusByFirstCharacter:Hn,expandAllSiblings:wi,toggleExpansion:zs,isExpanded:vn,isFocused:tn,isSelected:ls,selectNode:St?ds:ks,selectRange:St?ds:Wi,selectNextNode:St?ds:_n,selectPreviousNode:St?ds:fs,rangeSelectToFirst:St?ds:Oe,rangeSelectToLast:St?ds:ni,selectAllNodes:St?ds:Wr,isTabbable:Hs,multiSelect:Bi,getParent:dn,mapFirstChar:js,addNodeToNodeMap:es,removeNodeFromNodeMap:us}},p.createElement("ul",(0,gi.Z)({role:"tree","aria-multiselectable":Bi,className:(0,on.default)(ce.root,pe),ref:Q},Vt),ie))});const fn=(0,Ci.Z)(qi,{name:"MuiTreeView"})(Vn);var vi=q(51209),kn=q(41128),Cn=q(60364),ns=q(85974),On=function(z){return{root:{listStyle:"none",margin:0,padding:0,outline:0,WebkitTapHighlightColor:"transparent","&:focus > $content $label":{backgroundColor:z.palette.action.hover},"&$selected > $content $label":{backgroundColor:(0,kn.Fq)(z.palette.primary.main,z.palette.action.selectedOpacity)},"&$selected > $content $label:hover, &$selected:focus > $content $label":{backgroundColor:(0,kn.Fq)(z.palette.primary.main,z.palette.action.selectedOpacity+z.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},expanded:{},selected:{},group:{margin:0,padding:0,marginLeft:17},content:{width:"100%",display:"flex",alignItems:"center",cursor:"pointer"},iconContainer:{marginRight:4,width:15,display:"flex",flexShrink:0,justifyContent:"center","& svg":{fontSize:18}},label:{width:"100%",paddingLeft:4,position:"relative","&:hover":{backgroundColor:z.palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}}}}},R=function(z){return z&&z.length===1&&z.match(/\S/)},a=p.forwardRef(function(z,Q){var ie=z.children,ce=z.classes,pe=z.className,ve=z.collapseIcon,$e=z.endIcon,Tt=z.expandIcon,it=z.icon,Ae=z.label,Re=z.nodeId,Me=z.onClick,vt=z.onLabelClick,qe=z.onIconClick,St=z.onFocus,Ri=z.onKeyDown,Bi=z.onMouseDown,Gi=z.TransitionComponent,Ai=Gi===void 0?Kt.Z:Gi,Di=z.TransitionProps,$i=(0,yi.Z)(z,["children","classes","className","collapseIcon","endIcon","expandIcon","icon","label","nodeId","onClick","onLabelClick","onIconClick","onFocus","onKeyDown","onMouseDown","TransitionComponent","TransitionProps"]),Vt=p.useContext(Ni),Gn=Vt.icons,oi=Vt.focus,Li=Vt.focusFirstNode,Xi=Vt.focusLastNode,en=Vt.focusNextNode,Bn=Vt.focusPreviousNode,li=Vt.focusByFirstCharacter,ln=Vt.selectNode,ji=Vt.selectRange,Ws=Vt.selectNextNode,nr=Vt.selectPreviousNode,an=Vt.rangeSelectToFirst,Ii=Vt.rangeSelectToLast,Xn=Vt.selectAllNodes,Ln=Vt.expandAllSiblings,Fi=Vt.toggleExpansion,In=Vt.isExpanded,vn=Vt.isFocused,ls=Vt.isSelected,Hs=Vt.isTabbable,tn=Vt.multiSelect,sr=Vt.getParent,Vs=Vt.mapFirstChar,as=Vt.addNodeToNodeMap,Nn=Vt.removeNodeFromNodeMap,dn=p.useRef(null),Ss=p.useRef(null),Fn=(0,ns.Z)(dn,Q),Wn=it,Yn=Boolean(Array.isArray(ie)?ie.length:ie),qn=In?In(Re):!1,Qn=vn?vn(Re):!1,Hn=Hs?Hs(Re):!1,zs=ls?ls(Re):!1,wi=Gn||{},bn=(0,Cn.Z)();Wn||(Yn?(qn?Wn=ve||wi.defaultCollapseIcon:Wn=Tt||wi.defaultExpandIcon,Wn||(Wn=wi.defaultParentIcon)):Wn=$e||wi.defaultEndIcon);var Mt=function(Oe){Qn||oi(Re);var ni=tn&&(Oe.shiftKey||Oe.ctrlKey||Oe.metaKey);Yn&&!Oe.defaultPrevented&&!(ni&&In(Re))&&Fi(Oe,Re),ni?Oe.shiftKey?ji(Oe,{end:Re}):ln(Oe,Re,!0):ln(Oe,Re),Me&&Me(Oe)},xn=function(Oe){(Oe.shiftKey||Oe.ctrlKey||Oe.metaKey)&&Oe.preventDefault(),Bi&&Bi(Oe)},hs=function(Oe){return Yn&&(qn?en(Re):Fi(Oe)),!0},cs=function(Oe){if(qn)return Fi(Oe,Re),!0;var ni=sr(Re);return ni?(oi(ni),!0):!1},rr=function(Oe){var ni=!1,_n=Oe.key;if(!(Oe.altKey||Oe.currentTarget!==Oe.target)){var fs=Oe.ctrlKey||Oe.metaKey;switch(_n){case" ":dn.current===Oe.currentTarget&&(tn&&Oe.shiftKey?ni=ji(Oe,{end:Re}):tn?ni=ln(Oe,Re,!0):ni=ln(Oe,Re)),Oe.stopPropagation();break;case"Enter":dn.current===Oe.currentTarget&&Yn&&(Fi(Oe),ni=!0),Oe.stopPropagation();break;case"ArrowDown":tn&&Oe.shiftKey&&Ws(Oe,Re),en(Re),ni=!0;break;case"ArrowUp":tn&&Oe.shiftKey&&nr(Oe,Re),Bn(Re),ni=!0;break;case"ArrowRight":bn.direction==="rtl"?ni=cs(Oe):ni=hs(Oe);break;case"ArrowLeft":bn.direction==="rtl"?ni=hs(Oe):ni=cs(Oe);break;case"Home":tn&&fs&&Oe.shiftKey&&an(Oe,Re),Li(),ni=!0;break;case"End":tn&&fs&&Oe.shiftKey&&Ii(Oe,Re),Xi(),ni=!0;break;default:_n==="*"?(Ln(Oe,Re),ni=!0):tn&&fs&&_n.toLowerCase()==="a"?ni=Xn(Oe):!fs&&!Oe.shiftKey&&R(_n)&&(li(Re,_n),ni=!0)}ni&&(Oe.preventDefault(),Oe.stopPropagation()),Ri&&Ri(Oe)}},mr=function(Oe){!Qn&&Oe.currentTarget===Oe.target&&oi(Re),St&&St(Oe)};p.useEffect(function(){if(as){var Wi=[];p.Children.forEach(ie,function(Oe){p.isValidElement(Oe)&&Oe.props.nodeId&&Wi.push(Oe.props.nodeId)}),as(Re,Wi)}},[ie,Re,as]),p.useEffect(function(){if(Nn)return function(){Nn(Re)}},[Re,Nn]),p.useEffect(function(){Vs&&Ae&&Vs(Re,Ss.current.textContent.substring(0,1).toLowerCase())},[Vs,Re,Ae]),p.useEffect(function(){Qn&&dn.current.focus()},[Qn]);var ks;return tn?ks=zs:zs&&(ks=!0),p.createElement("li",(0,gi.Z)({className:(0,on.default)(ce.root,pe,qn&&ce.expanded,zs&&ce.selected),role:"treeitem",onKeyDown:rr,onFocus:mr,"aria-expanded":Yn?qn:null,"aria-selected":ks,ref:Fn,tabIndex:Hn?0:-1},$i),p.createElement("div",{className:ce.content,onClick:Mt,onMouseDown:xn,ref:Ss},p.createElement("div",{onClick:qe,className:ce.iconContainer},Wn),p.createElement(bt.Z,{onClick:vt,component:"div",className:ce.label},Ae)),ie&&p.createElement(Ai,(0,gi.Z)({unmountOnExit:!0,className:ce.group,in:qn,component:"ul",role:"group"},Di),ie))});const d=(0,Ci.Z)(On,{name:"MuiTreeItem"})(a);var v=q(52160),w=q(31377),E=q(34546),D=q(31625),H=q(16874),j=q(19126),ne=q.n(j),fe=q(73557),ye=q(70218);const Ne=({error:V})=>{const z=(0,p.useRef)("");return(0,p.useEffect)(()=>{z.current=String(Math.random())},[V]),V?p.createElement(G.Z,null,p.createElement(Ee.SX,{id:z.current,variant:"warning",message:V.message})):null},Be=(0,Se.Z)({svgIcon:{display:"inline-block","& svg":{display:"inline-block",fontSize:"inherit",verticalAlign:"baseline"}}}),Ut=V=>{const{href:z,text:Q,Icon:ie,...ce}=V,pe=Be();return p.createElement(Fe.Z,{container:!0,direction:"row",spacing:1},p.createElement(Fe.Z,{item:!0},p.createElement(bt.Z,{component:"div",className:pe.svgIcon},ie?p.createElement(ie,null):p.createElement(v.Z,null))),p.createElement(Fe.Z,{item:!0},p.createElement(Ee.rU,{to:z,...ce},Q||z)))},di=({output:V})=>{const{links:z=[]}=V,Q=(0,ze.qD)(),ie=(0,ze.tg)(et.wi),ce=pe=>{var ve;return pe&&(ve=Q.getSystemIcon(pe))!=null?ve:v.Z};return p.createElement(G.Z,{px:3,pb:3},z.filter(({url:pe,entityRef:ve})=>pe||ve).map(({url:pe,entityRef:ve,title:$e,icon:Tt})=>{if(ve){const it=(0,Zi.of)(ve,{defaultKind:"<unknown>",defaultNamespace:"<unknown>"}),Ae=ie(it);return{title:$e,icon:Tt,url:Ae}}return{title:$e,icon:Tt,url:pe}}).map(({url:pe,title:ve,icon:$e},Tt)=>p.createElement(Ut,{key:`output-link-${Tt}`,href:pe,text:ve!=null?ve:pe,Icon:ce($e),target:"_blank"})))},pi=(0,Se.Z)(V=>(0,I.Z)({root:{width:"100%"},button:{marginBottom:V.spacing(2),marginLeft:V.spacing(2)},actionsContainer:{marginBottom:V.spacing(2)},resetContainer:{padding:V.spacing(3)},labelWrapper:{display:"flex",flex:1,flexDirection:"row",justifyContent:"space-between"},stepWrapper:{width:"100%"}})),zn=({step:V})=>{const[z,Q]=(0,p.useState)("");return(0,ye.Z)(()=>{if(!V.startedAt){Q("");return}const ie=V.endedAt?gt.ou.fromISO(V.endedAt):gt.ou.local(),ce=gt.ou.fromISO(V.startedAt),pe=gt.Xp.fromDateTimes(ce,ie).toDuration().valueOf();Q(rn()(pe,{round:!0}))},1e3),p.createElement(bt.Z,{variant:"caption"},z)},mn=(0,Se.Z)(V=>(0,I.Z)({root:{color:V.palette.text.disabled,display:"flex",height:22,alignItems:"center"},completed:{color:V.palette.status.ok},error:{color:V.palette.status.error}}));function Pn(V){const z=mn(),{active:Q,completed:ie,error:ce}=V,pe=()=>Q?p.createElement(ft.Z,{size:"24px"}):ie?p.createElement(yt.Z,null):ce?p.createElement(rt.Z,null):p.createElement(H.Z,null);return p.createElement("div",{className:Xe()(z.root,{[z.completed]:ie,[z.error]:ce})},pe())}const Gt=(0,p.memo)(V=>{const{steps:z,currentStepId:Q,onUserStepChange:ie}=V,ce=pi(V);return p.createElement("div",{className:ce.root},p.createElement(D.Z,{activeStep:z.findIndex(pe=>pe.id===Q),orientation:"vertical",nonLinear:!0},z.map((pe,ve)=>{const $e=pe.status==="cancelled",Tt=pe.status==="processing",it=pe.status==="completed",Ae=pe.status==="failed",Re=pe.status==="skipped";return p.createElement(w.Z,{key:String(ve),expanded:!0},p.createElement(xt.Z,{onClick:()=>ie(pe.id)},p.createElement(E.Z,{StepIconProps:{completed:it,error:Ae||$e,active:Tt},StepIconComponent:Pn,className:ce.stepWrapper},p.createElement("div",{className:ce.labelWrapper},p.createElement(bt.Z,{variant:"subtitle2"},pe.name),Re?p.createElement(bt.Z,{variant:"caption"},"Skipped"):p.createElement(zn,{step:pe})))))})))}),Rs=({links:V=[]})=>V.length>0,Bs=V=>{const{loadingText:z}=V,Q=pi(),ie=(0,fe.s0)(),ce=(0,ze.tg)(Le.r),pe=(0,ke.u)(ue.s),ve=(0,ze.tg)(Le.o),[$e,Tt]=(0,p.useState)(void 0),[it,Ae]=(0,p.useState)(!1),[Re,Me]=(0,p.useState)(void 0),{taskId:vt}=(0,ze.Oi)(Le.w),qe=(0,L.WQ)(vt),St=qe.completed,Ri=qe.cancelled,Bi=(0,p.useMemo)(()=>{var oi,Li;return(Li=(oi=qe.task)==null?void 0:oi.spec.steps.map(Xi=>{var en;return{...Xi,...(en=qe==null?void 0:qe.steps)==null?void 0:en[Xi.id]}}))!=null?Li:[]},[qe]);(0,p.useEffect)(()=>{var oi;const Li=Bi.find(Xi=>["failed","processing"].includes(Xi.status));if(St&&!Li){Me((oi=Bi[Bi.length-1])==null?void 0:oi.id);return}Me(Li==null?void 0:Li.id)},[Bi,St]);const Gi=$e!=null?$e:Re,Ai=(0,p.useMemo)(()=>{if(!Gi)return z||"Loading...";const oi=qe.stepLogs[Gi];return oi!=null&&oi.length?oi.join(`
`):"Waiting for logs..."},[qe.stepLogs,Gi,z]),Di=qe.completed&&!qe.loading&&!qe.task,{output:$i}=qe,Vt=()=>{var oi,Li,Xi;if(!qe.task||!((Li=(oi=qe.task)==null?void 0:oi.spec.templateInfo)!=null&&Li.entityRef)){ie(ce());return}const en=qe.task.spec.parameters,{name:Bn,namespace:li}=(0,Zi.of)((Xi=qe.task.spec.templateInfo)==null?void 0:Xi.entityRef);ie(`${ve({templateName:Bn,namespace:li})}?${ne().stringify({formData:JSON.stringify(en)})}`)},Gn=async()=>{Ae(!0),await pe.cancelTask(vt)};return p.createElement(Ee.T3,{themeId:"home"},p.createElement(Ee.h4,{pageTitleOverride:`Task ${vt}`,title:"Task Activity",subtitle:`Activity for task: ${vt}`}),p.createElement(Ee.VY,null,Di?p.createElement(Ee.mf,{status:"404",statusMessage:"Task not found",additionalInfo:"No task found with this ID"}):p.createElement("div",null,p.createElement(Fe.Z,{container:!0},p.createElement(Fe.Z,{item:!0,xs:3},p.createElement(Ze.Z,null,p.createElement(Gt,{steps:Bi,currentStepId:Gi,onUserStepChange:Tt}),$i&&Rs($i)&&p.createElement(di,{output:$i}),p.createElement(nt.Z,{className:Q.button,onClick:Vt,disabled:!St,variant:"contained",color:"primary"},"Start Over"),p.createElement(nt.Z,{className:Q.button,onClick:Gn,disabled:St||Ri||it,variant:"outlined",color:"secondary"},(Ri||it)&&!St?"Cancelling...":"Cancel"))),p.createElement(Fe.Z,{item:!0,xs:9},!Gi&&p.createElement(Ee.Ex,null),p.createElement("div",{style:{height:"80vh"}},p.createElement(Ne,{error:qe.error}),p.createElement(Ee.nU,{text:Ai})))))))},qs=(0,Se.Z)(V=>({code:{fontFamily:"Menlo, monospace",padding:V.spacing(1),backgroundColor:V.palette.type==="dark"?V.palette.grey[700]:V.palette.grey[300],display:"inline-block",borderRadius:5,border:`1px solid ${V.palette.grey[500]}`,position:"relative"},codeRequired:{"&::after":{position:"absolute",content:'"*"',top:0,right:V.spacing(.5),fontWeight:"bolder",color:V.palette.error.light}}})),vs=V=>p.createElement(Fe.Z,{container:!0},V.examples.map((z,Q)=>p.createElement(p.Fragment,{key:`example-${Q}`},p.createElement(Fe.Z,{item:!0,lg:3},p.createElement(G.Z,{padding:4},p.createElement(bt.Z,null,z.description))),p.createElement(Fe.Z,{item:!0,lg:9},p.createElement(G.Z,{padding:1},p.createElement(Ee.Oi,{text:z.example,showLineNumbers:!0,showCopyCodeButton:!0,language:"yaml"})))))),Ls=()=>{const V=(0,ke.u)(ue.s),z=qs(),{loading:Q,value:ie,error:ce}=(0,we.default)(async()=>V.listActions()),[pe,ve]=(0,p.useState)({});if(Q)return p.createElement(Ee.Ex,null);if(ce)return p.createElement(Ee.mf,{statusMessage:"Failed to load installed actions",status:"500"});const $e=Me=>!Me||Me.length<1?p.createElement(bt.Z,null,"No schema defined"):p.createElement(_e.Z,{component:Ze.Z},p.createElement(mt.Z,{size:"small"},p.createElement(mi.Z,null,p.createElement(Xt.Z,null,p.createElement(me.Z,null,"Name"),p.createElement(me.Z,null,"Title"),p.createElement(me.Z,null,"Description"),p.createElement(me.Z,null,"Type"))),p.createElement(ut.Z,null,Me))),Tt=Me=>{var vt,qe;return Me.type?Me.type!=="array"?[Me.type].flat():[`${Me.type}(${(qe=(vt=Me.items)==null?void 0:vt.type)!=null?qe:"unknown"})`]:["unknown"]},it=(Me,vt)=>{const qe=vt==null?void 0:vt.properties;if(qe)return Object.entries(qe).map(St=>{var Ri,Bi,Gi;const[Ai]=St,Di=`${Me}.${Ai}`,$i=St[1],Vt=Xe()(z.code,{[z.codeRequired]:(Ri=vt.required)==null?void 0:Ri.includes(Ai)}),Gn=Tt($i);return p.createElement(p.Fragment,{key:Di},p.createElement(Xt.Z,{key:Di},p.createElement(me.Z,null,p.createElement("div",{className:Vt},Ai)),p.createElement(me.Z,null,$i.title),p.createElement(me.Z,null,$i.description),p.createElement(me.Z,null,Gn.map(oi=>oi.includes("object")?p.createElement(zt.Z,{label:oi,key:oi,icon:pe[Di]?p.createElement(be.Z,null):p.createElement(ae.Z,null),variant:"outlined",onClick:()=>ve(Li=>{const Xi={...Li};return Xi[Di]=!Li[Di],Xi})}):p.createElement(zt.Z,{label:oi,key:oi,variant:"outlined"})))),p.createElement(Xt.Z,null,p.createElement(me.Z,{style:{paddingBottom:0,paddingTop:0},colSpan:6},p.createElement(Kt.Z,{in:pe[Di],timeout:"auto",unmountOnExit:!0},p.createElement(G.Z,{sx:{margin:1}},p.createElement(bt.Z,{variant:"h6",component:"div"},Ai),$e(it(Di,$i.type==="array"?{properties:(Gi=(Bi=$i.items)==null?void 0:Bi.properties)!=null?Gi:{}}:$i)))))))})},Ae=(Me,vt,qe)=>{if(qe)return p.createElement(p.Fragment,null,p.createElement(bt.Z,{variant:"h6",component:"h4"},Me),qe.map((St,Ri)=>p.createElement("div",{key:Ri},$e(it(`${vt}.${Ri}`,St)))))},Re=ie==null?void 0:ie.map(Me=>{var vt,qe,St,Ri,Bi,Gi;if(Me.id.startsWith("legacy:"))return;const Ai=Ae("oneOf",`${Me.id}.input`,(qe=(vt=Me.schema)==null?void 0:vt.input)==null?void 0:qe.oneOf);return p.createElement(G.Z,{pb:4,key:Me.id},p.createElement(bt.Z,{variant:"h4",component:"h2",className:z.code},Me.id),Me.description&&p.createElement(Ee.SA,{content:Me.description}),((St=Me.schema)==null?void 0:St.input)&&p.createElement(G.Z,{pb:2},p.createElement(bt.Z,{variant:"h5",component:"h3"},"Input"),$e(it(`${Me.id}.input`,(Ri=Me==null?void 0:Me.schema)==null?void 0:Ri.input)),Ai),((Bi=Me.schema)==null?void 0:Bi.output)&&p.createElement(G.Z,{pb:2},p.createElement(bt.Z,{variant:"h5",component:"h3"},"Output"),$e(it(`${Me.id}.output`,(Gi=Me==null?void 0:Me.schema)==null?void 0:Gi.output))),Me.examples&&p.createElement(bi.Z,null,p.createElement(fi.Z,{expandIcon:p.createElement(ae.Z,null)},p.createElement(bt.Z,{variant:"h5",component:"h3"},"Examples")),p.createElement(Et.Z,null,p.createElement(G.Z,{pb:2},p.createElement(vs,{examples:Me.examples})))))});return p.createElement(Ee.T3,{themeId:"home"},p.createElement(Ee.h4,{pageTitleOverride:"Create a New Component",title:"Installed actions",subtitle:"This is the collection of all installed actions"}),p.createElement(Ee.VY,null,Re))},bs=V=>{var z;const{setSecrets:Q,secrets:ie}=(0,ue.u)(),{name:ce,onChange:pe,schema:{title:ve,description:$e},rawErrors:Tt,disabled:it,errors:Ae,required:Re}=V;return p.createElement(Yt.Q0,{rawErrors:Tt,rawDescription:$e,disabled:it,errors:Ae,required:Re},p.createElement(ui.Z,{htmlFor:ve},ve),p.createElement(Oi.Z,{id:ve,"aria-describedby":ve,onChange:Me=>{var vt,qe;pe(Array((vt=Me.target)==null?void 0:vt.value.length).fill("*").join("")),Q({[ce]:(qe=Me.target)==null?void 0:qe.value})},value:(z=ie[ce])!=null?z:"",type:"password",autoComplete:"off"}))},An=[{component:Le.y,name:"EntityPicker",schema:Le.z},{component:Le.A,name:"EntityNamePicker",validation:Le.B,schema:Le.C},{component:Le.D,name:"EntityTagsPicker",schema:Le.F},{component:Le.G,name:"RepoUrlPicker",validation:Le.i,schema:Le.H},{component:Le.I,name:"OwnerPicker",schema:Le.J},{component:Le.K,name:"OwnedEntityPicker",schema:Le.N},{component:Le.P,name:"MyGroupsPicker",schema:Le.l},{component:bs,name:"Secret"}],ss=(0,Se.Z)(V=>({root:{backgroundColor:"rgba(0, 0, 0, .11)",boxShadow:"none",margin:V.spacing(1,0,1,0)},title:{margin:V.spacing(1,0,0,1),textTransform:"uppercase",fontSize:12,fontWeight:"bold"},listIcon:{minWidth:30,color:V.palette.text.primary},menuItem:{minHeight:V.spacing(6)},groupWrapper:{margin:V.spacing(1,1,2,1)}}),{name:"ScaffolderReactOwnerListPicker"});function O(){return[{name:"Task Owner",items:[{id:"owned",label:"Owned",icon:Pi.Z},{id:"all",label:"All",icon:Ft.Z}]}]}const g=V=>{const{filter:z,onSelectOwner:Q}=V,ie=ss(),ce=O();return p.createElement(Pt.Z,{className:ie.root},ce.map(pe=>p.createElement(p.Fragment,{key:pe.name},p.createElement(bt.Z,{variant:"subtitle2",component:"span",className:ie.title},pe.name),p.createElement(Pt.Z,{className:ie.groupWrapper},p.createElement(Ot.Z,{disablePadding:!0,dense:!0,role:"menu"},pe.items.map(ve=>p.createElement(Dt.Z,{key:ve.id,divider:!0,ContainerProps:{role:"menuitem"},onClick:()=>Q(ve.id),selected:ve.id===z,className:ie.menuItem,"data-testid":`owner-picker-${ve.id}`},ve.icon&&p.createElement(wt.Z,{className:ie.listIcon},p.createElement(ve.icon,{fontSize:"small"})),p.createElement(ai.Z,null,p.createElement(bt.Z,{variant:"body1"},ve.label)))))))))},S=({createdAt:V})=>{const z=gt.ou.fromISO(V),Q=gt.Xp.fromDateTimes(z,gt.ou.local()).toDuration().valueOf();return p.createElement(bt.Z,{paragraph:!0},rn()(Q,{round:!0})," ago")},P=({entityRef:V})=>{var z,Q,ie;const ce=(0,ke.u)(et.Ah),{value:pe,loading:ve,error:$e}=(0,we.default)(()=>ce.getEntityByRef(V||""),[ce,V]);return V?ve||$e?null:p.createElement(et.dx,{entityRef:(0,Zi.of)(V),title:(ie=(Q=(z=pe==null?void 0:pe.spec)==null?void 0:z.profile)==null?void 0:Q.displayName)!=null?ie:pe==null?void 0:pe.metadata.name}):p.createElement(bt.Z,{paragraph:!0},"Unknown")},W=({status:V})=>{switch(V){case"processing":return p.createElement(Ee.wA,null,V);case"completed":return p.createElement(Ee.Kq,null,V);case"error":default:return p.createElement(Ee.vK,null,V)}},K=({entityRef:V})=>{const z=(0,ke.u)(ue.s),{value:Q,loading:ie,error:ce}=(0,we.default)(()=>z.getTemplateParameterSchema(V||""),[z,V]);return ie||ce||!V?null:p.createElement(et.dx,{entityRef:(0,Zi.of)(V),title:Q==null?void 0:Q.title})},U=V=>{var z;const{initiallySelectedFilter:Q="owned"}=V,ie=(0,ke.u)(ue.s),ce=(0,ze.tg)(Le.r),[pe,ve]=(0,p.useState)(Q),{value:$e,loading:Tt,error:it}=(0,we.default)(()=>{var Ae;return ie.listTasks?(Ae=ie.listTasks)==null?void 0:Ae.call(ie,{filterByOwnership:pe}):(console.warn("listTasks is not implemented in the scaffolderApi, please make sure to implement this method."),Promise.resolve({tasks:[]}))},[ie,pe]);return Tt?p.createElement(Ee.Ex,null):it?p.createElement(p.Fragment,null,p.createElement(Ee.yu,{error:it}),p.createElement(Ee.ub,{missing:"info",title:"No information to display",description:"There is no Tasks or there was an issue communicating with backend."})):p.createElement(et._i,null,p.createElement(et._i.Filters,null,p.createElement(g,{filter:pe,onSelectOwner:Ae=>ve(Ae)})),p.createElement(et._i.Content,null,p.createElement(Ee.iA,{data:(z=$e==null?void 0:$e.tasks)!=null?z:[],title:"Tasks",columns:[{title:"Task ID",field:"id",render:Ae=>p.createElement(Ee.rU,{to:`${ce()}/tasks/${Ae.id}`},Ae.id)},{title:"Template",render:Ae=>{var Re;return p.createElement(K,{entityRef:(Re=Ae.spec.templateInfo)==null?void 0:Re.entityRef})}},{title:"Created",field:"createdAt",render:Ae=>p.createElement(S,{createdAt:Ae.createdAt})},{title:"Owner",field:"createdBy",render:Ae=>{var Re,Me;return p.createElement(P,{entityRef:(Me=(Re=Ae.spec)==null?void 0:Re.user)==null?void 0:Me.ref})}},{title:"Status",field:"status",render:Ae=>p.createElement(W,{status:Ae.status})}]})))},he=V=>p.createElement(Ee.T3,{themeId:"home"},p.createElement(Ee.h4,{pageTitleOverride:"Templates Tasks",title:p.createElement(p.Fragment,null,"List template tasks ",p.createElement(Ee.Fw,{shorthand:!0,alpha:!0})),subtitle:"All tasks that have been started"}),p.createElement(Ee.VY,null,p.createElement(U,{...V}))),oe=window.showDirectoryPicker;class De{constructor(z,Q){this.path=z,this.handle=Q}file(){return this.handle.getFile()}async save(z){const Q=await this.handle.createWritable();await Q.write(z),await Q.close()}}class je{constructor(z){this.handle=z}async listFiles(){const z=[];for await(const Q of this.listDirectoryContents(this.handle))z.push(Q);return z}async*listDirectoryContents(z,Q=[]){for await(const ie of z.values())if(ie.kind==="file")yield new De([...Q,ie.name].join("/"),ie);else if(ie.kind==="directory"){if(ie.name===".git")continue;yield*this.listDirectoryContents(ie,[...Q,ie.name])}}}class Wt{static isSupported(){return Boolean(oe)}static async requestDirectoryAccess(){if(!oe)throw new Error("File system access is not supported");const z=await oe();return new je(z)}constructor(){}}const Ui=(0,Se.Z)(V=>({introText:{textAlign:"center",marginTop:V.spacing(2)},card:{position:"relative",maxWidth:340,marginTop:V.spacing(4),margin:V.spacing(0,2)},infoIcon:{position:"absolute",top:V.spacing(1),right:V.spacing(1)}}));function Ei(V){const z=Ui(),Q=Wt.isSupported(),ie=p.createElement(Pt.Z,{className:z.card,elevation:4},p.createElement(te.Z,{disabled:!Q,onClick:()=>{var ve;return(ve=V.onSelect)==null?void 0:ve.call(V,"local")}},p.createElement(x.Z,null,p.createElement(bt.Z,{variant:"h4",component:"h3",gutterBottom:!0,color:Q?void 0:"textSecondary",style:{display:"flex",flexFlow:"row nowrap"}},"Load Template Directory"),p.createElement(bt.Z,{variant:"body1",color:Q?void 0:"textSecondary"},"Load a local template directory, allowing you to both edit and try executing your own template."))),!Q&&p.createElement("div",{className:z.infoIcon},p.createElement(_t.ZP,{placement:"top",title:"Only supported in some Chromium-based browsers"},p.createElement(C.Z,null)))),ce=p.createElement(Pt.Z,{className:z.card,elevation:4},p.createElement(te.Z,{onClick:()=>{var ve;return(ve=V.onSelect)==null?void 0:ve.call(V,"form")}},p.createElement(x.Z,null,p.createElement(bt.Z,{variant:"h4",component:"h3",gutterBottom:!0},"Edit Template Form"),p.createElement(bt.Z,{variant:"body1"},"Preview and edit a template form, either using a sample template or by loading a template from the catalog.")))),pe=p.createElement(Pt.Z,{className:z.card,elevation:4},p.createElement(te.Z,{onClick:()=>{var ve;return(ve=V.onSelect)==null?void 0:ve.call(V,"field-explorer")}},p.createElement(x.Z,null,p.createElement(bt.Z,{variant:"h4",component:"h3",gutterBottom:!0},"Custom Field Explorer"),p.createElement(bt.Z,{variant:"body1"},"View and play around with available installed custom field extensions."))));return p.createElement("div",{style:V.style},p.createElement(bt.Z,{variant:"h4",component:"h2",className:z.introText},"Get started by choosing one of the options below"),p.createElement("div",{style:{display:"flex",flexFlow:"row wrap",alignItems:"flex-start",justifyContent:"center",alignContent:"flex-start"}},Q&&ie,ce,!Q&&ie,pe))}var gn=Object.defineProperty,Tn=(V,z,Q)=>z in V?gn(V,z,{enumerable:!0,configurable:!0,writable:!0,value:Q}):V[z]=Q,Qs=(V,z,Q)=>(Tn(V,typeof z!="symbol"?z+"":z,Q),Q),$n=(V,z,Q)=>{if(!z.has(V))throw TypeError("Cannot "+Q)},Ht=(V,z,Q)=>($n(V,z,"read from private field"),Q?Q.call(V):z.get(V)),Mn=(V,z,Q)=>{if(z.has(V))throw TypeError("Cannot add the same private member more than once");z instanceof WeakSet?z.add(V):z.set(V,Q)},Sn=(V,z,Q,ie)=>($n(V,z,"write to private field"),ie?ie.call(V,Q):z.set(V,Q),Q),xs,rs,un,jn,Is,Zn,Kn,Jn,Rn;const Mr=1024*1024,to="This file is too large to be displayed";class Er{constructor(z,Q){Mn(this,xs,void 0),Mn(this,rs,void 0),Mn(this,un,void 0),Mn(this,jn,void 0),Sn(this,xs,z),Sn(this,rs,Q)}get path(){return Ht(this,xs).path}get content(){var z;return(z=Ht(this,un))!=null?z:to}updateContent(z){Ht(this,un)!==void 0&&(Sn(this,un,z),Ht(this,rs).call(this))}get dirty(){return Ht(this,un)!==Ht(this,jn)}async save(){Ht(this,un)!==void 0&&(await Ht(this,xs).save(Ht(this,un)),Sn(this,jn,Ht(this,un)),Ht(this,rs).call(this))}async reload(){const z=await Ht(this,xs).file();if(z.size>Mr){Ht(this,un)!==void 0&&(Sn(this,un,void 0),Sn(this,jn,void 0),Ht(this,rs).call(this));return}const Q=await z.text();Ht(this,un)!==Q&&(Sn(this,un,Q),Sn(this,jn,Q),Ht(this,rs).call(this))}}xs=new WeakMap,rs=new WeakMap,un=new WeakMap,jn=new WeakMap;class io{constructor(z){Mn(this,Is,void 0),Mn(this,Zn,new Set),Mn(this,Kn,[]),Mn(this,Jn,void 0),Qs(this,"setSelectedFile",Q=>{const ie=Ht(this,Jn),ce=Ht(this,Kn).find(pe=>pe.path===Q);ie!==ce&&(Sn(this,Jn,ce),Ht(this,Rn).call(this))}),Mn(this,Rn,()=>{Ht(this,Zn).forEach(Q=>Q())}),Sn(this,Is,z)}get files(){return Ht(this,Kn)}get selectedFile(){return Ht(this,Jn)}get dirty(){return Ht(this,Kn).some(z=>z.dirty)}async save(){await Promise.all(Ht(this,Kn).map(z=>z.save()))}async reload(){var z;const Q=(z=Ht(this,Jn))==null?void 0:z.path,ie=await Ht(this,Is).listFiles(),ce=await Promise.all(ie.map(async pe=>{const ve=new Er(pe,Ht(this,Rn));return await ve.reload(),ve}));Ht(this,Kn).length=0,Ht(this,Kn).push(...ce),this.setSelectedFile(Q),Ht(this,Rn).call(this)}subscribe(z){return Ht(this,Zn).add(z),()=>{Ht(this,Zn).delete(z)}}}Is=new WeakMap,Zn=new WeakMap,Kn=new WeakMap,Jn=new WeakMap,Rn=new WeakMap;const cr=(0,p.createContext)(void 0);function ii(){const V=(0,p.useContext)(cr),z=Qe();if((0,p.useEffect)(()=>V==null?void 0:V.subscribe(z),[V,z]),!V)throw new Error("must be used within a DirectoryEditorProvider");return V}function fr(V){const{directory:z}=V,[{result:Q,error:ie},{execute:ce}]=(0,tt.r)(async pe=>{const ve=new io(pe);await ve.reload();const $e=ve.files.find(Tt=>Tt.path.match(/\.ya?ml$/));return $e&&ve.setSelectedFile($e.path),ve});return(0,p.useEffect)(()=>{ce(z)},[ce,z]),ie?p.createElement(Ee.yu,{error:ie}):Q?p.createElement(cr.Provider,{value:Q},V.children):p.createElement(Ee.Ex,null)}const Ns=64*1024,En=32*1024,ur=(0,p.createContext)(void 0);function dr(V){if(V.length>Ns)return window.btoa("<file too large>");try{return window.btoa(V)}catch{const Q=new TextEncoder().encode(V),ie=new Array;for(let ce=0;ce<Q.length;ce+=En)ie.push(String.fromCharCode(...Q.slice(ce,ce+En)));return window.btoa(ie.join(""))}}function Dr(V){const z=(0,ke.u)(ue.s),[Q,ie]=(0,p.useState)({results:[],selectedResult:void 0}),ce=(0,p.useRef)(1),pe=(0,p.useCallback)(it=>{ie(Ae=>{const Re=Ae.results.find(Me=>Me.id===it);return Re===Ae.selectedResult?Ae:{results:Ae.results,selectedResult:Re}})},[]),ve=(0,p.useCallback)(it=>{ie(Ae=>{var Re;const Me=Ae.results.findIndex(St=>St.id===it);if(Me===-1)return Ae;const vt=Ae.results.slice(),[qe]=vt.splice(Me,1);return{results:vt,selectedResult:((Re=Ae.selectedResult)==null?void 0:Re.id)===qe.id?vt[0]:Ae.selectedResult}})},[]),$e=(0,p.useCallback)(async it=>{if(!z.dryRun)throw new Error("Scaffolder API does not support dry-run");const Ae=Ve.ZP.parse(it.templateContent),Me={...await z.dryRun({template:Ae,values:it.values,secrets:{},directoryContents:it.files.map(vt=>({path:vt.path,base64Content:dr(vt.content)}))}),id:ce.current++};ie(vt=>{var qe;return{results:[...vt.results,Me],selectedResult:(qe=vt.selectedResult)!=null?qe:Me}})},[z]),Tt=(0,p.useMemo)(()=>({...Q,selectResult:pe,deleteResult:ve,execute:$e}),[Q,pe,ve,$e]);return p.createElement(ur.Provider,{value:Tt},V.children)}function Un(){const V=(0,p.useContext)(ur);if(!V)throw new Error("must be used within a DryRunProvider");return V}const ws=(0,Se.Z)({root:{whiteSpace:"nowrap",overflowY:"auto"}});function Or(V){const z={type:"directory",name:"",path:"",children:[]};for(const Q of V.slice().sort()){const ie=Q.split("/");let ce=z;for(let pe=0;pe<ie.length;pe++){const ve=ie[pe];if(ve==="")throw new Error("Invalid path part: ''");const $e=ie.slice(0,pe+1).join("/"),Tt=ce.children.find(it=>it.name===ve);if((Tt==null?void 0:Tt.type)==="file")throw new Error(`Duplicate filename at '${$e}'`);if(Tt)ce=Tt;else if(pe<ie.length-1){const it={type:"directory",name:ve,path:$e,children:[]},Ae=ce.children.findIndex(Re=>Re.type==="file");ce.children.splice(Ae,0,it),ce=it}else ce.children.push({type:"file",name:ve,path:$e})}}return z.children}function yn({entry:V}){return V.type==="file"?p.createElement(d,{nodeId:V.path,label:V.name}):p.createElement(d,{nodeId:V.path,label:V.name},V.children.map(z=>p.createElement(yn,{key:z.path,entry:z})))}function _i(V){const z=ws(),Q=(0,p.useMemo)(()=>Or(V.filePaths),[V.filePaths]);return p.createElement(fn,{selected:V.selected,className:z.root,defaultCollapseIcon:p.createElement(ae.Z,null),defaultExpandIcon:p.createElement(vi.Z,null),onNodeSelect:(ie,ce)=>{V.onSelect&&V.filePaths.includes(ce)&&V.onSelect(ce)}},Q.map(ie=>p.createElement(yn,{key:ie.path,entry:ie})))}const _s=(0,Se.Z)(V=>({button:{padding:V.spacing(1)},buttons:{display:"flex",flexFlow:"row nowrap",alignItems:"center",justifyContent:"flex-start"},buttonsGap:{flex:"1 1 auto"},buttonsDivider:{marginBottom:V.spacing(1)}}));function er(V){var z,Q;const ie=_s(),ce=ii(),pe=ce.files.filter($e=>$e.dirty),ve=()=>{V.onClose&&(pe.length>0&&!window.confirm("Are you sure? Unsaved changes will be lost")||V.onClose())};return p.createElement(p.Fragment,null,p.createElement("div",{className:ie.buttons},p.createElement(_t.ZP,{title:"Save all files"},p.createElement(ei.Z,{className:ie.button,disabled:ce.files.every($e=>!$e.dirty),onClick:()=>ce.save()},p.createElement(ee.Z,null))),p.createElement(_t.ZP,{title:"Reload directory"},p.createElement(ei.Z,{className:ie.button,onClick:()=>ce.reload()},p.createElement(Z.Z,null))),p.createElement("div",{className:ie.buttonsGap}),p.createElement(_t.ZP,{title:"Close directory"},p.createElement(ei.Z,{className:ie.button,onClick:ve},p.createElement(N.Z,null)))),p.createElement(Ge.Z,{className:ie.buttonsDivider}),p.createElement(_i,{selected:(Q=(z=ce.selectedFile)==null?void 0:z.path)!=null?Q:"",onSelect:ce.setSelectedFile,filePaths:ce.files.map($e=>$e.path)}))}const pr=(0,Se.Z)(V=>({container:{position:"relative",width:"100%",height:"100%"},codeMirror:{position:"absolute",top:0,bottom:0,left:0,right:0},errorPanel:{color:V.palette.error.main,lineHeight:2,margin:V.spacing(0,1)},floatingButtons:{position:"absolute",top:V.spacing(1),right:V.spacing(3)},floatingButton:{padding:V.spacing(1)}}));function tr(V){const{errorText:z}=V,Q=pr(),ie=(0,p.useMemo)(()=>{if(!z)return He.mH.of(null);const ce=document.createElement("div");return ce.classList.add(Q.errorPanel),ce.textContent=z,He.mH.of(()=>({dom:ce,bottom:!0}))},[Q,z]);return xi(ce=>ce.key==="s"&&(ce.ctrlKey||ce.metaKey),ce=>{ce.preventDefault(),V.onSave&&V.onSave()}),p.createElement("div",{className:Q.container},p.createElement(Ye.ZP,{className:Q.codeMirror,theme:"dark",height:"100%",extensions:[re.il.define(xe.r),ie],value:V.content,onChange:V.onUpdate}),(V.onSave||V.onReload)&&p.createElement("div",{className:Q.floatingButtons},p.createElement(Ze.Z,null,V.onSave&&p.createElement(_t.ZP,{title:"Save file"},p.createElement(ei.Z,{className:Q.floatingButton,onClick:()=>{var ce;return(ce=V.onSave)==null?void 0:ce.call(V)}},p.createElement(ee.Z,null))),V.onReload&&p.createElement(_t.ZP,{title:"Reload file"},p.createElement(ei.Z,{className:Q.floatingButton,onClick:()=>{var ce;return(ce=V.onReload)==null?void 0:ce.call(V)}},p.createElement(Z.Z,null))))))}function Pr(V){var z,Q;const ie=ii(),ce=(z=ie.selectedFile)!=null&&z.dirty?{onSave:()=>ie.save(),onReload:()=>ie.reload()}:{onReload:()=>ie.reload()};return p.createElement(tr,{errorText:V.errorText,content:(Q=ie.selectedFile)==null?void 0:Q.content,onUpdate:pe=>{var ve;return(ve=ie.selectedFile)==null?void 0:ve.updateContent(pe)},...ce})}tr.DirectoryEditor=Pr;function Rr(V,z){const Q=document.createElement("a");Q.href=URL.createObjectURL(V),Q.download=z,Q.click(),URL.revokeObjectURL(Q.href),Q.remove()}const Br=(0,Se.Z)(V=>({root:{overflowY:"auto",background:V.palette.background.default},iconSuccess:{minWidth:0,marginRight:V.spacing(1),color:V.palette.status.ok},iconFailure:{minWidth:0,marginRight:V.spacing(1),color:V.palette.status.error}}));function Lr(){const V=Br(),z=Un();return p.createElement(Ot.Z,{className:V.root,dense:!0},z.results.map(Q=>{var ie;const ce=Q.log.some($e=>$e.body.status==="failed");let pe=!1;async function ve(){pe=!0,await no(Q.directoryContents,`dry-run-result-${Q.id}.zip`),pe=!1}return p.createElement(Jt.Z,{button:!0,key:Q.id,selected:((ie=z.selectedResult)==null?void 0:ie.id)===Q.id,onClick:()=>z.selectResult(Q.id)},p.createElement(wt.Z,{className:ce?V.iconFailure:V.iconSuccess},ce?p.createElement(rt.Z,null):p.createElement(yt.Z,null)),p.createElement(ai.Z,{primary:`Result ${Q.id}`}),p.createElement(ot.Z,null,p.createElement(ei.Z,{edge:"end","aria-label":"download",title:"Download as .zip",disabled:pe,onClick:()=>ve()},p.createElement(Zt.Z,null)),p.createElement(ei.Z,{edge:"end","aria-label":"delete",title:"Delete result",onClick:()=>z.deleteResult(Q.id)},p.createElement(lt.Z,null))))}))}async function no(V,z){const{default:Q}=await q.e(1297).then(q.t.bind(q,1297,23)),ie=new Q;for(const pe of V){const ve=atob(pe.base64Content);await ie.file(pe.path,ve)}const ce=await ie.generateAsync({type:"blob"});Rr(ce,z)}const Ir=(0,Se.Z)(V=>({root:{display:"grid",gridTemplateColumns:"280px auto 3fr",gridTemplateRows:"1fr"},child:{overflowY:"auto",height:"100%",minHeight:0},firstChild:{background:V.palette.background.paper}}));function Fs(V){const z=Ir(),Q=p.Children.toArray(V.children);if(Q.length!==2)throw new Error("must have exactly 2 children");return p.createElement("div",{className:z.root},p.createElement("div",{className:Xe()(z.child,z.firstChild)},Q[0]),p.createElement(Ge.Z,{orientation:"horizontal"}),p.createElement("div",{className:z.child},Q[1]))}const ir=(0,Se.Z)({root:{display:"flex",flexFlow:"column nowrap"},contentWrapper:{flex:1,position:"relative"},content:{position:"absolute",top:0,left:0,right:0,bottom:0,display:"flex","& > *":{flex:1}},codeMirror:{height:"100%",overflowY:"auto"}});function Nr(){const V=ir(),{selectedResult:z}=Un(),[Q,ie]=(0,p.useState)(""),ce=z==null?void 0:z.directoryContents.find(pe=>pe.path===Q);return(0,p.useEffect)(()=>{if(z){const[pe]=z.directoryContents;ie(pe?pe.path:"")}},[z]),z?p.createElement(Fs,null,p.createElement(_i,{selected:Q,onSelect:ie,filePaths:z.directoryContents.map(pe=>pe.path)}),p.createElement(Ye.ZP,{className:V.codeMirror,theme:"dark",height:"100%",extensions:[re.il.define(xe.r)],readOnly:!0,value:ce!=null&&ce.base64Content?atob(ce.base64Content):""})):null}function so(){var V,z;const{selectedResult:Q}=Un(),[ie,ce]=(0,p.useState)(),pe=(0,p.useMemo)(()=>{var $e;return Q?($e=Q.steps.map(Tt=>{var it,Ae;const Re=Q.log.filter(Me=>Me.body.stepId===Tt.id);return{id:Tt.id,name:Tt.name,logString:Re.map(Me=>Me.body.message).join(`
`),status:(Ae=(it=Re[Re.length-1])==null?void 0:it.body.status)!=null?Ae:"completed"}}))!=null?$e:[]:[]},[Q]);if(!Q)return null;const ve=(V=pe.find($e=>$e.id===ie))!=null?V:pe[0];return p.createElement(Fs,null,p.createElement(Gt,{steps:pe,currentStepId:ve.id,onUserStepChange:ce}),p.createElement(Ee.nU,{text:(z=ve==null?void 0:ve.logString)!=null?z:""}))}function ro(){var V,z;const Q=ir(),{selectedResult:ie}=Un();return ie?p.createElement(Fs,null,p.createElement(G.Z,{pt:2},((z=(V=ie.output)==null?void 0:V.links)==null?void 0:z.length)&&p.createElement(di,{output:ie.output})),p.createElement(Ye.ZP,{className:Q.codeMirror,theme:"dark",height:"100%",extensions:[re.il.define(xe.r)],readOnly:!0,value:JSON.stringify(ie.output,null,2)})):null}function Fr(){const V=ir(),[z,Q]=(0,p.useState)("files");return p.createElement("div",{className:V.root},p.createElement(pt.Z,{value:z,onChange:(ie,ce)=>Q(ce)},p.createElement(Bt.Z,{value:"files",label:"Files"}),p.createElement(Bt.Z,{value:"log",label:"Log"}),p.createElement(Bt.Z,{value:"output",label:"Output"})),p.createElement(Ge.Z,null),p.createElement("div",{className:V.contentWrapper},p.createElement("div",{className:V.content},z==="files"&&p.createElement(Nr,null),z==="log"&&p.createElement(so,null),z==="output"&&p.createElement(ro,null))))}const oo=(0,Se.Z)(V=>({header:{height:48,minHeight:0,"&.Mui-expanded":{height:48,minHeight:0}},content:{display:"grid",background:V.palette.background.default,gridTemplateColumns:"180px auto 1fr",gridTemplateRows:"1fr",padding:0,height:400}}));function os(){const V=oo(),z=Un(),[Q,ie]=(0,p.useState)(!1),[ce,pe]=(0,p.useState)(!0),ve=z.results.length,$e=st(ve);return(0,p.useEffect)(()=>{$e===0&&ve===1?(pe(!1),ie(!0)):$e===1&&ve===0&&ie(!1)},[$e,ve]),p.createElement(p.Fragment,null,p.createElement(bi.Z,{variant:"outlined",expanded:Q,hidden:ve===0&&ce,onChange:(Tt,it)=>ie(it),onTransitionEnd:()=>ve===0&&pe(!0)},p.createElement(fi.Z,{className:V.header,expandIcon:p.createElement(be.Z,null)},p.createElement(bt.Z,null,"Dry-run results")),p.createElement(Ge.Z,{orientation:"horizontal"}),p.createElement(Et.Z,{className:V.content},p.createElement(Lr,null),p.createElement(Ge.Z,{orientation:"horizontal"}),p.createElement(Fr,null))))}},22983:(wn,Nt,q)=>{var p,we=q(71600),ue=q(34590);p={value:!0},Nt.Z=void 0;var L=ue(q(2784)),G=we(q(50175)),Se=(0,G.default)(L.createElement("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"}),"Delete");Nt.Z=Se},84905:(wn,Nt,q)=>{var p,we=q(71600),ue=q(34590);p={value:!0},Nt.Z=void 0;var L=ue(q(2784)),G=we(q(50175)),Se=(0,G.default)(L.createElement("path",{d:"M12 8l-6 6 1.41 1.41L12 10.83l4.59 4.58L18 14z"}),"ExpandLess");Nt.Z=Se},16874:(wn,Nt,q)=>{var p,we=q(71600),ue=q(34590);p={value:!0},Nt.Z=void 0;var L=ue(q(2784)),G=we(q(50175)),Se=(0,G.default)(L.createElement("circle",{cx:"12",cy:"12",r:"8"}),"FiberManualRecord");Nt.Z=Se},28113:(wn,Nt,q)=>{var p,we=q(71600),ue=q(34590);p={value:!0},Nt.Z=void 0;var L=ue(q(2784)),G=we(q(50175)),Se=(0,G.default)(L.createElement("path",{d:"M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"}),"GetApp");Nt.Z=Se},82726:(wn,Nt,q)=>{var p,we=q(71600),ue=q(34590);p={value:!0},Nt.Z=void 0;var L=ue(q(2784)),G=we(q(50175)),Se=(0,G.default)(L.createElement("path",{d:"M11 7h2v2h-2zm0 4h2v6h-2zm1-9C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm0 18c-4.41 0-8-3.59-8-8s3.59-8 8-8 8 3.59 8 8-3.59 8-8 8z"}),"InfoOutlined");Nt.Z=Se},49423:(wn,Nt,q)=>{var p,we=q(71600),ue=q(34590);p={value:!0},Nt.Z=void 0;var L=ue(q(2784)),G=we(q(50175)),Se=(0,G.default)(L.createElement("path",{d:"M17.65 6.35C16.2 4.9 14.21 4 12 4c-4.42 0-7.99 3.58-7.99 8s3.57 8 7.99 8c3.73 0 6.84-2.55 7.73-6h-2.08c-.82 2.33-3.04 4-5.65 4-3.31 0-6-2.69-6-6s2.69-6 6-6c1.66 0 3.14.69 4.22 1.78L13 11h7V4l-2.35 2.35z"}),"Refresh");Nt.Z=Se},96401:(wn,Nt,q)=>{var p,we=q(71600),ue=q(34590);p={value:!0},Nt.Z=void 0;var L=ue(q(2784)),G=we(q(50175)),Se=(0,G.default)(L.createElement("path",{d:"M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"}),"Save");Nt.Z=Se},2552:(wn,Nt,q)=>{q.d(Nt,{ZP:()=>ms});var p=q(7896),we=q(31461),ue=q(2784),L=q(1727),G=q(65329),Se=q(77120),Fe=q(21649);const bt=o=>{let{state:i}=o,l=i.doc.lineAt(i.selection.main.from),h=me(o.state,l.from);return h.line?xt(o):h.block?Xt(o):!1};function ft(o,i){return({state:l,dispatch:h})=>{if(l.readOnly)return!1;let f=o(i,l);return f?(h(l.update(f)),!0):!1}}const xt=ft(Et,0),Ze=null,nt=null,_e=ft(fi,0),mt=null,mi=null,Xt=ft((o,i)=>fi(o,i,bi(i)),0);function me(o,i){let l=o.languageDataAt("commentTokens",i);return l.length?l[0]:{}}const ut=50;function Kt(o,{open:i,close:l},h,f){let m=o.sliceDoc(h-ut,h),k=o.sliceDoc(f,f+ut),T=/\s*$/.exec(m)[0].length,B=/^\s*/.exec(k)[0].length,J=m.length-T;if(m.slice(J-i.length,J)==i&&k.slice(B,B+l.length)==l)return{open:{pos:h-T,margin:T&&1},close:{pos:f+B,margin:B&&1}};let Y,ge;f-h<=2*ut?Y=ge=o.sliceDoc(h,f):(Y=o.sliceDoc(h,h+ut),ge=o.sliceDoc(f-ut,f));let Ie=/^\s*/.exec(Y)[0].length,ct=/\s*$/.exec(ge)[0].length,Qt=ge.length-ct-l.length;return Y.slice(Ie,Ie+i.length)==i&&ge.slice(Qt,Qt+l.length)==l?{open:{pos:h+Ie+i.length,margin:/\s/.test(Y.charAt(Ie+i.length))?1:0},close:{pos:f-ct-l.length,margin:/\s/.test(ge.charAt(Qt-1))?1:0}}:null}function bi(o){let i=[];for(let l of o.selection.ranges){let h=o.doc.lineAt(l.from),f=l.to<=h.to?h:o.doc.lineAt(l.to),m=i.length-1;m>=0&&i[m].to>h.from?i[m].to=f.to:i.push({from:h.from+/^\s*/.exec(h.text)[0].length,to:f.to})}return i}function fi(o,i,l=i.selection.ranges){let h=l.map(m=>me(i,m.from).block);if(!h.every(m=>m))return null;let f=l.map((m,k)=>Kt(i,h[k],m.from,m.to));if(o!=2&&!f.every(m=>m))return{changes:i.changes(l.map((m,k)=>f[k]?[]:[{from:m.from,insert:h[k].open+" "},{from:m.to,insert:" "+h[k].close}]))};if(o!=1&&f.some(m=>m)){let m=[];for(let k=0,T;k<f.length;k++)if(T=f[k]){let B=h[k],{open:J,close:Y}=T;m.push({from:J.pos-B.open.length,to:J.pos+J.margin},{from:Y.pos-Y.margin,to:Y.pos+B.close.length})}return{changes:m}}return null}function Et(o,i,l=i.selection.ranges){let h=[],f=-1;for(let{from:m,to:k}of l){let T=h.length,B=1e9,J=me(i,m).line;if(J){for(let Y=m;Y<=k;){let ge=i.doc.lineAt(Y);if(ge.from>f&&(m==k||k>ge.from)){f=ge.from;let Ie=/^\s*/.exec(ge.text)[0].length,ct=Ie==ge.length,Qt=ge.text.slice(Ie,Ie+J.length)==J?Ie:-1;Ie<ge.text.length&&Ie<B&&(B=Ie),h.push({line:ge,comment:Qt,token:J,indent:Ie,empty:ct,single:!1})}Y=ge.to+1}if(B<1e9)for(let Y=T;Y<h.length;Y++)h[Y].indent<h[Y].line.text.length&&(h[Y].indent=B);h.length==T+1&&(h[T].single=!0)}}if(o!=2&&h.some(m=>m.comment<0&&(!m.empty||m.single))){let m=[];for(let{line:T,token:B,indent:J,empty:Y,single:ge}of h)(ge||!Y)&&m.push({from:T.from+J,insert:B+" "});let k=i.changes(m);return{changes:k,selection:i.selection.map(k,1)}}else if(o!=1&&h.some(m=>m.comment>=0)){let m=[];for(let{line:k,comment:T,token:B}of h)if(T>=0){let J=k.from+T,Y=J+B.length;k.text[Y-k.from]==" "&&Y++,m.push({from:J,to:Y})}return{changes:m}}return null}const ui=L.q6.define(),Oi=L.q6.define(),Pt=L.r$.define(),Ot=L.r$.define({combine(o){return(0,L.BO)(o,{minDepth:100,newGroupDelay:500,joinToEvent:(i,l)=>l},{minDepth:Math.max,newGroupDelay:Math.min,joinToEvent:(i,l)=>(h,f)=>i(h,f)||l(h,f)})}}),Dt=L.QQ.define({create(){return te.empty},update(o,i){let l=i.state.facet(Ot),h=i.annotation(ui);if(h){let B=ke.fromTransaction(i,h.selection),J=h.side,Y=J==0?o.undone:o.done;return B?Y=Ee(Y,Y.length,l.minDepth,B):Y=Ft(Y,i.startState.selection),new te(J==0?h.rest:Y,J==0?Y:h.rest)}let f=i.annotation(Oi);if((f=="full"||f=="before")&&(o=o.isolate()),i.annotation(L.YW.addToHistory)===!1)return i.changes.empty?o:o.addMapping(i.changes.desc);let m=ke.fromTransaction(i),k=i.annotation(L.YW.time),T=i.annotation(L.YW.userEvent);return m?o=o.addChanges(m,k,T,l,i):i.selection&&(o=o.addSelection(i.startState.selection,k,T,l.newGroupDelay)),(f=="full"||f=="after")&&(o=o.isolate()),o},toJSON(o){return{done:o.done.map(i=>i.toJSON()),undone:o.undone.map(i=>i.toJSON())}},fromJSON(o){return new te(o.done.map(ke.fromJSON),o.undone.map(ke.fromJSON))}});function wt(o={}){return[Dt,Ot.of(o),G.tk.domEventHandlers({beforeinput(i,l){let h=i.inputType=="historyUndo"?ei:i.inputType=="historyRedo"?Ge:null;return h?(i.preventDefault(),h(l)):!1}})]}const ai=null;function _t(o,i){return function({state:l,dispatch:h}){if(!i&&l.readOnly)return!1;let f=l.field(Dt,!1);if(!f)return!1;let m=f.pop(o,l,i);return m?(h(m),!0):!1}}const ei=_t(0,!1),Ge=_t(1,!1),Mi=_t(0,!0),Xe=_t(1,!0);function ae(o){return function(i){let l=i.field(Dt,!1);if(!l)return 0;let h=o==0?l.done:l.undone;return h.length-(h.length&&!h[0].changes?1:0)}}const be=null,ze=null;class ke{constructor(i,l,h,f,m){this.changes=i,this.effects=l,this.mapped=h,this.startSelection=f,this.selectionsAfter=m}setSelAfter(i){return new ke(this.changes,this.effects,this.mapped,this.startSelection,i)}toJSON(){var i,l,h;return{changes:(i=this.changes)===null||i===void 0?void 0:i.toJSON(),mapped:(l=this.mapped)===null||l===void 0?void 0:l.toJSON(),startSelection:(h=this.startSelection)===null||h===void 0?void 0:h.toJSON(),selectionsAfter:this.selectionsAfter.map(f=>f.toJSON())}}static fromJSON(i){return new ke(i.changes&&L.as.fromJSON(i.changes),[],i.mapped&&L.n0.fromJSON(i.mapped),i.startSelection&&L.jT.fromJSON(i.startSelection),i.selectionsAfter.map(L.jT.fromJSON))}static fromTransaction(i,l){let h=et;for(let f of i.startState.facet(Pt)){let m=f(i);m.length&&(h=h.concat(m))}return!h.length&&i.changes.empty?null:new ke(i.changes.invert(i.startState.doc),h,void 0,l||i.startState.selection,et)}static selection(i){return new ke(void 0,et,void 0,void 0,i)}}function Ee(o,i,l,h){let f=i+1>l+20?i-l-1:0,m=o.slice(f,i);return m.push(h),m}function zt(o,i){let l=[],h=!1;return o.iterChangedRanges((f,m)=>l.push(f,m)),i.iterChangedRanges((f,m,k,T)=>{for(let B=0;B<l.length;){let J=l[B++],Y=l[B++];T>=J&&k<=Y&&(h=!0)}}),h}function Le(o,i){return o.ranges.length==i.ranges.length&&o.ranges.filter((l,h)=>l.empty!=i.ranges[h].empty).length===0}function Yt(o,i){return o.length?i.length?o.concat(i):o:i}const et=[],Pi=200;function Ft(o,i){if(o.length){let l=o[o.length-1],h=l.selectionsAfter.slice(Math.max(0,l.selectionsAfter.length-Pi));return h.length&&h[h.length-1].eq(i)?o:(h.push(i),Ee(o,o.length-1,1e9,l.setSelAfter(h)))}else return[ke.selection([i])]}function gt(o){let i=o[o.length-1],l=o.slice();return l[o.length-1]=i.setSelAfter(i.selectionsAfter.slice(0,i.selectionsAfter.length-1)),l}function si(o,i){if(!o.length)return o;let l=o.length,h=et;for(;l;){let f=rn(o[l-1],i,h);if(f.changes&&!f.changes.empty||f.effects.length){let m=o.slice(0,l);return m[l-1]=f,m}else i=f.mapped,l--,h=f.selectionsAfter}return h.length?[ke.selection(h)]:et}function rn(o,i,l){let h=Yt(o.selectionsAfter.length?o.selectionsAfter.map(T=>T.map(i)):et,l);if(!o.changes)return ke.selection(h);let f=o.changes.map(i),m=i.mapDesc(o.changes,!0),k=o.mapped?o.mapped.composeDesc(m):m;return new ke(f,L.Py.mapEffects(o.effects,i),k,o.startSelection.map(m),h)}const Zi=/^(input\.type|delete)($|\.)/;class te{constructor(i,l,h=0,f=void 0){this.done=i,this.undone=l,this.prevTime=h,this.prevUserEvent=f}isolate(){return this.prevTime?new te(this.done,this.undone):this}addChanges(i,l,h,f,m){let k=this.done,T=k[k.length-1];return T&&T.changes&&!T.changes.empty&&i.changes&&(!h||Zi.test(h))&&(!T.selectionsAfter.length&&l-this.prevTime<f.newGroupDelay&&f.joinToEvent(m,zt(T.changes,i.changes))||h=="input.type.compose")?k=Ee(k,k.length-1,f.minDepth,new ke(i.changes.compose(T.changes),Yt(i.effects,T.effects),T.mapped,T.startSelection,et)):k=Ee(k,k.length,f.minDepth,i),new te(k,et,l,h)}addSelection(i,l,h,f){let m=this.done.length?this.done[this.done.length-1].selectionsAfter:et;return m.length>0&&l-this.prevTime<f&&h==this.prevUserEvent&&h&&/^select($|\.)/.test(h)&&Le(m[m.length-1],i)?this:new te(Ft(this.done,i),this.undone,l,h)}addMapping(i){return new te(si(this.done,i),si(this.undone,i),this.prevTime,this.prevUserEvent)}pop(i,l,h){let f=i==0?this.done:this.undone;if(f.length==0)return null;let m=f[f.length-1],k=m.selectionsAfter[0]||l.selection;if(h&&m.selectionsAfter.length)return l.update({selection:m.selectionsAfter[m.selectionsAfter.length-1],annotations:ui.of({side:i,rest:gt(f),selection:k}),userEvent:i==0?"select.undo":"select.redo",scrollIntoView:!0});if(m.changes){let T=f.length==1?et:f.slice(0,f.length-1);return m.mapped&&(T=si(T,m.mapped)),l.update({changes:m.changes,selection:m.startSelection,effects:m.effects,annotations:ui.of({side:i,rest:T,selection:k}),filter:!1,userEvent:i==0?"undo":"redo",scrollIntoView:!0})}else return null}}te.empty=new te(et,et);const x=[{key:"Mod-z",run:ei,preventDefault:!0},{key:"Mod-y",mac:"Mod-Shift-z",run:Ge,preventDefault:!0},{linux:"Ctrl-Shift-z",run:Ge,preventDefault:!0},{key:"Mod-u",run:Mi,preventDefault:!0},{key:"Alt-u",mac:"Mod-Shift-u",run:Xe,preventDefault:!0}];function C(o,i){return L.jT.create(o.ranges.map(i),o.mainIndex)}function I(o,i){return o.update({selection:i,scrollIntoView:!0,userEvent:"select"})}function N({state:o,dispatch:i},l){let h=C(o.selection,l);return h.eq(o.selection)?!1:(i(I(o,h)),!0)}function Z(o,i){return L.jT.cursor(i?o.to:o.from)}function ee(o,i){return N(o,l=>l.empty?o.moveByChar(l,i):Z(l,i))}function re(o){return o.textDirectionAt(o.state.selection.main.head)==G.Nm.LTR}const xe=o=>ee(o,!re(o)),He=o=>ee(o,re(o)),Pe=o=>ee(o,!0),Qe=o=>ee(o,!1);function tt(o,i){return N(o,l=>l.empty?o.moveByGroup(l,i):Z(l,i))}const dt=o=>tt(o,!re(o)),ti=o=>tt(o,re(o)),qt=o=>tt(o,!0),$t=o=>tt(o,!1),jt=typeof Intl!="undefined"&&Intl.Segmenter?new Intl.Segmenter(void 0,{granularity:"word"}):null;function Ct(o,i,l){let h=o.state.charCategorizer(i.from),f=CharCategory.Space,m=i.from,k=0,T=!1,B=!1,J=!1,Y=Ie=>{if(T)return!1;m+=l?Ie.length:-Ie.length;let ct=h(Ie),Qt;if(ct==CharCategory.Word&&Ie.charCodeAt(0)<128&&/[\W_]/.test(Ie)&&(ct=-1),f==CharCategory.Space&&(f=ct),f!=ct)return!1;if(f==CharCategory.Word)if(Ie.toLowerCase()==Ie){if(!l&&B)return!1;J=!0}else if(J){if(l)return!1;T=!0}else{if(B&&l&&h(Qt=o.state.sliceDoc(m,m+1))==CharCategory.Word&&Qt.toLowerCase()==Qt)return!1;B=!0}return k++,!0},ge=o.moveByChar(i,l,Ie=>(Y(Ie),Y));if(jt&&f==CharCategory.Word&&ge.from==i.from+k*(l?1:-1)){let Ie=Math.min(i.head,ge.head),ct=Math.max(i.head,ge.head),Qt=o.state.sliceDoc(Ie,ct);if(Qt.length>1&&/[\u4E00-\uffff]/.test(Qt)){let Yi=Array.from(jt.segment(Qt));if(Yi.length>1)return l?EditorSelection.cursor(i.head+Yi[1].index,-1):EditorSelection.cursor(ge.head+Yi[Yi.length-1].index,1)}}return ge}function Rt(o,i){return N(o,l=>l.empty?Ct(o,l,i):Z(l,i))}const xi=o=>Rt(o,!0),st=o=>Rt(o,!1);function Ye(o,i,l){if(i.type.prop(l))return!0;let h=i.to-i.from;return h&&(h>2||/[^\s,.;:]/.test(o.sliceDoc(i.from,i.to)))||i.firstChild}function Ve(o,i,l){let h=(0,Se.qz)(o).resolveInner(i.head),f=l?Fe.md.closedBy:Fe.md.openedBy;for(let B=i.head;;){let J=l?h.childAfter(B):h.childBefore(B);if(!J)break;Ye(o,J,f)?h=J:B=l?J.to:J.from}let m=h.type.prop(f),k,T;return m&&(k=l?(0,Se.Um)(o,h.from,1):(0,Se.Um)(o,h.to,-1))&&k.matched?T=l?k.end.to:k.end.from:T=l?h.to:h.from,L.jT.cursor(T,l?-1:1)}const Jt=o=>N(o,i=>Ve(o.state,i,!re(o))),ot=o=>N(o,i=>Ve(o.state,i,re(o)));function rt(o,i){return N(o,l=>{if(!l.empty)return Z(l,i);let h=o.moveVertically(l,i);return h.head!=l.head?h:o.moveToLineBoundary(l,i)})}const yt=o=>rt(o,!1),lt=o=>rt(o,!0);function Zt(o){let i=o.scrollDOM.clientHeight<o.scrollDOM.scrollHeight-2,l=0,h=0,f;if(i){for(let m of o.state.facet(G.tk.scrollMargins)){let k=m(o);k!=null&&k.top&&(l=Math.max(k==null?void 0:k.top,l)),k!=null&&k.bottom&&(h=Math.max(k==null?void 0:k.bottom,h))}f=o.scrollDOM.clientHeight-l-h}else f=(o.dom.ownerDocument.defaultView||window).innerHeight;return{marginTop:l,marginBottom:h,selfScroll:i,height:Math.max(o.defaultLineHeight,f-5)}}function Bt(o,i){let l=Zt(o),{state:h}=o,f=C(h.selection,k=>k.empty?o.moveVertically(k,i,l.height):Z(k,i));if(f.eq(h.selection))return!1;let m;if(l.selfScroll){let k=o.coordsAtPos(h.selection.main.head),T=o.scrollDOM.getBoundingClientRect(),B=T.top+l.marginTop,J=T.bottom-l.marginBottom;k&&k.top>B&&k.bottom<J&&(m=G.tk.scrollIntoView(f.main.head,{y:"start",yMargin:k.top-B}))}return o.dispatch(I(h,f),{effects:m}),!0}const pt=o=>Bt(o,!1),gi=o=>Bt(o,!0);function hi(o,i,l){let h=o.lineBlockAt(i.head),f=o.moveToLineBoundary(i,l);if(f.head==i.head&&f.head!=(l?h.to:h.from)&&(f=o.moveToLineBoundary(i,l,!1)),!l&&f.head==h.from&&h.length){let m=/^\s*/.exec(o.state.sliceDoc(h.from,Math.min(h.from+100,h.to)))[0].length;m&&i.head!=h.from+m&&(f=L.jT.cursor(h.from+m))}return f}const yi=o=>N(o,i=>hi(o,i,!0)),on=o=>N(o,i=>hi(o,i,!1)),Ci=o=>N(o,i=>hi(o,i,!re(o))),Lt=o=>N(o,i=>hi(o,i,re(o))),zi=o=>N(o,i=>L.jT.cursor(o.lineBlockAt(i.head).from,1)),Ni=o=>N(o,i=>L.jT.cursor(o.lineBlockAt(i.head).to,-1));function qi(o,i,l){let h=!1,f=C(o.selection,m=>{let k=(0,Se.Um)(o,m.head,-1)||(0,Se.Um)(o,m.head,1)||m.head>0&&(0,Se.Um)(o,m.head-1,1)||m.head<o.doc.length&&(0,Se.Um)(o,m.head+1,-1);if(!k||!k.end)return m;h=!0;let T=k.start.from==m.head?k.end.to:k.end.from;return l?L.jT.range(m.anchor,T):L.jT.cursor(T)});return h?(i(I(o,f)),!0):!1}const Ki=({state:o,dispatch:i})=>qi(o,i,!1),Qi=({state:o,dispatch:i})=>qi(o,i,!0);function ri(o,i){let l=C(o.state.selection,h=>{let f=i(h);return L.jT.range(h.anchor,f.head,f.goalColumn,f.bidiLevel||void 0)});return l.eq(o.state.selection)?!1:(o.dispatch(I(o.state,l)),!0)}function Ji(o,i){return ri(o,l=>o.moveByChar(l,i))}const Vn=o=>Ji(o,!re(o)),fn=o=>Ji(o,re(o)),vi=o=>Ji(o,!0),kn=o=>Ji(o,!1);function Cn(o,i){return ri(o,l=>o.moveByGroup(l,i))}const ns=o=>Cn(o,!re(o)),On=o=>Cn(o,re(o)),R=o=>Cn(o,!0),a=o=>Cn(o,!1);function d(o,i){return ri(o,l=>Ct(o,l,i))}const v=o=>d(o,!0),w=o=>d(o,!1),E=o=>ri(o,i=>Ve(o.state,i,!re(o))),D=o=>ri(o,i=>Ve(o.state,i,re(o)));function H(o,i){return ri(o,l=>o.moveVertically(l,i))}const j=o=>H(o,!1),ne=o=>H(o,!0);function fe(o,i){return ri(o,l=>o.moveVertically(l,i,Zt(o).height))}const ye=o=>fe(o,!1),Ne=o=>fe(o,!0),Be=o=>ri(o,i=>hi(o,i,!0)),Ut=o=>ri(o,i=>hi(o,i,!1)),di=o=>ri(o,i=>hi(o,i,!re(o))),pi=o=>ri(o,i=>hi(o,i,re(o))),zn=o=>ri(o,i=>L.jT.cursor(o.lineBlockAt(i.head).from)),mn=o=>ri(o,i=>L.jT.cursor(o.lineBlockAt(i.head).to)),Pn=({state:o,dispatch:i})=>(i(I(o,{anchor:0})),!0),Gt=({state:o,dispatch:i})=>(i(I(o,{anchor:o.doc.length})),!0),Rs=({state:o,dispatch:i})=>(i(I(o,{anchor:o.selection.main.anchor,head:0})),!0),Bs=({state:o,dispatch:i})=>(i(I(o,{anchor:o.selection.main.anchor,head:o.doc.length})),!0),qs=({state:o,dispatch:i})=>(i(o.update({selection:{anchor:0,head:o.doc.length},userEvent:"select"})),!0),vs=({state:o,dispatch:i})=>{let l=Ei(o).map(({from:h,to:f})=>L.jT.range(h,Math.min(f+1,o.doc.length)));return i(o.update({selection:L.jT.create(l),userEvent:"select"})),!0},Ls=({state:o,dispatch:i})=>{let l=C(o.selection,h=>{var f;let m=(0,Se.qz)(o).resolveStack(h.from,1);for(let k=m;k;k=k.next){let{node:T}=k;if((T.from<h.from&&T.to>=h.to||T.to>h.to&&T.from<=h.from)&&(!((f=T.parent)===null||f===void 0)&&f.parent))return L.jT.range(T.to,T.from)}return h});return i(I(o,l)),!0},bs=({state:o,dispatch:i})=>{let l=o.selection,h=null;return l.ranges.length>1?h=L.jT.create([l.main]):l.main.empty||(h=L.jT.create([L.jT.cursor(l.main.head)])),h?(i(I(o,h)),!0):!1};function An(o,i){if(o.state.readOnly)return!1;let l="delete.selection",{state:h}=o,f=h.changeByRange(m=>{let{from:k,to:T}=m;if(k==T){let B=i(m);B<k?(l="delete.backward",B=ss(o,B,!1)):B>k&&(l="delete.forward",B=ss(o,B,!0)),k=Math.min(k,B),T=Math.max(T,B)}else k=ss(o,k,!1),T=ss(o,T,!0);return k==T?{range:m}:{changes:{from:k,to:T},range:L.jT.cursor(k,k<m.head?-1:1)}});return f.changes.empty?!1:(o.dispatch(h.update(f,{scrollIntoView:!0,userEvent:l,effects:l=="delete.selection"?G.tk.announce.of(h.phrase("Selection deleted")):void 0})),!0)}function ss(o,i,l){if(o instanceof G.tk)for(let h of o.state.facet(G.tk.atomicRanges).map(f=>f(o)))h.between(i,i,(f,m)=>{f<i&&m>i&&(i=l?m:f)});return i}const O=(o,i)=>An(o,l=>{let h=l.from,{state:f}=o,m=f.doc.lineAt(h),k,T;if(!i&&h>m.from&&h<m.from+200&&!/[^ \t]/.test(k=m.text.slice(0,h-m.from))){if(k[k.length-1]=="	")return h-1;let B=(0,L.IS)(k,f.tabSize),J=B%(0,Se.y1)(f)||(0,Se.y1)(f);for(let Y=0;Y<J&&k[k.length-1-Y]==" ";Y++)h--;T=h}else T=(0,L.cp)(m.text,h-m.from,i,i)+m.from,T==h&&m.number!=(i?f.doc.lines:1)?T+=i?1:-1:!i&&/[\ufe00-\ufe0f]/.test(m.text.slice(T-m.from,h-m.from))&&(T=(0,L.cp)(m.text,T-m.from,!1,!1)+m.from);return T}),g=o=>O(o,!1),S=o=>O(o,!0),P=(o,i)=>An(o,l=>{let h=l.head,{state:f}=o,m=f.doc.lineAt(h),k=f.charCategorizer(h);for(let T=null;;){if(h==(i?m.to:m.from)){h==l.head&&m.number!=(i?f.doc.lines:1)&&(h+=i?1:-1);break}let B=(0,L.cp)(m.text,h-m.from,i)+m.from,J=m.text.slice(Math.min(h,B)-m.from,Math.max(h,B)-m.from),Y=k(J);if(T!=null&&Y!=T)break;(J!=" "||h!=l.head)&&(T=Y),h=B}return h}),W=o=>P(o,!1),K=o=>P(o,!0),U=o=>An(o,i=>{let l=o.lineBlockAt(i.head).to;return i.head<l?l:Math.min(o.state.doc.length,i.head+1)}),he=o=>An(o,i=>{let l=o.lineBlockAt(i.head).from;return i.head>l?l:Math.max(0,i.head-1)}),oe=o=>An(o,i=>{let l=o.moveToLineBoundary(i,!1).head;return i.head>l?l:Math.max(0,i.head-1)}),De=o=>An(o,i=>{let l=o.moveToLineBoundary(i,!0).head;return i.head<l?l:Math.min(o.state.doc.length,i.head+1)}),je=({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=[];for(let h=0,f="",m=o.doc.iter();;){if(m.next(),m.lineBreak||m.done){let k=f.search(/\s+$/);if(k>-1&&l.push({from:h-(f.length-k),to:h}),m.done)break;f=""}else f=m.value;h+=m.value.length}return l.length?(i(o.update({changes:l,userEvent:"delete"})),!0):!1},Wt=({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=o.changeByRange(h=>({changes:{from:h.from,to:h.to,insert:L.xv.of(["",""])},range:L.jT.cursor(h.from)}));return i(o.update(l,{scrollIntoView:!0,userEvent:"input"})),!0},Ui=({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=o.changeByRange(h=>{if(!h.empty||h.from==0||h.from==o.doc.length)return{range:h};let f=h.from,m=o.doc.lineAt(f),k=f==m.from?f-1:(0,L.cp)(m.text,f-m.from,!1)+m.from,T=f==m.to?f+1:(0,L.cp)(m.text,f-m.from,!0)+m.from;return{changes:{from:k,to:T,insert:o.doc.slice(f,T).append(o.doc.slice(k,f))},range:L.jT.cursor(T)}});return l.changes.empty?!1:(i(o.update(l,{scrollIntoView:!0,userEvent:"move.character"})),!0)};function Ei(o){let i=[],l=-1;for(let h of o.selection.ranges){let f=o.doc.lineAt(h.from),m=o.doc.lineAt(h.to);if(!h.empty&&h.to==m.from&&(m=o.doc.lineAt(h.to-1)),l>=f.number){let k=i[i.length-1];k.to=m.to,k.ranges.push(h)}else i.push({from:f.from,to:m.to,ranges:[h]});l=m.number+1}return i}function gn(o,i,l){if(o.readOnly)return!1;let h=[],f=[];for(let m of Ei(o)){if(l?m.to==o.doc.length:m.from==0)continue;let k=o.doc.lineAt(l?m.to+1:m.from-1),T=k.length+1;if(l){h.push({from:m.to,to:k.to},{from:m.from,insert:k.text+o.lineBreak});for(let B of m.ranges)f.push(L.jT.range(Math.min(o.doc.length,B.anchor+T),Math.min(o.doc.length,B.head+T)))}else{h.push({from:k.from,to:m.from},{from:m.to,insert:o.lineBreak+k.text});for(let B of m.ranges)f.push(L.jT.range(B.anchor-T,B.head-T))}}return h.length?(i(o.update({changes:h,scrollIntoView:!0,selection:L.jT.create(f,o.selection.mainIndex),userEvent:"move.line"})),!0):!1}const Tn=({state:o,dispatch:i})=>gn(o,i,!1),Qs=({state:o,dispatch:i})=>gn(o,i,!0);function $n(o,i,l){if(o.readOnly)return!1;let h=[];for(let f of Ei(o))l?h.push({from:f.from,insert:o.doc.slice(f.from,f.to)+o.lineBreak}):h.push({from:f.to,insert:o.lineBreak+o.doc.slice(f.from,f.to)});return i(o.update({changes:h,scrollIntoView:!0,userEvent:"input.copyline"})),!0}const Ht=({state:o,dispatch:i})=>$n(o,i,!1),Mn=({state:o,dispatch:i})=>$n(o,i,!0),Sn=o=>{if(o.state.readOnly)return!1;let{state:i}=o,l=i.changes(Ei(i).map(({from:f,to:m})=>(f>0?f--:m<i.doc.length&&m++,{from:f,to:m}))),h=C(i.selection,f=>o.moveVertically(f,!0)).map(l);return o.dispatch({changes:l,selection:h,scrollIntoView:!0,userEvent:"delete.line"}),!0},xs=({state:o,dispatch:i})=>(i(o.update(o.replaceSelection(o.lineBreak),{scrollIntoView:!0,userEvent:"input"})),!0);function rs(o,i){if(/\(\)|\[\]|\{\}/.test(o.sliceDoc(i-1,i+1)))return{from:i,to:i};let l=(0,Se.qz)(o).resolveInner(i),h=l.childBefore(i),f=l.childAfter(i),m;return h&&f&&h.to<=i&&f.from>=i&&(m=h.type.prop(Fe.md.closedBy))&&m.indexOf(f.name)>-1&&o.doc.lineAt(h.to).from==o.doc.lineAt(f.from).from&&!/\S/.test(o.sliceDoc(h.to,f.from))?{from:h.to,to:f.from}:null}const un=Is(!1),jn=Is(!0);function Is(o){return({state:i,dispatch:l})=>{if(i.readOnly)return!1;let h=i.changeByRange(f=>{let{from:m,to:k}=f,T=i.doc.lineAt(m),B=!o&&m==k&&rs(i,m);o&&(m=k=(k<=T.to?T:i.doc.lineAt(k)).to);let J=new Se.Gn(i,{simulateBreak:m,simulateDoubleBreak:!!B}),Y=(0,Se.K0)(J,m);for(Y==null&&(Y=(0,L.IS)(/^\s*/.exec(i.doc.lineAt(m).text)[0],i.tabSize));k<T.to&&/\s/.test(T.text[k-T.from]);)k++;B?{from:m,to:k}=B:m>T.from&&m<T.from+100&&!/\S/.test(T.text.slice(0,m))&&(m=T.from);let ge=["",(0,Se.SS)(i,Y)];return B&&ge.push((0,Se.SS)(i,J.lineIndent(T.from,-1))),{changes:{from:m,to:k,insert:L.xv.of(ge)},range:L.jT.cursor(m+1+ge[1].length)}});return l(i.update(h,{scrollIntoView:!0,userEvent:"input"})),!0}}function Zn(o,i){let l=-1;return o.changeByRange(h=>{let f=[];for(let k=h.from;k<=h.to;){let T=o.doc.lineAt(k);T.number>l&&(h.empty||h.to>T.from)&&(i(T,f,h),l=T.number),k=T.to+1}let m=o.changes(f);return{changes:f,range:L.jT.range(m.mapPos(h.anchor,1),m.mapPos(h.head,1))}})}const Kn=({state:o,dispatch:i})=>{if(o.readOnly)return!1;let l=Object.create(null),h=new Se.Gn(o,{overrideIndentation:m=>{let k=l[m];return k==null?-1:k}}),f=Zn(o,(m,k,T)=>{let B=(0,Se.K0)(h,m.from);if(B==null)return;/\S/.test(m.text)||(B=0);let J=/^\s*/.exec(m.text)[0],Y=(0,Se.SS)(o,B);(J!=Y||T.from<m.from+J.length)&&(l[m.from]=B,k.push({from:m.from,to:m.from+J.length,insert:Y}))});return f.changes.empty||i(o.update(f,{userEvent:"indent"})),!0},Jn=({state:o,dispatch:i})=>o.readOnly?!1:(i(o.update(Zn(o,(l,h)=>{h.push({from:l.from,insert:o.facet(Se.c)})}),{userEvent:"input.indent"})),!0),Rn=({state:o,dispatch:i})=>o.readOnly?!1:(i(o.update(Zn(o,(l,h)=>{let f=/^\s*/.exec(l.text)[0];if(!f)return;let m=(0,L.IS)(f,o.tabSize),k=0,T=(0,Se.SS)(o,Math.max(0,m-(0,Se.y1)(o)));for(;k<f.length&&k<T.length&&f.charCodeAt(k)==T.charCodeAt(k);)k++;h.push({from:l.from+k,to:l.from+f.length,insert:T.slice(k)})}),{userEvent:"delete.dedent"})),!0),Mr=({state:o,dispatch:i})=>o.selection.ranges.some(l=>!l.empty)?Jn({state:o,dispatch:i}):(i(o.update(o.replaceSelection("	"),{scrollIntoView:!0,userEvent:"input"})),!0),to=[{key:"Ctrl-b",run:xe,shift:Vn,preventDefault:!0},{key:"Ctrl-f",run:He,shift:fn},{key:"Ctrl-p",run:yt,shift:j},{key:"Ctrl-n",run:lt,shift:ne},{key:"Ctrl-a",run:zi,shift:zn},{key:"Ctrl-e",run:Ni,shift:mn},{key:"Ctrl-d",run:S},{key:"Ctrl-h",run:g},{key:"Ctrl-k",run:U},{key:"Ctrl-Alt-h",run:W},{key:"Ctrl-o",run:Wt},{key:"Ctrl-t",run:Ui},{key:"Ctrl-v",run:gi}],Er=[{key:"ArrowLeft",run:xe,shift:Vn,preventDefault:!0},{key:"Mod-ArrowLeft",mac:"Alt-ArrowLeft",run:dt,shift:ns,preventDefault:!0},{mac:"Cmd-ArrowLeft",run:Ci,shift:di,preventDefault:!0},{key:"ArrowRight",run:He,shift:fn,preventDefault:!0},{key:"Mod-ArrowRight",mac:"Alt-ArrowRight",run:ti,shift:On,preventDefault:!0},{mac:"Cmd-ArrowRight",run:Lt,shift:pi,preventDefault:!0},{key:"ArrowUp",run:yt,shift:j,preventDefault:!0},{mac:"Cmd-ArrowUp",run:Pn,shift:Rs},{mac:"Ctrl-ArrowUp",run:pt,shift:ye},{key:"ArrowDown",run:lt,shift:ne,preventDefault:!0},{mac:"Cmd-ArrowDown",run:Gt,shift:Bs},{mac:"Ctrl-ArrowDown",run:gi,shift:Ne},{key:"PageUp",run:pt,shift:ye},{key:"PageDown",run:gi,shift:Ne},{key:"Home",run:on,shift:Ut,preventDefault:!0},{key:"Mod-Home",run:Pn,shift:Rs},{key:"End",run:yi,shift:Be,preventDefault:!0},{key:"Mod-End",run:Gt,shift:Bs},{key:"Enter",run:un},{key:"Mod-a",run:qs},{key:"Backspace",run:g,shift:g},{key:"Delete",run:S},{key:"Mod-Backspace",mac:"Alt-Backspace",run:W},{key:"Mod-Delete",mac:"Alt-Delete",run:K},{mac:"Mod-Backspace",run:oe},{mac:"Mod-Delete",run:De}].concat(to.map(o=>({mac:o.key,run:o.run,shift:o.shift}))),io=[{key:"Alt-ArrowLeft",mac:"Ctrl-ArrowLeft",run:Jt,shift:E},{key:"Alt-ArrowRight",mac:"Ctrl-ArrowRight",run:ot,shift:D},{key:"Alt-ArrowUp",run:Tn},{key:"Shift-Alt-ArrowUp",run:Ht},{key:"Alt-ArrowDown",run:Qs},{key:"Shift-Alt-ArrowDown",run:Mn},{key:"Escape",run:bs},{key:"Mod-Enter",run:jn},{key:"Alt-l",mac:"Ctrl-l",run:vs},{key:"Mod-i",run:Ls,preventDefault:!0},{key:"Mod-[",run:Rn},{key:"Mod-]",run:Jn},{key:"Mod-Alt-\\",run:Kn},{key:"Shift-Mod-k",run:Sn},{key:"Shift-Mod-\\",run:Ki},{key:"Mod-/",run:bt},{key:"Alt-A",run:_e}].concat(Er),cr={key:"Tab",run:Jn,shift:Rn};function ii(){var o=arguments[0];typeof o=="string"&&(o=document.createElement(o));var i=1,l=arguments[1];if(l&&typeof l=="object"&&l.nodeType==null&&!Array.isArray(l)){for(var h in l)if(Object.prototype.hasOwnProperty.call(l,h)){var f=l[h];typeof f=="string"?o.setAttribute(h,f):f!=null&&(o[h]=f)}i++}for(;i<arguments.length;i++)fr(o,arguments[i]);return o}function fr(o,i){if(typeof i=="string")o.appendChild(document.createTextNode(i));else if(i!=null)if(i.nodeType!=null)o.appendChild(i);else if(Array.isArray(i))for(var l=0;l<i.length;l++)fr(o,i[l]);else throw new RangeError("Unsupported child node: "+i)}const Ns=typeof String.prototype.normalize=="function"?o=>o.normalize("NFKD"):o=>o;class En{constructor(i,l,h=0,f=i.length,m,k){this.test=k,this.value={from:0,to:0},this.done=!1,this.matches=[],this.buffer="",this.bufferPos=0,this.iter=i.iterRange(h,f),this.bufferStart=h,this.normalize=m?T=>m(Ns(T)):Ns,this.query=this.normalize(l)}peek(){if(this.bufferPos==this.buffer.length){if(this.bufferStart+=this.buffer.length,this.iter.next(),this.iter.done)return-1;this.bufferPos=0,this.buffer=this.iter.value}return(0,L.gm)(this.buffer,this.bufferPos)}next(){for(;this.matches.length;)this.matches.pop();return this.nextOverlapping()}nextOverlapping(){for(;;){let i=this.peek();if(i<0)return this.done=!0,this;let l=(0,L.bg)(i),h=this.bufferStart+this.bufferPos;this.bufferPos+=(0,L.nZ)(i);let f=this.normalize(l);for(let m=0,k=h;;m++){let T=f.charCodeAt(m),B=this.match(T,k);if(m==f.length-1){if(B)return this.value=B,this;break}k==h&&m<l.length&&l.charCodeAt(m)==T&&k++}}}match(i,l){let h=null;for(let f=0;f<this.matches.length;f+=2){let m=this.matches[f],k=!1;this.query.charCodeAt(m)==i&&(m==this.query.length-1?h={from:this.matches[f+1],to:l+1}:(this.matches[f]++,k=!0)),k||(this.matches.splice(f,2),f-=2)}return this.query.charCodeAt(0)==i&&(this.query.length==1?h={from:l,to:l+1}:this.matches.push(1,l)),h&&this.test&&!this.test(h.from,h.to,this.buffer,this.bufferStart)&&(h=null),h}}typeof Symbol!="undefined"&&(En.prototype[Symbol.iterator]=function(){return this});const ur={from:-1,to:-1,match:/.*/.exec("")},dr="gm"+(/x/.unicode==null?"":"u");class Dr{constructor(i,l,h,f=0,m=i.length){if(this.text=i,this.to=m,this.curLine="",this.done=!1,this.value=ur,/\\[sWDnr]|\n|\r|\[\^/.test(l))return new Or(i,l,h,f,m);this.re=new RegExp(l,dr+(h!=null&&h.ignoreCase?"i":"")),this.test=h==null?void 0:h.test,this.iter=i.iter();let k=i.lineAt(f);this.curLineStart=k.from,this.matchPos=_i(i,f),this.getLine(this.curLineStart)}getLine(i){this.iter.next(i),this.iter.lineBreak?this.curLine="":(this.curLine=this.iter.value,this.curLineStart+this.curLine.length>this.to&&(this.curLine=this.curLine.slice(0,this.to-this.curLineStart)),this.iter.next())}nextLine(){this.curLineStart=this.curLineStart+this.curLine.length+1,this.curLineStart>this.to?this.curLine="":this.getLine(0)}next(){for(let i=this.matchPos-this.curLineStart;;){this.re.lastIndex=i;let l=this.matchPos<=this.to&&this.re.exec(this.curLine);if(l){let h=this.curLineStart+l.index,f=h+l[0].length;if(this.matchPos=_i(this.text,f+(h==f?1:0)),h==this.curLineStart+this.curLine.length&&this.nextLine(),(h<f||h>this.value.to)&&(!this.test||this.test(h,f,l)))return this.value={from:h,to:f,match:l},this;i=this.matchPos-this.curLineStart}else if(this.curLineStart+this.curLine.length<this.to)this.nextLine(),i=0;else return this.done=!0,this}}}const Un=new WeakMap;class ws{constructor(i,l){this.from=i,this.text=l}get to(){return this.from+this.text.length}static get(i,l,h){let f=Un.get(i);if(!f||f.from>=h||f.to<=l){let T=new ws(l,i.sliceString(l,h));return Un.set(i,T),T}if(f.from==l&&f.to==h)return f;let{text:m,from:k}=f;return k>l&&(m=i.sliceString(l,k)+m,k=l),f.to<h&&(m+=i.sliceString(f.to,h)),Un.set(i,new ws(k,m)),new ws(l,m.slice(l-k,h-k))}}class Or{constructor(i,l,h,f,m){this.text=i,this.to=m,this.done=!1,this.value=ur,this.matchPos=_i(i,f),this.re=new RegExp(l,dr+(h!=null&&h.ignoreCase?"i":"")),this.test=h==null?void 0:h.test,this.flat=ws.get(i,f,this.chunkEnd(f+5e3))}chunkEnd(i){return i>=this.to?this.to:this.text.lineAt(i).to}next(){for(;;){let i=this.re.lastIndex=this.matchPos-this.flat.from,l=this.re.exec(this.flat.text);if(l&&!l[0]&&l.index==i&&(this.re.lastIndex=i+1,l=this.re.exec(this.flat.text)),l){let h=this.flat.from+l.index,f=h+l[0].length;if((this.flat.to>=this.to||l.index+l[0].length<=this.flat.text.length-10)&&(!this.test||this.test(h,f,l)))return this.value={from:h,to:f,match:l},this.matchPos=_i(this.text,f+(h==f?1:0)),this}if(this.flat.to==this.to)return this.done=!0,this;this.flat=ws.get(this.text,this.flat.from,this.chunkEnd(this.flat.from+this.flat.text.length*2))}}}typeof Symbol!="undefined"&&(Dr.prototype[Symbol.iterator]=Or.prototype[Symbol.iterator]=function(){return this});function yn(o){try{return new RegExp(o,dr),!0}catch{return!1}}function _i(o,i){if(i>=o.length)return i;let l=o.lineAt(i),h;for(;i<l.to&&(h=l.text.charCodeAt(i-l.from))>=56320&&h<57344;)i++;return i}function _s(o){let i=String(o.state.doc.lineAt(o.state.selection.main.head).number),l=ii("input",{class:"cm-textfield",name:"line",value:i}),h=ii("form",{class:"cm-gotoLine",onkeydown:m=>{m.keyCode==27?(m.preventDefault(),o.dispatch({effects:er.of(!1)}),o.focus()):m.keyCode==13&&(m.preventDefault(),f())},onsubmit:m=>{m.preventDefault(),f()}},ii("label",o.state.phrase("Go to line"),": ",l)," ",ii("button",{class:"cm-button",type:"submit"},o.state.phrase("go")));function f(){let m=/^([+-])?(\d+)?(:\d+)?(%)?$/.exec(l.value);if(!m)return;let{state:k}=o,T=k.doc.lineAt(k.selection.main.head),[,B,J,Y,ge]=m,Ie=Y?+Y.slice(1):0,ct=J?+J:T.number;if(J&&ge){let is=ct/100;B&&(is=is*(B=="-"?-1:1)+T.number/k.doc.lines),ct=Math.round(k.doc.lines*is)}else J&&B&&(ct=ct*(B=="-"?-1:1)+T.number);let Qt=k.doc.line(Math.max(1,Math.min(k.doc.lines,ct))),Yi=L.jT.cursor(Qt.from+Math.max(0,Math.min(Ie,Qt.length)));o.dispatch({effects:[er.of(!1),G.tk.scrollIntoView(Yi.from,{y:"center"})],selection:Yi}),o.focus()}return{dom:h}}const er=L.Py.define(),pr=L.QQ.define({create(){return!0},update(o,i){for(let l of i.effects)l.is(er)&&(o=l.value);return o},provide:o=>G.mH.from(o,i=>i?_s:null)}),tr=o=>{let i=(0,G.Sd)(o,_s);if(!i){let l=[er.of(!0)];o.state.field(pr,!1)==null&&l.push(L.Py.appendConfig.of([pr,Pr])),o.dispatch({effects:l}),i=(0,G.Sd)(o,_s)}return i&&i.dom.querySelector("input").select(),!0},Pr=G.tk.baseTheme({".cm-panel.cm-gotoLine":{padding:"2px 6px 4px","& label":{fontSize:"80%"}}}),Rr={highlightWordAroundCursor:!1,minSelectionLength:1,maxMatches:100,wholeWords:!1},Br=L.r$.define({combine(o){return(0,L.BO)(o,Rr,{highlightWordAroundCursor:(i,l)=>i||l,minSelectionLength:Math.min,maxMatches:Math.min})}});function Lr(o){let i=[so,Nr];return o&&i.push(Br.of(o)),i}const no=G.p.mark({class:"cm-selectionMatch"}),Ir=G.p.mark({class:"cm-selectionMatch cm-selectionMatch-main"});function Fs(o,i,l,h){return(l==0||o(i.sliceDoc(l-1,l))!=L.D0.Word)&&(h==i.doc.length||o(i.sliceDoc(h,h+1))!=L.D0.Word)}function ir(o,i,l,h){return o(i.sliceDoc(l,l+1))==L.D0.Word&&o(i.sliceDoc(h-1,h))==L.D0.Word}const Nr=G.lg.fromClass(class{constructor(o){this.decorations=this.getDeco(o)}update(o){(o.selectionSet||o.docChanged||o.viewportChanged)&&(this.decorations=this.getDeco(o.view))}getDeco(o){let i=o.state.facet(Br),{state:l}=o,h=l.selection;if(h.ranges.length>1)return G.p.none;let f=h.main,m,k=null;if(f.empty){if(!i.highlightWordAroundCursor)return G.p.none;let B=l.wordAt(f.head);if(!B)return G.p.none;k=l.charCategorizer(f.head),m=l.sliceDoc(B.from,B.to)}else{let B=f.to-f.from;if(B<i.minSelectionLength||B>200)return G.p.none;if(i.wholeWords){if(m=l.sliceDoc(f.from,f.to),k=l.charCategorizer(f.head),!(Fs(k,l,f.from,f.to)&&ir(k,l,f.from,f.to)))return G.p.none}else if(m=l.sliceDoc(f.from,f.to).trim(),!m)return G.p.none}let T=[];for(let B of o.visibleRanges){let J=new En(l.doc,m,B.from,B.to);for(;!J.next().done;){let{from:Y,to:ge}=J.value;if((!k||Fs(k,l,Y,ge))&&(f.empty&&Y<=f.from&&ge>=f.to?T.push(Ir.range(Y,ge)):(Y>=f.to||ge<=f.from)&&T.push(no.range(Y,ge)),T.length>i.maxMatches))return G.p.none}}return G.p.set(T)}},{decorations:o=>o.decorations}),so=G.tk.baseTheme({".cm-selectionMatch":{backgroundColor:"#99ff7780"},".cm-searchMatch .cm-selectionMatch":{backgroundColor:"transparent"}}),ro=({state:o,dispatch:i})=>{let{selection:l}=o,h=L.jT.create(l.ranges.map(f=>o.wordAt(f.head)||L.jT.cursor(f.head)),l.mainIndex);return h.eq(l)?!1:(i(o.update({selection:h})),!0)};function Fr(o,i){let{main:l,ranges:h}=o.selection,f=o.wordAt(l.head),m=f&&f.from==l.from&&f.to==l.to;for(let k=!1,T=new En(o.doc,i,h[h.length-1].to);;)if(T.next(),T.done){if(k)return null;T=new En(o.doc,i,0,Math.max(0,h[h.length-1].from-1)),k=!0}else{if(k&&h.some(B=>B.from==T.value.from))continue;if(m){let B=o.wordAt(T.value.from);if(!B||B.from!=T.value.from||B.to!=T.value.to)continue}return T.value}}const oo=({state:o,dispatch:i})=>{let{ranges:l}=o.selection;if(l.some(m=>m.from===m.to))return ro({state:o,dispatch:i});let h=o.sliceDoc(l[0].from,l[0].to);if(o.selection.ranges.some(m=>o.sliceDoc(m.from,m.to)!=h))return!1;let f=Fr(o,h);return f?(i(o.update({selection:o.selection.addRange(L.jT.range(f.from,f.to),!1),effects:G.tk.scrollIntoView(f.to)})),!0):!1},os=L.r$.define({combine(o){return(0,L.BO)(o,{top:!1,caseSensitive:!1,literal:!1,regexp:!1,wholeWord:!1,createPanel:i=>new an(i),scrollToMatch:i=>G.tk.scrollIntoView(i)})}});function V(o){return o?[os.of(o),vn]:vn}class z{constructor(i){this.search=i.search,this.caseSensitive=!!i.caseSensitive,this.literal=!!i.literal,this.regexp=!!i.regexp,this.replace=i.replace||"",this.valid=!!this.search&&(!this.regexp||yn(this.search)),this.unquoted=this.unquote(this.search),this.wholeWord=!!i.wholeWord}unquote(i){return this.literal?i:i.replace(/\\([nrt\\])/g,(l,h)=>h=="n"?`
`:h=="r"?"\r":h=="t"?"	":"\\")}eq(i){return this.search==i.search&&this.replace==i.replace&&this.caseSensitive==i.caseSensitive&&this.regexp==i.regexp&&this.wholeWord==i.wholeWord}create(){return this.regexp?new Ae(this):new pe(this)}getCursor(i,l=0,h){let f=i.doc?i:L.yy.create({doc:i});return h==null&&(h=f.doc.length),this.regexp?ve(this,f,l,h):ie(this,f,l,h)}}class Q{constructor(i){this.spec=i}}function ie(o,i,l,h){return new En(i.doc,o.unquoted,l,h,o.caseSensitive?void 0:f=>f.toLowerCase(),o.wholeWord?ce(i.doc,i.charCategorizer(i.selection.main.head)):void 0)}function ce(o,i){return(l,h,f,m)=>((m>l||m+f.length<h)&&(m=Math.max(0,l-2),f=o.sliceString(m,Math.min(o.length,h+2))),(i($e(f,l-m))!=L.D0.Word||i(Tt(f,l-m))!=L.D0.Word)&&(i(Tt(f,h-m))!=L.D0.Word||i($e(f,h-m))!=L.D0.Word))}class pe extends Q{constructor(i){super(i)}nextMatch(i,l,h){let f=ie(this.spec,i,h,i.doc.length).nextOverlapping();return f.done&&(f=ie(this.spec,i,0,l).nextOverlapping()),f.done?null:f.value}prevMatchInRange(i,l,h){for(let f=h;;){let m=Math.max(l,f-1e4-this.spec.unquoted.length),k=ie(this.spec,i,m,f),T=null;for(;!k.nextOverlapping().done;)T=k.value;if(T)return T;if(m==l)return null;f-=1e4}}prevMatch(i,l,h){return this.prevMatchInRange(i,0,l)||this.prevMatchInRange(i,h,i.doc.length)}getReplacement(i){return this.spec.unquote(this.spec.replace)}matchAll(i,l){let h=ie(this.spec,i,0,i.doc.length),f=[];for(;!h.next().done;){if(f.length>=l)return null;f.push(h.value)}return f}highlight(i,l,h,f){let m=ie(this.spec,i,Math.max(0,l-this.spec.unquoted.length),Math.min(h+this.spec.unquoted.length,i.doc.length));for(;!m.next().done;)f(m.value.from,m.value.to)}}function ve(o,i,l,h){return new Dr(i.doc,o.search,{ignoreCase:!o.caseSensitive,test:o.wholeWord?it(i.charCategorizer(i.selection.main.head)):void 0},l,h)}function $e(o,i){return o.slice((0,L.cp)(o,i,!1),i)}function Tt(o,i){return o.slice(i,(0,L.cp)(o,i))}function it(o){return(i,l,h)=>!h[0].length||(o($e(h.input,h.index))!=L.D0.Word||o(Tt(h.input,h.index))!=L.D0.Word)&&(o(Tt(h.input,h.index+h[0].length))!=L.D0.Word||o($e(h.input,h.index+h[0].length))!=L.D0.Word)}class Ae extends Q{nextMatch(i,l,h){let f=ve(this.spec,i,h,i.doc.length).next();return f.done&&(f=ve(this.spec,i,0,l).next()),f.done?null:f.value}prevMatchInRange(i,l,h){for(let f=1;;f++){let m=Math.max(l,h-f*1e4),k=ve(this.spec,i,m,h),T=null;for(;!k.next().done;)T=k.value;if(T&&(m==l||T.from>m+10))return T;if(m==l)return null}}prevMatch(i,l,h){return this.prevMatchInRange(i,0,l)||this.prevMatchInRange(i,h,i.doc.length)}getReplacement(i){return this.spec.unquote(this.spec.replace).replace(/\$([$&\d+])/g,(l,h)=>h=="$"?"$":h=="&"?i.match[0]:h!="0"&&+h<i.match.length?i.match[h]:l)}matchAll(i,l){let h=ve(this.spec,i,0,i.doc.length),f=[];for(;!h.next().done;){if(f.length>=l)return null;f.push(h.value)}return f}highlight(i,l,h,f){let m=ve(this.spec,i,Math.max(0,l-250),Math.min(h+250,i.doc.length));for(;!m.next().done;)f(m.value.from,m.value.to)}}const Re=L.Py.define(),Me=L.Py.define(),vt=L.QQ.define({create(o){return new Ri(Bn(o).create(),null)},update(o,i){for(let l of i.effects)l.is(Re)?o=new Ri(l.value.create(),o.panel):l.is(Me)&&(o=new Ri(o.query,l.value?en:null));return o},provide:o=>G.mH.from(o,i=>i.panel)});function qe(o){let i=o.field(vt,!1);return i?i.query.spec:Bn(o)}function St(o){var i;return((i=o.field(vt,!1))===null||i===void 0?void 0:i.panel)!=null}class Ri{constructor(i,l){this.query=i,this.panel=l}}const Bi=G.p.mark({class:"cm-searchMatch"}),Gi=G.p.mark({class:"cm-searchMatch cm-searchMatch-selected"}),Ai=G.lg.fromClass(class{constructor(o){this.view=o,this.decorations=this.highlight(o.state.field(vt))}update(o){let i=o.state.field(vt);(i!=o.startState.field(vt)||o.docChanged||o.selectionSet||o.viewportChanged)&&(this.decorations=this.highlight(i))}highlight({query:o,panel:i}){if(!i||!o.spec.valid)return G.p.none;let{view:l}=this,h=new L.f_;for(let f=0,m=l.visibleRanges,k=m.length;f<k;f++){let{from:T,to:B}=m[f];for(;f<k-1&&B>m[f+1].from-2*250;)B=m[++f].to;o.highlight(l.state,T,B,(J,Y)=>{let ge=l.state.selection.ranges.some(Ie=>Ie.from==J&&Ie.to==Y);h.add(J,Y,ge?Gi:Bi)})}return h.finish()}},{decorations:o=>o.decorations});function Di(o){return i=>{let l=i.state.field(vt,!1);return l&&l.query.spec.valid?o(i,l):ji(i)}}const $i=Di((o,{query:i})=>{let{to:l}=o.state.selection.main,h=i.nextMatch(o.state,l,l);if(!h)return!1;let f=L.jT.single(h.from,h.to),m=o.state.facet(os);return o.dispatch({selection:f,effects:[Fi(o,h),m.scrollToMatch(f.main,o)],userEvent:"select.search"}),ln(o),!0}),Vt=Di((o,{query:i})=>{let{state:l}=o,{from:h}=l.selection.main,f=i.prevMatch(l,h,h);if(!f)return!1;let m=L.jT.single(f.from,f.to),k=o.state.facet(os);return o.dispatch({selection:m,effects:[Fi(o,f),k.scrollToMatch(m.main,o)],userEvent:"select.search"}),ln(o),!0}),Gn=Di((o,{query:i})=>{let l=i.matchAll(o.state,1e3);return!l||!l.length?!1:(o.dispatch({selection:L.jT.create(l.map(h=>L.jT.range(h.from,h.to))),userEvent:"select.search.matches"}),!0)}),oi=({state:o,dispatch:i})=>{let l=o.selection;if(l.ranges.length>1||l.main.empty)return!1;let{from:h,to:f}=l.main,m=[],k=0;for(let T=new En(o.doc,o.sliceDoc(h,f));!T.next().done;){if(m.length>1e3)return!1;T.value.from==h&&(k=m.length),m.push(L.jT.range(T.value.from,T.value.to))}return i(o.update({selection:L.jT.create(m,k),userEvent:"select.search.matches"})),!0},Li=Di((o,{query:i})=>{let{state:l}=o,{from:h,to:f}=l.selection.main;if(l.readOnly)return!1;let m=i.nextMatch(l,h,h);if(!m)return!1;let k=[],T,B,J=[];if(m.from==h&&m.to==f&&(B=l.toText(i.getReplacement(m)),k.push({from:m.from,to:m.to,insert:B}),m=i.nextMatch(l,m.from,m.to),J.push(G.tk.announce.of(l.phrase("replaced match on line $",l.doc.lineAt(h).number)+"."))),m){let Y=k.length==0||k[0].from>=m.to?0:m.to-m.from-B.length;T=L.jT.single(m.from-Y,m.to-Y),J.push(Fi(o,m)),J.push(l.facet(os).scrollToMatch(T.main,o))}return o.dispatch({changes:k,selection:T,effects:J,userEvent:"input.replace"}),!0}),Xi=Di((o,{query:i})=>{if(o.state.readOnly)return!1;let l=i.matchAll(o.state,1e9).map(f=>{let{from:m,to:k}=f;return{from:m,to:k,insert:i.getReplacement(f)}});if(!l.length)return!1;let h=o.state.phrase("replaced $ matches",l.length)+".";return o.dispatch({changes:l,effects:G.tk.announce.of(h),userEvent:"input.replace.all"}),!0});function en(o){return o.state.facet(os).createPanel(o)}function Bn(o,i){var l,h,f,m,k;let T=o.selection.main,B=T.empty||T.to>T.from+100?"":o.sliceDoc(T.from,T.to);if(i&&!B)return i;let J=o.facet(os);return new z({search:((l=i==null?void 0:i.literal)!==null&&l!==void 0?l:J.literal)?B:B.replace(/\n/g,"\\n"),caseSensitive:(h=i==null?void 0:i.caseSensitive)!==null&&h!==void 0?h:J.caseSensitive,literal:(f=i==null?void 0:i.literal)!==null&&f!==void 0?f:J.literal,regexp:(m=i==null?void 0:i.regexp)!==null&&m!==void 0?m:J.regexp,wholeWord:(k=i==null?void 0:i.wholeWord)!==null&&k!==void 0?k:J.wholeWord})}function li(o){let i=(0,G.Sd)(o,en);return i&&i.dom.querySelector("[main-field]")}function ln(o){let i=li(o);i&&i==o.root.activeElement&&i.select()}const ji=o=>{let i=o.state.field(vt,!1);if(i&&i.panel){let l=li(o);if(l&&l!=o.root.activeElement){let h=Bn(o.state,i.query.spec);h.valid&&o.dispatch({effects:Re.of(h)}),l.focus(),l.select()}}else o.dispatch({effects:[Me.of(!0),i?Re.of(Bn(o.state,i.query.spec)):L.Py.appendConfig.of(vn)]});return!0},Ws=o=>{let i=o.state.field(vt,!1);if(!i||!i.panel)return!1;let l=(0,G.Sd)(o,en);return l&&l.dom.contains(o.root.activeElement)&&o.focus(),o.dispatch({effects:Me.of(!1)}),!0},nr=[{key:"Mod-f",run:ji,scope:"editor search-panel"},{key:"F3",run:$i,shift:Vt,scope:"editor search-panel",preventDefault:!0},{key:"Mod-g",run:$i,shift:Vt,scope:"editor search-panel",preventDefault:!0},{key:"Escape",run:Ws,scope:"editor search-panel"},{key:"Mod-Shift-l",run:oi},{key:"Mod-Alt-g",run:tr},{key:"Mod-d",run:oo,preventDefault:!0}];class an{constructor(i){this.view=i;let l=this.query=i.state.field(vt).query.spec;this.commit=this.commit.bind(this),this.searchField=ii("input",{value:l.search,placeholder:Ii(i,"Find"),"aria-label":Ii(i,"Find"),class:"cm-textfield",name:"search",form:"","main-field":"true",onchange:this.commit,onkeyup:this.commit}),this.replaceField=ii("input",{value:l.replace,placeholder:Ii(i,"Replace"),"aria-label":Ii(i,"Replace"),class:"cm-textfield",name:"replace",form:"",onchange:this.commit,onkeyup:this.commit}),this.caseField=ii("input",{type:"checkbox",name:"case",form:"",checked:l.caseSensitive,onchange:this.commit}),this.reField=ii("input",{type:"checkbox",name:"re",form:"",checked:l.regexp,onchange:this.commit}),this.wordField=ii("input",{type:"checkbox",name:"word",form:"",checked:l.wholeWord,onchange:this.commit});function h(f,m,k){return ii("button",{class:"cm-button",name:f,onclick:m,type:"button"},k)}this.dom=ii("div",{onkeydown:f=>this.keydown(f),class:"cm-search"},[this.searchField,h("next",()=>$i(i),[Ii(i,"next")]),h("prev",()=>Vt(i),[Ii(i,"previous")]),h("select",()=>Gn(i),[Ii(i,"all")]),ii("label",null,[this.caseField,Ii(i,"match case")]),ii("label",null,[this.reField,Ii(i,"regexp")]),ii("label",null,[this.wordField,Ii(i,"by word")]),...i.state.readOnly?[]:[ii("br"),this.replaceField,h("replace",()=>Li(i),[Ii(i,"replace")]),h("replaceAll",()=>Xi(i),[Ii(i,"replace all")])],ii("button",{name:"close",onclick:()=>Ws(i),"aria-label":Ii(i,"close"),type:"button"},["\xD7"])])}commit(){let i=new z({search:this.searchField.value,caseSensitive:this.caseField.checked,regexp:this.reField.checked,wholeWord:this.wordField.checked,replace:this.replaceField.value});i.eq(this.query)||(this.query=i,this.view.dispatch({effects:Re.of(i)}))}keydown(i){(0,G.$1)(this.view,i,"search-panel")?i.preventDefault():i.keyCode==13&&i.target==this.searchField?(i.preventDefault(),(i.shiftKey?Vt:$i)(this.view)):i.keyCode==13&&i.target==this.replaceField&&(i.preventDefault(),Li(this.view))}update(i){for(let l of i.transactions)for(let h of l.effects)h.is(Re)&&!h.value.eq(this.query)&&this.setQuery(h.value)}setQuery(i){this.query=i,this.searchField.value=i.search,this.replaceField.value=i.replace,this.caseField.checked=i.caseSensitive,this.reField.checked=i.regexp,this.wordField.checked=i.wholeWord}mount(){this.searchField.select()}get pos(){return 80}get top(){return this.view.state.facet(os).top}}function Ii(o,i){return o.state.phrase(i)}const Xn=30,Ln=/[\s\.,:;?!]/;function Fi(o,{from:i,to:l}){let h=o.state.doc.lineAt(i),f=o.state.doc.lineAt(l).to,m=Math.max(h.from,i-Xn),k=Math.min(f,l+Xn),T=o.state.sliceDoc(m,k);if(m!=h.from){for(let B=0;B<Xn;B++)if(!Ln.test(T[B+1])&&Ln.test(T[B])){T=T.slice(B);break}}if(k!=f){for(let B=T.length-1;B>T.length-Xn;B--)if(!Ln.test(T[B-1])&&Ln.test(T[B])){T=T.slice(0,B);break}}return G.tk.announce.of(`${o.state.phrase("current match")}. ${T} ${o.state.phrase("on line")} ${h.number}.`)}const In=G.tk.baseTheme({".cm-panel.cm-search":{padding:"2px 6px 4px",position:"relative","& [name=close]":{position:"absolute",top:"0",right:"4px",backgroundColor:"inherit",border:"none",font:"inherit",padding:0,margin:0},"& input, & button, & label":{margin:".2em .6em .2em 0"},"& input[type=checkbox]":{marginRight:".2em"},"& label":{fontSize:"80%",whiteSpace:"pre"}},"&light .cm-searchMatch":{backgroundColor:"#ffff0054"},"&dark .cm-searchMatch":{backgroundColor:"#00ffff8a"},"&light .cm-searchMatch-selected":{backgroundColor:"#ff6a0054"},"&dark .cm-searchMatch-selected":{backgroundColor:"#ff00ff8a"}}),vn=[vt,L.Wl.low(Ai),In];class ls{constructor(i,l,h){this.state=i,this.pos=l,this.explicit=h,this.abortListeners=[]}tokenBefore(i){let l=(0,Se.qz)(this.state).resolveInner(this.pos,-1);for(;l&&i.indexOf(l.name)<0;)l=l.parent;return l?{from:l.from,to:this.pos,text:this.state.sliceDoc(l.from,this.pos),type:l.type}:null}matchBefore(i){let l=this.state.doc.lineAt(this.pos),h=Math.max(l.from,this.pos-250),f=l.text.slice(h-l.from,this.pos-l.from),m=f.search(Ss(i,!1));return m<0?null:{from:h+m,to:this.pos,text:f.slice(m)}}get aborted(){return this.abortListeners==null}addEventListener(i,l){i=="abort"&&this.abortListeners&&this.abortListeners.push(l)}}function Hs(o){let i=Object.keys(o).join(""),l=/\w/.test(i);return l&&(i=i.replace(/\w/g,"")),`[${l?"\\w":""}${i.replace(/[^\w\s]/g,"\\$&")}]`}function tn(o){let i=Object.create(null),l=Object.create(null);for(let{label:f}of o){i[f[0]]=!0;for(let m=1;m<f.length;m++)l[f[m]]=!0}let h=Hs(i)+Hs(l)+"*$";return[new RegExp("^"+h),new RegExp(h)]}function sr(o){let i=o.map(f=>typeof f=="string"?{label:f}:f),[l,h]=i.every(f=>/^\w+$/.test(f.label))?[/\w*$/,/\w+$/]:tn(i);return f=>{let m=f.matchBefore(h);return m||f.explicit?{from:m?m.from:f.pos,options:i,validFor:l}:null}}function Vs(o,i){return l=>{for(let h=syntaxTree(l.state).resolveInner(l.pos,-1);h;h=h.parent){if(o.indexOf(h.name)>-1)return i(l);if(h.type.isTop)break}return null}}function as(o,i){return l=>{for(let h=syntaxTree(l.state).resolveInner(l.pos,-1);h;h=h.parent){if(o.indexOf(h.name)>-1)return null;if(h.type.isTop)break}return i(l)}}class Nn{constructor(i,l,h,f){this.completion=i,this.source=l,this.match=h,this.score=f}}function dn(o){return o.selection.main.from}function Ss(o,i){var l;let{source:h}=o,f=i&&h[0]!="^",m=h[h.length-1]!="$";return!f&&!m?o:new RegExp(`${f?"^":""}(?:${h})${m?"$":""}`,(l=o.flags)!==null&&l!==void 0?l:o.ignoreCase?"i":"")}const Fn=L.q6.define();function Wn(o,i,l,h){let{main:f}=o.selection,m=l-f.from,k=h-f.from;return Object.assign(Object.assign({},o.changeByRange(T=>T!=f&&l!=h&&o.sliceDoc(T.from+m,T.from+k)!=o.sliceDoc(l,h)?{range:T}:{changes:{from:T.from+m,to:h==f.from?T.to:T.from+k,insert:i},range:L.jT.cursor(T.from+m+i.length)})),{scrollIntoView:!0,userEvent:"input.complete"})}const Yn=new WeakMap;function qn(o){if(!Array.isArray(o))return o;let i=Yn.get(o);return i||Yn.set(o,i=sr(o)),i}const Qn=L.Py.define(),Hn=L.Py.define();class zs{constructor(i){this.pattern=i,this.chars=[],this.folded=[],this.any=[],this.precise=[],this.byWord=[],this.score=0,this.matched=[];for(let l=0;l<i.length;){let h=(0,L.gm)(i,l),f=(0,L.nZ)(h);this.chars.push(h);let m=i.slice(l,l+f),k=m.toUpperCase();this.folded.push((0,L.gm)(k==m?m.toLowerCase():k,0)),l+=f}this.astral=i.length!=this.chars.length}ret(i,l){return this.score=i,this.matched=l,!0}match(i){if(this.pattern.length==0)return this.ret(-100,[]);if(i.length<this.pattern.length)return!1;let{chars:l,folded:h,any:f,precise:m,byWord:k}=this;if(l.length==1){let Ti=(0,L.gm)(i,0),gs=(0,L.nZ)(Ti),Dn=gs==i.length?0:-100;if(Ti!=l[0])if(Ti==h[0])Dn+=-200;else return!1;return this.ret(Dn,[0,gs])}let T=i.indexOf(this.pattern);if(T==0)return this.ret(i.length==this.pattern.length?0:-100,[0,this.pattern.length]);let B=l.length,J=0;if(T<0){for(let Ti=0,gs=Math.min(i.length,200);Ti<gs&&J<B;){let Dn=(0,L.gm)(i,Ti);(Dn==l[J]||Dn==h[J])&&(f[J++]=Ti),Ti+=(0,L.nZ)(Dn)}if(J<B)return!1}let Y=0,ge=0,Ie=!1,ct=0,Qt=-1,Yi=-1,is=/[a-z]/.test(i),Ds=!0;for(let Ti=0,gs=Math.min(i.length,200),Dn=0;Ti<gs&&ge<B;){let hn=(0,L.gm)(i,Ti);T<0&&(Y<B&&hn==l[Y]&&(m[Y++]=Ti),ct<B&&(hn==l[ct]||hn==h[ct]?(ct==0&&(Qt=Ti),Yi=Ti+1,ct++):ct=0));let Os,Ps=hn<255?hn>=48&&hn<=57||hn>=97&&hn<=122?2:hn>=65&&hn<=90?1:0:(Os=(0,L.bg)(hn))!=Os.toLowerCase()?1:Os!=Os.toUpperCase()?2:0;(!Ti||Ps==1&&is||Dn==0&&Ps!=0)&&(l[ge]==hn||h[ge]==hn&&(Ie=!0)?k[ge++]=Ti:k.length&&(Ds=!1)),Dn=Ps,Ti+=(0,L.nZ)(hn)}return ge==B&&k[0]==0&&Ds?this.result(-100+(Ie?-200:0),k,i):ct==B&&Qt==0?this.ret(-200-i.length+(Yi==i.length?0:-100),[0,Yi]):T>-1?this.ret(-700-i.length,[T,T+this.pattern.length]):ct==B?this.ret(-200+-700-i.length,[Qt,Yi]):ge==B?this.result(-100+(Ie?-200:0)+-700+(Ds?0:-1100),k,i):l.length==2?!1:this.result((f[0]?-700:0)+-200+-1100,f,i)}result(i,l,h){let f=[],m=0;for(let k of l){let T=k+(this.astral?(0,L.nZ)((0,L.gm)(h,k)):1);m&&f[m-1]==k?f[m-1]=T:(f[m++]=k,f[m++]=T)}return this.ret(i-h.length,f)}}const wi=L.r$.define({combine(o){return(0,L.BO)(o,{activateOnTyping:!0,selectOnOpen:!0,override:null,closeOnBlur:!0,maxRenderedOptions:100,defaultKeymap:!0,tooltipClass:()=>"",optionClass:()=>"",aboveCursor:!1,icons:!0,addToOptions:[],positionInfo:Mt,compareCompletions:(i,l)=>i.label.localeCompare(l.label),interactionDelay:75,updateSyncTime:100},{defaultKeymap:(i,l)=>i&&l,closeOnBlur:(i,l)=>i&&l,icons:(i,l)=>i&&l,tooltipClass:(i,l)=>h=>bn(i(h),l(h)),optionClass:(i,l)=>h=>bn(i(h),l(h)),addToOptions:(i,l)=>i.concat(l)})}});function bn(o,i){return o?i?o+" "+i:o:i}function Mt(o,i,l,h,f,m){let k=o.textDirection==G.Nm.RTL,T=k,B=!1,J="top",Y,ge,Ie=i.left-f.left,ct=f.right-i.right,Qt=h.right-h.left,Yi=h.bottom-h.top;if(T&&Ie<Math.min(Qt,ct)?T=!1:!T&&ct<Math.min(Qt,Ie)&&(T=!0),Qt<=(T?Ie:ct))Y=Math.max(f.top,Math.min(l.top,f.bottom-Yi))-i.top,ge=Math.min(400,T?Ie:ct);else{B=!0,ge=Math.min(400,(k?i.right:f.right-i.left)-30);let Ti=f.bottom-i.bottom;Ti>=Yi||Ti>i.top?Y=l.bottom-i.top:(J="bottom",Y=i.bottom-l.top)}let is=(i.bottom-i.top)/m.offsetHeight,Ds=(i.right-i.left)/m.offsetWidth;return{style:`${J}: ${Y/is}px; max-width: ${ge/Ds}px`,class:"cm-completionInfo-"+(B?k?"left-narrow":"right-narrow":T?"left":"right")}}function xn(o){let i=o.addToOptions.slice();return o.icons&&i.push({render(l){let h=document.createElement("div");return h.classList.add("cm-completionIcon"),l.type&&h.classList.add(...l.type.split(/\s+/g).map(f=>"cm-completionIcon-"+f)),h.setAttribute("aria-hidden","true"),h},position:20}),i.push({render(l,h,f,m){let k=document.createElement("span");k.className="cm-completionLabel";let T=l.displayLabel||l.label,B=0;for(let J=0;J<m.length;){let Y=m[J++],ge=m[J++];Y>B&&k.appendChild(document.createTextNode(T.slice(B,Y)));let Ie=k.appendChild(document.createElement("span"));Ie.appendChild(document.createTextNode(T.slice(Y,ge))),Ie.className="cm-completionMatchedText",B=ge}return B<T.length&&k.appendChild(document.createTextNode(T.slice(B))),k},position:50},{render(l){if(!l.detail)return null;let h=document.createElement("span");return h.className="cm-completionDetail",h.textContent=l.detail,h},position:80}),i.sort((l,h)=>l.position-h.position).map(l=>l.render)}function hs(o,i,l){if(o<=l)return{from:0,to:o};if(i<0&&(i=0),i<=o>>1){let f=Math.floor(i/l);return{from:f*l,to:(f+1)*l}}let h=Math.floor((o-i)/l);return{from:o-(h+1)*l,to:o-h*l}}class cs{constructor(i,l,h){this.view=i,this.stateField=l,this.applyCompletion=h,this.info=null,this.infoDestroy=null,this.placeInfoReq={read:()=>this.measureInfo(),write:B=>this.placeInfo(B),key:this},this.space=null,this.currentClass="";let f=i.state.field(l),{options:m,selected:k}=f.open,T=i.state.facet(wi);this.optionContent=xn(T),this.optionClass=T.optionClass,this.tooltipClass=T.tooltipClass,this.range=hs(m.length,k,T.maxRenderedOptions),this.dom=document.createElement("div"),this.dom.className="cm-tooltip-autocomplete",this.updateTooltipClass(i.state),this.dom.addEventListener("mousedown",B=>{let{options:J}=i.state.field(l).open;for(let Y=B.target,ge;Y&&Y!=this.dom;Y=Y.parentNode)if(Y.nodeName=="LI"&&(ge=/-(\d+)$/.exec(Y.id))&&+ge[1]<J.length){this.applyCompletion(i,J[+ge[1]]),B.preventDefault();return}}),this.dom.addEventListener("focusout",B=>{let J=i.state.field(this.stateField,!1);J&&J.tooltip&&i.state.facet(wi).closeOnBlur&&B.relatedTarget!=i.contentDOM&&i.dispatch({effects:Hn.of(null)})}),this.showOptions(m,f.id)}mount(){this.updateSel()}showOptions(i,l){this.list&&this.list.remove(),this.list=this.dom.appendChild(this.createListBox(i,l,this.range)),this.list.addEventListener("scroll",()=>{this.info&&this.view.requestMeasure(this.placeInfoReq)})}update(i){var l;let h=i.state.field(this.stateField),f=i.startState.field(this.stateField);if(this.updateTooltipClass(i.state),h!=f){let{options:m,selected:k,disabled:T}=h.open;(!f.open||f.open.options!=m)&&(this.range=hs(m.length,k,i.state.facet(wi).maxRenderedOptions),this.showOptions(m,h.id)),this.updateSel(),T!=((l=f.open)===null||l===void 0?void 0:l.disabled)&&this.dom.classList.toggle("cm-tooltip-autocomplete-disabled",!!T)}}updateTooltipClass(i){let l=this.tooltipClass(i);if(l!=this.currentClass){for(let h of this.currentClass.split(" "))h&&this.dom.classList.remove(h);for(let h of l.split(" "))h&&this.dom.classList.add(h);this.currentClass=l}}positioned(i){this.space=i,this.info&&this.view.requestMeasure(this.placeInfoReq)}updateSel(){let i=this.view.state.field(this.stateField),l=i.open;if((l.selected>-1&&l.selected<this.range.from||l.selected>=this.range.to)&&(this.range=hs(l.options.length,l.selected,this.view.state.facet(wi).maxRenderedOptions),this.showOptions(l.options,i.id)),this.updateSelectedOption(l.selected)){this.destroyInfo();let{completion:h}=l.options[l.selected],{info:f}=h;if(!f)return;let m=typeof f=="string"?document.createTextNode(f):f(h);if(!m)return;"then"in m?m.then(k=>{k&&this.view.state.field(this.stateField,!1)==i&&this.addInfoPane(k,h)}).catch(k=>(0,G.OO)(this.view.state,k,"completion info")):this.addInfoPane(m,h)}}addInfoPane(i,l){this.destroyInfo();let h=this.info=document.createElement("div");if(h.className="cm-tooltip cm-completionInfo",i.nodeType!=null)h.appendChild(i),this.infoDestroy=null;else{let{dom:f,destroy:m}=i;h.appendChild(f),this.infoDestroy=m||null}this.dom.appendChild(h),this.view.requestMeasure(this.placeInfoReq)}updateSelectedOption(i){let l=null;for(let h=this.list.firstChild,f=this.range.from;h;h=h.nextSibling,f++)h.nodeName!="LI"||!h.id?f--:f==i?h.hasAttribute("aria-selected")||(h.setAttribute("aria-selected","true"),l=h):h.hasAttribute("aria-selected")&&h.removeAttribute("aria-selected");return l&&mr(this.list,l),l}measureInfo(){let i=this.dom.querySelector("[aria-selected]");if(!i||!this.info)return null;let l=this.dom.getBoundingClientRect(),h=this.info.getBoundingClientRect(),f=i.getBoundingClientRect(),m=this.space;if(!m){let k=this.dom.ownerDocument.defaultView||window;m={left:0,top:0,right:k.innerWidth,bottom:k.innerHeight}}return f.top>Math.min(m.bottom,l.bottom)-10||f.bottom<Math.max(m.top,l.top)+10?null:this.view.state.facet(wi).positionInfo(this.view,l,f,h,m,this.dom)}placeInfo(i){this.info&&(i?(i.style&&(this.info.style.cssText=i.style),this.info.className="cm-tooltip cm-completionInfo "+(i.class||"")):this.info.style.cssText="top: -1e6px")}createListBox(i,l,h){const f=document.createElement("ul");f.id=l,f.setAttribute("role","listbox"),f.setAttribute("aria-expanded","true"),f.setAttribute("aria-label",this.view.state.phrase("Completions"));let m=null;for(let k=h.from;k<h.to;k++){let{completion:T,match:B}=i[k],{section:J}=T;if(J){let Ie=typeof J=="string"?J:J.name;if(Ie!=m&&(k>h.from||h.from==0))if(m=Ie,typeof J!="string"&&J.header)f.appendChild(J.header(J));else{let ct=f.appendChild(document.createElement("completion-section"));ct.textContent=Ie}}const Y=f.appendChild(document.createElement("li"));Y.id=l+"-"+k,Y.setAttribute("role","option");let ge=this.optionClass(T);ge&&(Y.className=ge);for(let Ie of this.optionContent){let ct=Ie(T,this.view.state,this.view,B);ct&&Y.appendChild(ct)}}return h.from&&f.classList.add("cm-completionListIncompleteTop"),h.to<i.length&&f.classList.add("cm-completionListIncompleteBottom"),f}destroyInfo(){this.info&&(this.infoDestroy&&this.infoDestroy(),this.info.remove(),this.info=null)}destroy(){this.destroyInfo()}}function rr(o,i){return l=>new cs(l,o,i)}function mr(o,i){let l=o.getBoundingClientRect(),h=i.getBoundingClientRect(),f=l.height/o.offsetHeight;h.top<l.top?o.scrollTop-=(l.top-h.top)/f:h.bottom>l.bottom&&(o.scrollTop+=(h.bottom-l.bottom)/f)}function ks(o){return(o.boost||0)*100+(o.apply?10:0)+(o.info?5:0)+(o.type?1:0)}function Wi(o,i){let l=[],h=null,f=B=>{l.push(B);let{section:J}=B.completion;if(J){h||(h=[]);let Y=typeof J=="string"?J:J.name;h.some(ge=>ge.name==Y)||h.push(typeof J=="string"?{name:Y}:J)}};for(let B of o)if(B.hasResult()){let J=B.result.getMatch;if(B.result.filter===!1)for(let Y of B.result.options)f(new Nn(Y,B.source,J?J(Y):[],1e9-l.length));else{let Y=new zs(i.sliceDoc(B.from,B.to));for(let ge of B.result.options)if(Y.match(ge.label)){let Ie=ge.displayLabel?J?J(ge,Y.matched):[]:Y.matched;f(new Nn(ge,B.source,Ie,Y.score+(ge.boost||0)))}}}if(h){let B=Object.create(null),J=0,Y=(ge,Ie)=>{var ct,Qt;return((ct=ge.rank)!==null&&ct!==void 0?ct:1e9)-((Qt=Ie.rank)!==null&&Qt!==void 0?Qt:1e9)||(ge.name<Ie.name?-1:1)};for(let ge of h.sort(Y))J-=1e5,B[ge.name]=J;for(let ge of l){let{section:Ie}=ge.completion;Ie&&(ge.score+=B[typeof Ie=="string"?Ie:Ie.name])}}let m=[],k=null,T=i.facet(wi).compareCompletions;for(let B of l.sort((J,Y)=>Y.score-J.score||T(J.completion,Y.completion))){let J=B.completion;!k||k.label!=J.label||k.detail!=J.detail||k.type!=null&&J.type!=null&&k.type!=J.type||k.apply!=J.apply||k.boost!=J.boost?m.push(B):ks(B.completion)>ks(k)&&(m[m.length-1]=B),k=B.completion}return m}class Oe{constructor(i,l,h,f,m,k){this.options=i,this.attrs=l,this.tooltip=h,this.timestamp=f,this.selected=m,this.disabled=k}setSelected(i,l){return i==this.selected||i>=this.options.length?this:new Oe(this.options,Wr(l,i),this.tooltip,this.timestamp,i,this.disabled)}static build(i,l,h,f,m){let k=Wi(i,l);if(!k.length)return f&&i.some(B=>B.state==1)?new Oe(f.options,f.attrs,f.tooltip,f.timestamp,f.selected,!0):null;let T=l.facet(wi).selectOnOpen?0:-1;if(f&&f.selected!=T&&f.selected!=-1){let B=f.options[f.selected].completion;for(let J=0;J<k.length;J++)if(k[J].completion==B){T=J;break}}return new Oe(k,Wr(h,T),{pos:i.reduce((B,J)=>J.hasResult()?Math.min(B,J.from):B,1e8),create:ds,above:m.aboveCursor},f?f.timestamp:Date.now(),T,!1)}map(i){return new Oe(this.options,this.attrs,Object.assign(Object.assign({},this.tooltip),{pos:i.mapPos(this.tooltip.pos)}),this.timestamp,this.selected,this.disabled)}}class ni{constructor(i,l,h){this.active=i,this.id=l,this.open=h}static start(){return new ni(es,"cm-ac-"+Math.floor(Math.random()*2e6).toString(36),null)}update(i){let{state:l}=i,h=l.facet(wi),m=(h.override||l.languageDataAt("autocomplete",dn(l)).map(qn)).map(T=>(this.active.find(J=>J.source==T)||new nn(T,this.active.some(J=>J.state!=0)?1:0)).update(i,h));m.length==this.active.length&&m.every((T,B)=>T==this.active[B])&&(m=this.active);let k=this.open;k&&i.docChanged&&(k=k.map(i.changes)),i.selection||m.some(T=>T.hasResult()&&i.changes.touchesRange(T.from,T.to))||!_n(m,this.active)?k=Oe.build(m,l,this.id,k,h):k&&k.disabled&&!m.some(T=>T.state==1)&&(k=null),!k&&m.every(T=>T.state!=1)&&m.some(T=>T.hasResult())&&(m=m.map(T=>T.hasResult()?new nn(T.source,0):T));for(let T of i.effects)T.is(Zs)&&(k=k&&k.setSelected(T.value,this.id));return m==this.active&&k==this.open?this:new ni(m,this.id,k)}get tooltip(){return this.open?this.open.tooltip:null}get attrs(){return this.open?this.open.attrs:fs}}function _n(o,i){if(o==i)return!0;for(let l=0,h=0;;){for(;l<o.length&&!o[l].hasResult;)l++;for(;h<i.length&&!i[h].hasResult;)h++;let f=l==o.length,m=h==i.length;if(f||m)return f==m;if(o[l++].result!=i[h++].result)return!1}}const fs={"aria-autocomplete":"list"};function Wr(o,i){let l={"aria-autocomplete":"list","aria-haspopup":"listbox","aria-controls":o};return i>-1&&(l["aria-activedescendant"]=o+"-"+i),l}const es=[];function $s(o){return o.isUserEvent("input.type")?"input":o.isUserEvent("delete.backward")?"delete":null}class nn{constructor(i,l,h=-1){this.source=i,this.state=l,this.explicitPos=h}hasResult(){return!1}update(i,l){let h=$s(i),f=this;h?f=f.handleUserEvent(i,h,l):i.docChanged?f=f.handleChange(i):i.selection&&f.state!=0&&(f=new nn(f.source,0));for(let m of i.effects)if(m.is(Qn))f=new nn(f.source,1,m.value?dn(i.state):-1);else if(m.is(Hn))f=new nn(f.source,0);else if(m.is(or))for(let k of m.value)k.source==f.source&&(f=k);return f}handleUserEvent(i,l,h){return l=="delete"||!h.activateOnTyping?this.map(i.changes):new nn(this.source,1)}handleChange(i){return i.changes.touchesRange(dn(i.startState))?new nn(this.source,0):this.map(i.changes)}map(i){return i.empty||this.explicitPos<0?this:new nn(this.source,this.state,i.mapPos(this.explicitPos))}}class us extends nn{constructor(i,l,h,f,m){super(i,2,l),this.result=h,this.from=f,this.to=m}hasResult(){return!0}handleUserEvent(i,l,h){var f;let m=i.changes.mapPos(this.from),k=i.changes.mapPos(this.to,1),T=dn(i.state);if((this.explicitPos<0?T<=m:T<this.from)||T>k||l=="delete"&&dn(i.startState)==this.from)return new nn(this.source,l=="input"&&h.activateOnTyping?1:0);let B=this.explicitPos<0?-1:i.changes.mapPos(this.explicitPos),J;return js(this.result.validFor,i.state,m,k)?new us(this.source,B,this.result,m,k):this.result.update&&(J=this.result.update(this.result,m,k,new ls(i.state,T,B>=0)))?new us(this.source,B,J,J.from,(f=J.to)!==null&&f!==void 0?f:dn(i.state)):new nn(this.source,1,B)}handleChange(i){return i.changes.touchesRange(this.from,this.to)?new nn(this.source,0):this.map(i.changes)}map(i){return i.empty?this:new us(this.source,this.explicitPos<0?-1:i.mapPos(this.explicitPos),this.result,i.mapPos(this.from),i.mapPos(this.to,1))}}function js(o,i,l,h){if(!o)return!1;let f=i.sliceDoc(l,h);return typeof o=="function"?o(f,l,h,i):Ss(o,!0).test(f)}const or=L.Py.define({map(o,i){return o.map(l=>l.map(i))}}),Zs=L.Py.define(),Hi=L.QQ.define({create(){return ni.start()},update(o,i){return o.update(i)},provide:o=>[G.hJ.from(o,i=>i.tooltip),G.tk.contentAttributes.from(o,i=>i.attrs)]});function Hr(o,i){const l=i.completion.apply||i.completion.label;let h=o.state.field(Hi).active.find(f=>f.source==i.source);return h instanceof us?(typeof l=="string"?o.dispatch(Object.assign(Object.assign({},Wn(o.state,l,h.from,h.to)),{annotations:Fn.of(i.completion)})):l(o,i.completion,h.from,h.to),!0):!1}const ds=rr(Hi,Hr);function Ke(o,i="option"){return l=>{let h=l.state.field(Hi,!1);if(!h||!h.open||h.open.disabled||Date.now()-h.open.timestamp<l.state.facet(wi).interactionDelay)return!1;let f=1,m;i=="page"&&(m=(0,G.gB)(l,h.open.tooltip))&&(f=Math.max(2,Math.floor(m.dom.offsetHeight/m.dom.querySelector("li").offsetHeight)-1));let{length:k}=h.open.options,T=h.open.selected>-1?h.open.selected+f*(o?1:-1):o?0:k-1;return T<0?T=i=="page"?0:k-1:T>=k&&(T=i=="page"?k-1:0),l.dispatch({effects:Zs.of(T)}),!0}}const Te=o=>{let i=o.state.field(Hi,!1);return o.state.readOnly||!i||!i.open||i.open.selected<0||i.open.disabled||Date.now()-i.open.timestamp<o.state.facet(wi).interactionDelay?!1:Hr(o,i.open.options[i.open.selected])},Ce=o=>o.state.field(Hi,!1)?(o.dispatch({effects:Qn.of(!0)}),!0):!1,We=o=>{let i=o.state.field(Hi,!1);return!i||!i.active.some(l=>l.state!=0)?!1:(o.dispatch({effects:Hn.of(null)}),!0)};class At{constructor(i,l){this.active=i,this.context=l,this.time=Date.now(),this.updates=[],this.done=void 0}}const It=50,ci=1e3,Si=G.lg.fromClass(class{constructor(o){this.view=o,this.debounceUpdate=-1,this.running=[],this.debounceAccept=-1,this.composing=0;for(let i of o.state.field(Hi).active)i.state==1&&this.startQuery(i)}update(o){let i=o.state.field(Hi);if(!o.selectionSet&&!o.docChanged&&o.startState.field(Hi)==i)return;let l=o.transactions.some(h=>(h.selection||h.docChanged)&&!$s(h));for(let h=0;h<this.running.length;h++){let f=this.running[h];if(l||f.updates.length+o.transactions.length>It&&Date.now()-f.time>ci){for(let m of f.context.abortListeners)try{m()}catch(k){(0,G.OO)(this.view.state,k)}f.context.abortListeners=null,this.running.splice(h--,1)}else f.updates.push(...o.transactions)}if(this.debounceUpdate>-1&&clearTimeout(this.debounceUpdate),this.debounceUpdate=i.active.some(h=>h.state==1&&!this.running.some(f=>f.active.source==h.source))?setTimeout(()=>this.startUpdate(),50):-1,this.composing!=0)for(let h of o.transactions)$s(h)=="input"?this.composing=2:this.composing==2&&h.selection&&(this.composing=3)}startUpdate(){this.debounceUpdate=-1;let{state:o}=this.view,i=o.field(Hi);for(let l of i.active)l.state==1&&!this.running.some(h=>h.active.source==l.source)&&this.startQuery(l)}startQuery(o){let{state:i}=this.view,l=dn(i),h=new ls(i,l,o.explicitPos==l),f=new At(o,h);this.running.push(f),Promise.resolve(o.source(h)).then(m=>{f.context.aborted||(f.done=m||null,this.scheduleAccept())},m=>{this.view.dispatch({effects:Hn.of(null)}),(0,G.OO)(this.view.state,m)})}scheduleAccept(){this.running.every(o=>o.done!==void 0)?this.accept():this.debounceAccept<0&&(this.debounceAccept=setTimeout(()=>this.accept(),this.view.state.facet(wi).updateSyncTime))}accept(){var o;this.debounceAccept>-1&&clearTimeout(this.debounceAccept),this.debounceAccept=-1;let i=[],l=this.view.state.facet(wi);for(let h=0;h<this.running.length;h++){let f=this.running[h];if(f.done===void 0)continue;if(this.running.splice(h--,1),f.done){let k=new us(f.active.source,f.active.explicitPos,f.done,f.done.from,(o=f.done.to)!==null&&o!==void 0?o:dn(f.updates.length?f.updates[0].startState:this.view.state));for(let T of f.updates)k=k.update(T,l);if(k.hasResult()){i.push(k);continue}}let m=this.view.state.field(Hi).active.find(k=>k.source==f.active.source);if(m&&m.state==1)if(f.done==null){let k=new nn(f.active.source,0);for(let T of f.updates)k=k.update(T,l);k.state!=1&&i.push(k)}else this.startQuery(m)}i.length&&this.view.dispatch({effects:or.of(i)})}},{eventHandlers:{blur(o){let i=this.view.state.field(Hi,!1);if(i&&i.tooltip&&this.view.state.facet(wi).closeOnBlur){let l=i.open&&(0,G.gB)(this.view,i.open.tooltip);(!l||!l.dom.contains(o.relatedTarget))&&this.view.dispatch({effects:Hn.of(null)})}},compositionstart(){this.composing=1},compositionend(){this.composing==3&&setTimeout(()=>this.view.dispatch({effects:Qn.of(!1)}),20),this.composing=0}}}),pn=G.tk.baseTheme({".cm-tooltip.cm-tooltip-autocomplete":{"& > ul":{fontFamily:"monospace",whiteSpace:"nowrap",overflow:"hidden auto",maxWidth_fallback:"700px",maxWidth:"min(700px, 95vw)",minWidth:"250px",maxHeight:"10em",height:"100%",listStyle:"none",margin:0,padding:0,"& > li, & > completion-section":{padding:"1px 3px",lineHeight:1.2},"& > li":{overflowX:"hidden",textOverflow:"ellipsis",cursor:"pointer"},"& > completion-section":{display:"list-item",borderBottom:"1px solid silver",paddingLeft:"0.5em",opacity:.7}}},"&light .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#17c",color:"white"},"&light .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#777"},"&dark .cm-tooltip-autocomplete ul li[aria-selected]":{background:"#347",color:"white"},"&dark .cm-tooltip-autocomplete-disabled ul li[aria-selected]":{background:"#444"},".cm-completionListIncompleteTop:before, .cm-completionListIncompleteBottom:after":{content:'"\xB7\xB7\xB7"',opacity:.5,display:"block",textAlign:"center"},".cm-tooltip.cm-completionInfo":{position:"absolute",padding:"3px 9px",width:"max-content",maxWidth:`${400}px`,boxSizing:"border-box"},".cm-completionInfo.cm-completionInfo-left":{right:"100%"},".cm-completionInfo.cm-completionInfo-right":{left:"100%"},".cm-completionInfo.cm-completionInfo-left-narrow":{right:`${30}px`},".cm-completionInfo.cm-completionInfo-right-narrow":{left:`${30}px`},"&light .cm-snippetField":{backgroundColor:"#00000022"},"&dark .cm-snippetField":{backgroundColor:"#ffffff22"},".cm-snippetFieldPosition":{verticalAlign:"text-top",width:0,height:"1.15em",display:"inline-block",margin:"0 -0.7px -.7em",borderLeft:"1.4px dotted #888"},".cm-completionMatchedText":{textDecoration:"underline"},".cm-completionDetail":{marginLeft:"0.5em",fontStyle:"italic"},".cm-completionIcon":{fontSize:"90%",width:".8em",display:"inline-block",textAlign:"center",paddingRight:".6em",opacity:"0.6",boxSizing:"content-box"},".cm-completionIcon-function, .cm-completionIcon-method":{"&:after":{content:"'\u0192'"}},".cm-completionIcon-class":{"&:after":{content:"'\u25CB'"}},".cm-completionIcon-interface":{"&:after":{content:"'\u25CC'"}},".cm-completionIcon-variable":{"&:after":{content:"'\u{1D465}'"}},".cm-completionIcon-constant":{"&:after":{content:"'\u{1D436}'"}},".cm-completionIcon-type":{"&:after":{content:"'\u{1D461}'"}},".cm-completionIcon-enum":{"&:after":{content:"'\u222A'"}},".cm-completionIcon-property":{"&:after":{content:"'\u25A1'"}},".cm-completionIcon-keyword":{"&:after":{content:"'\u{1F511}\uFE0E'"}},".cm-completionIcon-namespace":{"&:after":{content:"'\u25A2'"}},".cm-completionIcon-text":{"&:after":{content:"'abc'",fontSize:"50%",verticalAlign:"middle"}}});class gr{constructor(i,l,h,f){this.field=i,this.line=l,this.from=h,this.to=f}}class Cs{constructor(i,l,h){this.field=i,this.from=l,this.to=h}map(i){let l=i.mapPos(this.from,-1,MapMode.TrackDel),h=i.mapPos(this.to,1,MapMode.TrackDel);return l==null||h==null?null:new Cs(this.field,l,h)}}class yr{constructor(i,l){this.lines=i,this.fieldPositions=l}instantiate(i,l){let h=[],f=[l],m=i.doc.lineAt(l),k=/^\s*/.exec(m.text)[0];for(let B of this.lines){if(h.length){let J=k,Y=/^\t*/.exec(B)[0].length;for(let ge=0;ge<Y;ge++)J+=i.facet(indentUnit);f.push(l+J.length-Y),B=J+B.slice(Y)}h.push(B),l+=B.length+1}let T=this.fieldPositions.map(B=>new Cs(B.field,f[B.line]+B.from,f[B.line]+B.to));return{text:h,ranges:T}}static parse(i){let l=[],h=[],f=[],m;for(let k of i.split(/\r\n?|\n/)){for(;m=/[#$]\{(?:(\d+)(?::([^}]*))?|([^}]*))\}/.exec(k);){let T=m[1]?+m[1]:null,B=m[2]||m[3]||"",J=-1;for(let Y=0;Y<l.length;Y++)(T!=null?l[Y].seq==T:B&&l[Y].name==B)&&(J=Y);if(J<0){let Y=0;for(;Y<l.length&&(T==null||l[Y].seq!=null&&l[Y].seq<T);)Y++;l.splice(Y,0,{seq:T,name:B}),J=Y;for(let ge of f)ge.field>=J&&ge.field++}f.push(new gr(J,h.length,m.index,m.index+B.length)),k=k.slice(0,m.index)+B+k.slice(m.index+m[0].length)}for(let T;T=/\\([{}])/.exec(k);){k=k.slice(0,T.index)+T[1]+k.slice(T.index+T[0].length);for(let B of f)B.line==h.length&&B.from>T.index&&(B.from--,B.to--)}h.push(k)}return new yr(h,f)}}let So=G.p.widget({widget:new class extends G.l9{toDOM(){let o=document.createElement("span");return o.className="cm-snippetFieldPosition",o}ignoreEvent(){return!1}}}),vr=G.p.mark({class:"cm-snippetField"});class lr{constructor(i,l){this.ranges=i,this.active=l,this.deco=G.p.set(i.map(h=>(h.from==h.to?So:vr).range(h.from,h.to)))}map(i){let l=[];for(let h of this.ranges){let f=h.map(i);if(!f)return null;l.push(f)}return new lr(l,this.active)}selectionInsideField(i){return i.ranges.every(l=>this.ranges.some(h=>h.field==this.active&&h.from<=l.from&&h.to>=l.to))}}const br=L.Py.define({map(o,i){return o&&o.map(i)}}),ko=L.Py.define(),Ks=L.QQ.define({create(){return null},update(o,i){for(let l of i.effects){if(l.is(br))return l.value;if(l.is(ko)&&o)return new lr(o.ranges,l.value)}return o&&i.docChanged&&(o=o.map(i.changes)),o&&i.selection&&!o.selectionInsideField(i.selection)&&(o=null),o},provide:o=>G.tk.decorations.from(o,i=>i?i.deco:G.p.none)});function xr(o,i){return L.jT.create(o.filter(l=>l.field==i).map(l=>L.jT.range(l.from,l.to)))}function lo(o){let i=yr.parse(o);return(l,h,f,m)=>{let{text:k,ranges:T}=i.instantiate(l.state,f),B={changes:{from:f,to:m,insert:Text.of(k)},scrollIntoView:!0,annotations:h?Fn.of(h):void 0};if(T.length&&(B.selection=xr(T,0)),T.length>1){let J=new lr(T,0),Y=B.effects=[br.of(J)];l.state.field(Ks,!1)===void 0&&Y.push(StateEffect.appendConfig.of([Ks,Yo,qo,pn]))}l.dispatch(l.state.update(B))}}function Co(o){return({state:i,dispatch:l})=>{let h=i.field(Ks,!1);if(!h||o<0&&h.active==0)return!1;let f=h.active+o,m=o>0&&!h.ranges.some(k=>k.field==f+o);return l(i.update({selection:xr(h.ranges,f),effects:br.of(m?null:new lr(h.ranges,f)),scrollIntoView:!0})),!0}}const Go=({state:o,dispatch:i})=>o.field(Ks,!1)?(i(o.update({effects:br.of(null)})),!0):!1,ao=Co(1),Xo=Co(-1);function ho(o){let i=o.field(Ks,!1);return!!(i&&i.ranges.some(l=>l.field==i.active+1))}function xl(o){let i=o.field(Ks,!1);return!!(i&&i.active>0)}const Ao=[{key:"Tab",run:ao,shift:Xo},{key:"Escape",run:Go}],To=L.r$.define({combine(o){return o.length?o[0]:Ao}}),Yo=L.Wl.highest(G.$f.compute([To],o=>o.facet(To)));function wl(o,i){return Object.assign(Object.assign({},i),{apply:lo(o)})}const qo=G.tk.domEventHandlers({mousedown(o,i){let l=i.state.field(Ks,!1),h;if(!l||(h=i.posAtCoords({x:o.clientX,y:o.clientY}))==null)return!1;let f=l.ranges.find(m=>m.from<=h&&m.to>=h);return!f||f.field==l.active?!1:(i.dispatch({selection:xr(l.ranges,f.field),effects:br.of(l.ranges.some(m=>m.field>f.field)?new lr(l.ranges,f.field):null),scrollIntoView:!0}),!0)}});function Qo(o){let i=o.replace(/[\]\-\\]/g,"\\$&");try{return new RegExp(`[\\p{Alphabetic}\\p{Number}_${i}]+`,"ug")}catch{return new RegExp(`[w${i}]`,"g")}}function co(o,i){return new RegExp(i(o.source),o.unicode?"u":"")}const _o=null;function el(o){return _o[o]||(_o[o]=new WeakMap)}function Mo(o,i,l,h,f){for(let m=o.iterLines(),k=0;!m.next().done;){let{value:T}=m,B;for(i.lastIndex=0;B=i.exec(T);)if(!h[B[0]]&&k+B.index!=f&&(l.push({type:"text",label:B[0]}),h[B[0]]=!0,l.length>=2e3))return;k+=T.length+1}}function Eo(o,i,l,h,f){let m=o.length>=1e3,k=m&&i.get(o);if(k)return k;let T=[],B=Object.create(null);if(o.children){let J=0;for(let Y of o.children){if(Y.length>=1e3)for(let ge of Eo(Y,i,l,h-J,f-J))B[ge.label]||(B[ge.label]=!0,T.push(ge));else Mo(Y,l,T,B,f-J);J+=Y.length+1}}else Mo(o,l,T,B,f);return m&&T.length<2e3&&i.set(o,T),T}const Sl=o=>{let i=o.state.languageDataAt("wordChars",o.pos).join(""),l=Qo(i),h=o.matchBefore(co(l,k=>k+"$"));if(!h&&!o.explicit)return null;let f=h?h.from:o.pos,m=Eo(o.state.doc,el(i),l,5e4,f);return{from:f,options:m,validFor:co(l,k=>"^"+k)}},wr={brackets:["(","[","{","'",'"'],before:")]}:;>",stringPrefixes:[]},ps=L.Py.define({map(o,i){let l=i.mapPos(o,-1,L.gc.TrackAfter);return l==null?void 0:l}}),fo=new class extends L.uU{};fo.startSide=1,fo.endSide=-1;const Do=L.QQ.define({create(){return L.Xs.empty},update(o,i){if(o=o.map(i.changes),i.selection){let l=i.state.doc.lineAt(i.selection.main.head);o=o.update({filter:h=>h>=l.from&&h<=l.to})}for(let l of i.effects)l.is(ps)&&(o=o.update({add:[fo.range(l.value,l.value+1)]}));return o}});function Oo(){return[il,Do]}const uo="()[]{}<>";function Po(o){for(let i=0;i<uo.length;i+=2)if(uo.charCodeAt(i)==o)return uo.charAt(i+1);return(0,L.bg)(o<128?o:o+1)}function Ro(o,i){return o.languageDataAt("closeBrackets",i)[0]||wr}const tl=typeof navigator=="object"&&/Android\b/.test(navigator.userAgent),il=G.tk.inputHandler.of((o,i,l,h)=>{if((tl?o.composing:o.compositionStarted)||o.state.readOnly)return!1;let f=o.state.selection.main;if(h.length>2||h.length==2&&(0,L.nZ)((0,L.gm)(h,0))==1||i!=f.from||l!=f.to)return!1;let m=kl(o.state,h);return m?(o.dispatch(m),!0):!1}),Bo=[{key:"Backspace",run:({state:o,dispatch:i})=>{if(o.readOnly)return!1;let h=Ro(o,o.selection.main.head).brackets||wr.brackets,f=null,m=o.changeByRange(k=>{if(k.empty){let T=Io(o.doc,k.head);for(let B of h)if(B==T&&Js(o.doc,k.head)==Po((0,L.gm)(B,0)))return{changes:{from:k.head-B.length,to:k.head+B.length},range:L.jT.cursor(k.head-B.length)}}return{range:f=k}});return f||i(o.update(m,{scrollIntoView:!0,userEvent:"delete.backward"})),!f}}];function kl(o,i){let l=Ro(o,o.selection.main.head),h=l.brackets||wr.brackets;for(let f of h){let m=Po((0,L.gm)(f,0));if(i==f)return m==f?sl(o,f,h.indexOf(f+f+f)>-1,l):zr(o,f,m,l.before||wr.before);if(i==m&&Lo(o,o.selection.main.from))return nl(o,f,m)}return null}function Lo(o,i){let l=!1;return o.field(Do).between(0,o.doc.length,h=>{h==i&&(l=!0)}),l}function Js(o,i){let l=o.sliceString(i,i+2);return l.slice(0,(0,L.nZ)((0,L.gm)(l,0)))}function Io(o,i){let l=o.sliceString(i-2,i);return(0,L.nZ)((0,L.gm)(l,0))==l.length?l:l.slice(1)}function zr(o,i,l,h){let f=null,m=o.changeByRange(k=>{if(!k.empty)return{changes:[{insert:i,from:k.from},{insert:l,from:k.to}],effects:ps.of(k.to+i.length),range:L.jT.range(k.anchor+i.length,k.head+i.length)};let T=Js(o.doc,k.head);return!T||/\s/.test(T)||h.indexOf(T)>-1?{changes:{insert:i+l,from:k.head},effects:ps.of(k.head+i.length),range:L.jT.cursor(k.head+i.length)}:{range:f=k}});return f?null:o.update(m,{scrollIntoView:!0,userEvent:"input.type"})}function nl(o,i,l){let h=null,f=o.changeByRange(m=>m.empty&&Js(o.doc,m.head)==l?{changes:{from:m.head,to:m.head+l.length,insert:l},range:L.jT.cursor(m.head+l.length)}:h={range:m});return h?null:o.update(f,{scrollIntoView:!0,userEvent:"input.type"})}function sl(o,i,l,h){let f=h.stringPrefixes||wr.stringPrefixes,m=null,k=o.changeByRange(T=>{if(!T.empty)return{changes:[{insert:i,from:T.from},{insert:i,from:T.to}],effects:ps.of(T.to+i.length),range:L.jT.range(T.anchor+i.length,T.head+i.length)};let B=T.head,J=Js(o.doc,B),Y;if(J==i){if($r(o,B))return{changes:{insert:i+i,from:B},effects:ps.of(B+i.length),range:L.jT.cursor(B+i.length)};if(Lo(o,B)){let Ie=l&&o.sliceDoc(B,B+i.length*3)==i+i+i?i+i+i:i;return{changes:{from:B,to:B+Ie.length,insert:Ie},range:L.jT.cursor(B+Ie.length)}}}else{if(l&&o.sliceDoc(B-2*i.length,B)==i+i&&(Y=kr(o,B-2*i.length,f))>-1&&$r(o,Y))return{changes:{insert:i+i+i+i,from:B},effects:ps.of(B+i.length),range:L.jT.cursor(B+i.length)};if(o.charCategorizer(B)(J)!=L.D0.Word&&kr(o,B,f)>-1&&!Sr(o,B,i,f))return{changes:{insert:i+i,from:B},effects:ps.of(B+i.length),range:L.jT.cursor(B+i.length)}}return{range:m=T}});return m?null:o.update(k,{scrollIntoView:!0,userEvent:"input.type"})}function $r(o,i){let l=(0,Se.qz)(o).resolveInner(i+1);return l.parent&&l.from==i}function Sr(o,i,l,h){let f=(0,Se.qz)(o).resolveInner(i,-1),m=h.reduce((k,T)=>Math.max(k,T.length),0);for(let k=0;k<5;k++){let T=o.sliceDoc(f.from,Math.min(f.to,f.from+l.length+m)),B=T.indexOf(l);if(!B||B>-1&&h.indexOf(T.slice(0,B))>-1){let Y=f.firstChild;for(;Y&&Y.from==f.from&&Y.to-Y.from>l.length+B;){if(o.sliceDoc(Y.to-l.length,Y.to)==l)return!1;Y=Y.firstChild}return!0}let J=f.to==i&&f.parent;if(!J)break;f=J}return!1}function kr(o,i,l){let h=o.charCategorizer(i);if(h(o.sliceDoc(i-1,i))!=L.D0.Word)return i;for(let f of l){let m=i-f.length;if(o.sliceDoc(m,i)==f&&h(o.sliceDoc(m-1,m))!=L.D0.Word)return m}return-1}function rl(o={}){return[Hi,wi.of(o),Si,jr,pn]}const No=[{key:"Ctrl-Space",run:Ce},{key:"Escape",run:We},{key:"ArrowDown",run:Ke(!0)},{key:"ArrowUp",run:Ke(!1)},{key:"PageDown",run:Ke(!0,"page")},{key:"PageUp",run:Ke(!1,"page")},{key:"Enter",run:Te}],jr=L.Wl.highest(G.$f.computeN([wi],o=>o.facet(wi).defaultKeymap?[No]:[]));function Cl(o){let i=o.field(Hi,!1);return i&&i.active.some(l=>l.state==1)?"pending":i&&i.active.some(l=>l.state!=0)?"active":null}const Fo=new WeakMap;function Al(o){var i;let l=(i=o.field(Hi,!1))===null||i===void 0?void 0:i.open;if(!l||l.disabled)return[];let h=Fo.get(l.options);return h||Fo.set(l.options,h=l.options.map(f=>f.completion)),h}function Tl(o){var i;let l=(i=o.field(Hi,!1))===null||i===void 0?void 0:i.open;return l&&!l.disabled&&l.selected>=0?l.options[l.selected].completion:null}function Pl(o){var i;let l=(i=o.field(Hi,!1))===null||i===void 0?void 0:i.open;return l&&!l.disabled&&l.selected>=0?l.selected:null}function Ml(o){return Zs.of(o)}class El{constructor(i,l,h){this.from=i,this.to=l,this.diagnostic=h}}class ar{constructor(i,l,h){this.diagnostics=i,this.panel=l,this.selected=h}static init(i,l,h){let f=i,m=h.facet(Jr).markerFilter;m&&(f=m(f));let k=G.p.set(f.map(T=>T.from==T.to||T.from==T.to-1&&h.doc.lineAt(T.from).to==T.from?G.p.widget({widget:new vo(T),diagnostic:T}).range(T.from):G.p.mark({attributes:{class:"cm-lintRange cm-lintRange-"+T.severity+(T.markClass?" "+T.markClass:"")},diagnostic:T}).range(T.from,T.to)),!0);return new ar(k,l,As(k))}}function As(o,i=null,l=0){let h=null;return o.between(l,1e9,(f,m,{spec:k})=>{if(!(i&&k.diagnostic!=i))return h=new El(f,m,k.diagnostic),!1}),h}function ol(o,i){let l=o.startState.doc.lineAt(i.pos);return!!(o.effects.some(h=>h.is(Us))||o.changes.touchesRange(l.from,l.to))}function Wo(o,i){return o.field(ki,!1)?i:i.concat(L.Py.appendConfig.of(r))}function ll(o,i){return{effects:Wo(o,[Us.of(i)])}}const Us=L.Py.define(),Zr=L.Py.define(),Kr=L.Py.define(),ki=L.QQ.define({create(){return new ar(G.p.none,null,null)},update(o,i){if(i.docChanged){let l=o.diagnostics.map(i.changes),h=null;if(o.selected){let f=i.changes.mapPos(o.selected.from,1);h=As(l,o.selected.diagnostic,f)||As(l,null,f)}o=new ar(l,o.panel,h)}for(let l of i.effects)l.is(Us)?o=ar.init(l.value,o.panel,i.state):l.is(Zr)?o=new ar(o.diagnostics,l.value?Gr.open:null,o.selected):l.is(Kr)&&(o=new ar(o.diagnostics,o.panel,l.value));return o},provide:o=>[G.mH.from(o,i=>i.panel),G.tk.decorations.from(o,i=>i.diagnostics)]});function po(o){let i=o.field(ki,!1);return i?i.diagnostics.size:0}const al=G.p.mark({class:"cm-lintRange cm-lintRange-active"});function Cr(o,i,l){let{diagnostics:h}=o.state.field(ki),f=[],m=2e8,k=0;h.between(i-(l<0?1:0),i+(l>0?1:0),(B,J,{spec:Y})=>{i>=B&&i<=J&&(B==J||(i>B||l>0)&&(i<J||l<0))&&(f.push(Y.diagnostic),m=Math.min(B,m),k=Math.max(J,k))});let T=o.state.facet(Jr).tooltipFilter;return T&&(f=T(f)),f.length?{pos:m,end:k,above:o.state.doc.lineAt(m).to<k,create(){return{dom:Ho(o,f)}}}:null}function Ho(o,i){return ii("ul",{class:"cm-tooltip-lint"},i.map(l=>Gs(o,l,!1)))}const mo=o=>{let i=o.state.field(ki,!1);(!i||!i.panel)&&o.dispatch({effects:Wo(o.state,[Zr.of(!0)])});let l=(0,G.Sd)(o,Gr.open);return l&&l.dom.querySelector(".cm-panel-lint ul").focus(),!0},go=o=>{let i=o.state.field(ki,!1);return!i||!i.panel?!1:(o.dispatch({effects:Zr.of(!1)}),!0)},hl=o=>{let i=o.state.field(ki,!1);if(!i)return!1;let l=o.state.selection.main,h=i.diagnostics.iter(l.to+1);return!h.value&&(h=i.diagnostics.iter(0),!h.value||h.from==l.from&&h.to==l.to)?!1:(o.dispatch({selection:{anchor:h.from,head:h.to},scrollIntoView:!0}),!0)},cl=o=>{let{state:i}=o,l=i.field(ki,!1);if(!l)return!1;let h=i.selection.main,f,m,k,T;return l.diagnostics.between(0,i.doc.length,(B,J)=>{J<h.to&&(f==null||f<B)&&(f=B,m=J),(k==null||B>k)&&(k=B,T=J)}),k==null||f==null&&k==h.from?!1:(o.dispatch({selection:{anchor:f!=null?f:k,head:m!=null?m:T},scrollIntoView:!0}),!0)},yo=[{key:"Mod-Shift-m",run:mo,preventDefault:!0},{key:"F8",run:hl}],Vo=null,Jr=L.r$.define({combine(o){return Object.assign({sources:o.map(i=>i.source)},(0,L.BO)(o.map(i=>i.config),{delay:750,markerFilter:null,tooltipFilter:null,needsRefresh:null},{needsRefresh:(i,l)=>i?l?h=>i(h)||l(h):i:l}))}});function fl(o,i={}){return[Jr.of({source:o,config:i}),Vo,r]}function Dl(o){let i=o.plugin(Vo);i&&i.force()}function zo(o){let i=[];if(o)e:for(let{name:l}of o){for(let h=0;h<l.length;h++){let f=l[h];if(/[a-zA-Z]/.test(f)&&!i.some(m=>m.toLowerCase()==f.toLowerCase())){i.push(f);continue e}}i.push("")}return i}function Gs(o,i,l){var h;let f=l?zo(i.actions):[];return ii("li",{class:"cm-diagnostic cm-diagnostic-"+i.severity},ii("span",{class:"cm-diagnosticText"},i.renderMessage?i.renderMessage():i.message),(h=i.actions)===null||h===void 0?void 0:h.map((m,k)=>{let T=!1,B=Ie=>{if(Ie.preventDefault(),T)return;T=!0;let ct=As(o.state.field(ki).diagnostics,i);ct&&m.apply(o,ct.from,ct.to)},{name:J}=m,Y=f[k]?J.indexOf(f[k]):-1,ge=Y<0?J:[J.slice(0,Y),ii("u",J.slice(Y,Y+1)),J.slice(Y+1)];return ii("button",{type:"button",class:"cm-diagnosticAction",onclick:B,onmousedown:B,"aria-label":` Action: ${J}${Y<0?"":` (access key "${f[k]})"`}.`},ge)}),i.source&&ii("div",{class:"cm-diagnosticSource"},i.source))}class vo extends G.l9{constructor(i){super(),this.diagnostic=i}eq(i){return i.diagnostic==this.diagnostic}toDOM(){return ii("span",{class:"cm-lintPoint cm-lintPoint-"+this.diagnostic.severity})}}class Ur{constructor(i,l){this.diagnostic=l,this.id="item_"+Math.floor(Math.random()*4294967295).toString(16),this.dom=Gs(i,l,!0),this.dom.id=this.id,this.dom.setAttribute("role","option")}}class Gr{constructor(i){this.view=i,this.items=[];let l=f=>{if(f.keyCode==27)go(this.view),this.view.focus();else if(f.keyCode==38||f.keyCode==33)this.moveSelection((this.selectedIndex-1+this.items.length)%this.items.length);else if(f.keyCode==40||f.keyCode==34)this.moveSelection((this.selectedIndex+1)%this.items.length);else if(f.keyCode==36)this.moveSelection(0);else if(f.keyCode==35)this.moveSelection(this.items.length-1);else if(f.keyCode==13)this.view.focus();else if(f.keyCode>=65&&f.keyCode<=90&&this.selectedIndex>=0){let{diagnostic:m}=this.items[this.selectedIndex],k=zo(m.actions);for(let T=0;T<k.length;T++)if(k[T].toUpperCase().charCodeAt(0)==f.keyCode){let B=As(this.view.state.field(ki).diagnostics,m);B&&m.actions[T].apply(i,B.from,B.to)}}else return;f.preventDefault()},h=f=>{for(let m=0;m<this.items.length;m++)this.items[m].dom.contains(f.target)&&this.moveSelection(m)};this.list=ii("ul",{tabIndex:0,role:"listbox","aria-label":this.view.state.phrase("Diagnostics"),onkeydown:l,onclick:h}),this.dom=ii("div",{class:"cm-panel-lint"},this.list,ii("button",{type:"button",name:"close","aria-label":this.view.state.phrase("close"),onclick:()=>go(this.view)},"\xD7")),this.update()}get selectedIndex(){let i=this.view.state.field(ki).selected;if(!i)return-1;for(let l=0;l<this.items.length;l++)if(this.items[l].diagnostic==i.diagnostic)return l;return-1}update(){let{diagnostics:i,selected:l}=this.view.state.field(ki),h=0,f=!1,m=null;for(i.between(0,this.view.state.doc.length,(k,T,{spec:B})=>{let J=-1,Y;for(let ge=h;ge<this.items.length;ge++)if(this.items[ge].diagnostic==B.diagnostic){J=ge;break}J<0?(Y=new Ur(this.view,B.diagnostic),this.items.splice(h,0,Y),f=!0):(Y=this.items[J],J>h&&(this.items.splice(h,J-h),f=!0)),l&&Y.diagnostic==l.diagnostic?Y.dom.hasAttribute("aria-selected")||(Y.dom.setAttribute("aria-selected","true"),m=Y):Y.dom.hasAttribute("aria-selected")&&Y.dom.removeAttribute("aria-selected"),h++});h<this.items.length&&!(this.items.length==1&&this.items[0].diagnostic.from<0);)f=!0,this.items.pop();this.items.length==0&&(this.items.push(new Ur(this.view,{from:-1,to:-1,severity:"info",message:this.view.state.phrase("No diagnostics")})),f=!0),m?(this.list.setAttribute("aria-activedescendant",m.id),this.view.requestMeasure({key:this,read:()=>({sel:m.dom.getBoundingClientRect(),panel:this.list.getBoundingClientRect()}),write:({sel:k,panel:T})=>{let B=T.height/this.list.offsetHeight;k.top<T.top?this.list.scrollTop-=(T.top-k.top)/B:k.bottom>T.bottom&&(this.list.scrollTop+=(k.bottom-T.bottom)/B)}})):this.selectedIndex<0&&this.list.removeAttribute("aria-activedescendant"),f&&this.sync()}sync(){let i=this.list.firstChild;function l(){let h=i;i=h.nextSibling,h.remove()}for(let h of this.items)if(h.dom.parentNode==this.list){for(;i!=h.dom;)l();i=h.dom.nextSibling}else this.list.insertBefore(h.dom,i);for(;i;)l()}moveSelection(i){if(this.selectedIndex<0)return;let l=this.view.state.field(ki),h=As(l.diagnostics,this.items[i].diagnostic);h&&this.view.dispatch({selection:{anchor:h.from,head:h.to},scrollIntoView:!0,effects:Kr.of(h)})}static open(i){return new Gr(i)}}function Xr(o,i='viewBox="0 0 40 40"'){return`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" ${i}>${encodeURIComponent(o)}</svg>')`}function Ar(o){return Xr(`<path d="m0 2.5 l2 -1.5 l1 0 l2 1.5 l1 0" stroke="${o}" fill="none" stroke-width=".7"/>`,'width="6" height="3"')}const ul=G.tk.baseTheme({".cm-diagnostic":{padding:"3px 6px 3px 8px",marginLeft:"-1px",display:"block",whiteSpace:"pre-wrap"},".cm-diagnostic-error":{borderLeft:"5px solid #d11"},".cm-diagnostic-warning":{borderLeft:"5px solid orange"},".cm-diagnostic-info":{borderLeft:"5px solid #999"},".cm-diagnostic-hint":{borderLeft:"5px solid #66d"},".cm-diagnosticAction":{font:"inherit",border:"none",padding:"2px 4px",backgroundColor:"#444",color:"white",borderRadius:"3px",marginLeft:"8px",cursor:"pointer"},".cm-diagnosticSource":{fontSize:"70%",opacity:.7},".cm-lintRange":{backgroundPosition:"left bottom",backgroundRepeat:"repeat-x",paddingBottom:"0.7px"},".cm-lintRange-error":{backgroundImage:Ar("#d11")},".cm-lintRange-warning":{backgroundImage:Ar("orange")},".cm-lintRange-info":{backgroundImage:Ar("#999")},".cm-lintRange-hint":{backgroundImage:Ar("#66d")},".cm-lintRange-active":{backgroundColor:"#ffdd9980"},".cm-tooltip-lint":{padding:0,margin:0},".cm-lintPoint":{position:"relative","&:after":{content:'""',position:"absolute",bottom:0,left:"-2px",borderLeft:"3px solid transparent",borderRight:"3px solid transparent",borderBottom:"4px solid #d11"}},".cm-lintPoint-warning":{"&:after":{borderBottomColor:"orange"}},".cm-lintPoint-info":{"&:after":{borderBottomColor:"#999"}},".cm-lintPoint-hint":{"&:after":{borderBottomColor:"#66d"}},".cm-panel.cm-panel-lint":{position:"relative","& ul":{maxHeight:"100px",overflowY:"auto","& [aria-selected]":{backgroundColor:"#ddd","& u":{textDecoration:"underline"}},"&:focus [aria-selected]":{background_fallback:"#bdf",backgroundColor:"Highlight",color_fallback:"white",color:"HighlightText"},"& u":{textDecoration:"none"},padding:0,margin:0},"& [name=close]":{position:"absolute",top:"0",right:"2px",background:"inherit",border:"none",font:"inherit",padding:0,margin:0}}});function $o(o){return o=="error"?4:o=="warning"?3:o=="info"?2:1}class dl extends G.SJ{constructor(i){super(),this.diagnostics=i,this.severity=i.reduce((l,h)=>$o(l)<$o(h.severity)?h.severity:l,"hint")}toDOM(i){let l=document.createElement("div");l.className="cm-lint-marker cm-lint-marker-"+this.severity;let h=this.diagnostics,f=i.state.facet(e).tooltipFilter;return f&&(h=f(h)),h.length&&(l.onmouseover=()=>pl(i,l,h)),l}}function jo(o,i){let l=h=>{let f=i.getBoundingClientRect();if(!(h.clientX>f.left-10&&h.clientX<f.right+10&&h.clientY>f.top-10&&h.clientY<f.bottom+10)){for(let m=h.target;m;m=m.parentNode)if(m.nodeType==1&&m.classList.contains("cm-tooltip-lint"))return;window.removeEventListener("mousemove",l),o.state.field(yl)&&o.dispatch({effects:bo.of(null)})}};window.addEventListener("mousemove",l)}function pl(o,i,l){function h(){let k=o.elementAtHeight(i.getBoundingClientRect().top+5-o.documentTop);o.coordsAtPos(k.from)&&o.dispatch({effects:bo.of({pos:k.from,above:!1,create(){return{dom:Ho(o,l),getCoords:()=>i.getBoundingClientRect()}}})}),i.onmouseout=i.onmousemove=null,jo(o,i)}let{hoverTime:f}=o.state.facet(e),m=setTimeout(h,f);i.onmouseout=()=>{clearTimeout(m),i.onmouseout=i.onmousemove=null},i.onmousemove=()=>{clearTimeout(m),m=setTimeout(h,f)}}function Zo(o,i){let l=Object.create(null);for(let f of i){let m=o.lineAt(f.from);(l[m.from]||(l[m.from]=[])).push(f)}let h=[];for(let f in l)h.push(new dl(l[f]).range(+f));return L.Xs.of(h,!0)}const ml=(0,G.v5)({class:"cm-gutter-lint",markers:o=>o.state.field(gl)}),gl=L.QQ.define({create(){return L.Xs.empty},update(o,i){o=o.map(i.changes);let l=i.state.facet(e).markerFilter;for(let h of i.effects)if(h.is(Us)){let f=h.value;l&&(f=l(f||[])),o=Zo(i.state.doc,f.slice(0))}return o}}),bo=L.Py.define(),yl=L.QQ.define({create(){return null},update(o,i){return o&&i.docChanged&&(o=ol(i,o)?null:Object.assign(Object.assign({},o),{pos:i.changes.mapPos(o.pos)})),i.effects.reduce((l,h)=>h.is(bo)?h.value:l,o)},provide:o=>G.hJ.from(o)}),Ol=G.tk.baseTheme({".cm-gutter-lint":{width:"1.4em","& .cm-gutterElement":{padding:".2em"}},".cm-lint-marker":{width:"1em",height:"1em"},".cm-lint-marker-info":{content:Xr('<path fill="#aaf" stroke="#77e" stroke-width="6" stroke-linejoin="round" d="M5 5L35 5L35 35L5 35Z"/>')},".cm-lint-marker-warning":{content:Xr('<path fill="#fe8" stroke="#fd7" stroke-width="6" stroke-linejoin="round" d="M20 6L37 35L3 35Z"/>')},".cm-lint-marker-error":{content:Xr('<circle cx="20" cy="20" r="15" fill="#f87" stroke="#f43" stroke-width="6"/>')}}),r=[ki,G.tk.decorations.compute([ki],o=>{let{selected:i,panel:l}=o.field(ki);return!i||!l||i.from==i.to?G.p.none:G.p.set([al.range(i.from,i.to)])}),(0,G.bF)(Cr,{hideOn:ol}),ul],e=L.r$.define({combine(o){return(0,L.BO)(o,{hoverTime:300,markerFilter:null,tooltipFilter:null})}});function t(o={}){return[e.of(o),gl,ml,Ol,yl]}function n(o,i){let l=o.field(ki,!1);if(l&&l.diagnostics.size)for(let h=RangeSet.iter([l.diagnostics]);h.value;h.next())i(h.value.spec.diagnostic,h.from,h.to)}var s=function(i){i===void 0&&(i={});var{crosshairCursor:l=!1}=i,h=[];i.closeBracketsKeymap!==!1&&(h=h.concat(Bo)),i.defaultKeymap!==!1&&(h=h.concat(io)),i.searchKeymap!==!1&&(h=h.concat(nr)),i.historyKeymap!==!1&&(h=h.concat(x)),i.foldKeymap!==!1&&(h=h.concat(Se.e7)),i.completionKeymap!==!1&&(h=h.concat(No)),i.lintKeymap!==!1&&(h=h.concat(yo));var f=[];return i.lineNumbers!==!1&&f.push((0,G.Eu)()),i.highlightActiveLineGutter!==!1&&f.push((0,G.HQ)()),i.highlightSpecialChars!==!1&&f.push((0,G.AE)()),i.history!==!1&&f.push(wt()),i.foldGutter!==!1&&f.push((0,Se.mi)()),i.drawSelection!==!1&&f.push((0,G.Uw)()),i.dropCursor!==!1&&f.push((0,G.qr)()),i.allowMultipleSelections!==!1&&f.push(L.yy.allowMultipleSelections.of(!0)),i.indentOnInput!==!1&&f.push((0,Se.nY)()),i.syntaxHighlighting!==!1&&f.push((0,Se.nF)(Se.R_,{fallback:!0})),i.bracketMatching!==!1&&f.push((0,Se.n$)()),i.closeBrackets!==!1&&f.push(Oo()),i.autocompletion!==!1&&f.push(rl()),i.rectangularSelection!==!1&&f.push((0,G.Zs)()),l!==!1&&f.push((0,G.S2)()),i.highlightActiveLine!==!1&&f.push((0,G.ZO)()),i.highlightSelectionMatches!==!1&&f.push(Lr()),i.tabSize&&typeof i.tabSize=="number"&&f.push(Se.c.of(" ".repeat(i.tabSize))),f.concat([G.$f.of(h.flat())]).filter(Boolean)},c=function(i){i===void 0&&(i={});var l=[];i.defaultKeymap!==!1&&(l=l.concat(defaultKeymap)),i.historyKeymap!==!1&&(l=l.concat(historyKeymap));var h=[];return i.highlightSpecialChars!==!1&&h.push(highlightSpecialChars()),i.history!==!1&&h.push(history()),i.drawSelection!==!1&&h.push(drawSelection()),i.syntaxHighlighting!==!1&&h.push(syntaxHighlighting(defaultHighlightStyle,{fallback:!0})),h.concat([keymap.of(l.flat())]).filter(Boolean)},u=q(86253);const y="#e5c07b",b="#e06c75",M="#56b6c2",A="#ffffff",F="#abb2bf",$="#7d8799",X="#61afef",_="#98c379",le="#d19a66",se="#c678dd",de="#21252b",Je="#2c313a",ht="#282c34",Ue="#353a42",at="#3E4451",kt="#528bff",Vi={chalky:y,coral:b,cyan:M,invalid:A,ivory:F,stone:$,malibu:X,sage:_,whiskey:le,violet:se,darkBackground:de,highlightBackground:Je,background:ht,tooltipBackground:Ue,selection:at,cursor:kt},sn=G.tk.theme({"&":{color:F,backgroundColor:ht},".cm-content":{caretColor:kt},".cm-cursor, .cm-dropCursor":{borderLeftColor:kt},"&.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground, .cm-selectionBackground, .cm-content ::selection":{backgroundColor:at},".cm-panels":{backgroundColor:de,color:F},".cm-panels.cm-panels-top":{borderBottom:"2px solid black"},".cm-panels.cm-panels-bottom":{borderTop:"2px solid black"},".cm-searchMatch":{backgroundColor:"#72a1ff59",outline:"1px solid #457dff"},".cm-searchMatch.cm-searchMatch-selected":{backgroundColor:"#6199ff2f"},".cm-activeLine":{backgroundColor:"#6699ff0b"},".cm-selectionMatch":{backgroundColor:"#aafe661a"},"&.cm-focused .cm-matchingBracket, &.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bad0f847"},".cm-gutters":{backgroundColor:ht,color:$,border:"none"},".cm-activeLineGutter":{backgroundColor:Je},".cm-foldPlaceholder":{backgroundColor:"transparent",border:"none",color:"#ddd"},".cm-tooltip":{border:"none",backgroundColor:Ue},".cm-tooltip .cm-tooltip-arrow:before":{borderTopColor:"transparent",borderBottomColor:"transparent"},".cm-tooltip .cm-tooltip-arrow:after":{borderTopColor:Ue,borderBottomColor:Ue},".cm-tooltip-autocomplete":{"& > ul > li[aria-selected]":{backgroundColor:Je,color:F}}},{dark:!0}),Ts=Se.Qf.define([{tag:u.pJ.keyword,color:se},{tag:[u.pJ.name,u.pJ.deleted,u.pJ.character,u.pJ.propertyName,u.pJ.macroName],color:b},{tag:[u.pJ.function(u.pJ.variableName),u.pJ.labelName],color:X},{tag:[u.pJ.color,u.pJ.constant(u.pJ.name),u.pJ.standard(u.pJ.name)],color:le},{tag:[u.pJ.definition(u.pJ.name),u.pJ.separator],color:F},{tag:[u.pJ.typeName,u.pJ.className,u.pJ.number,u.pJ.changed,u.pJ.annotation,u.pJ.modifier,u.pJ.self,u.pJ.namespace],color:y},{tag:[u.pJ.operator,u.pJ.operatorKeyword,u.pJ.url,u.pJ.escape,u.pJ.regexp,u.pJ.link,u.pJ.special(u.pJ.string)],color:M},{tag:[u.pJ.meta,u.pJ.comment],color:$},{tag:u.pJ.strong,fontWeight:"bold"},{tag:u.pJ.emphasis,fontStyle:"italic"},{tag:u.pJ.strikethrough,textDecoration:"line-through"},{tag:u.pJ.link,color:$,textDecoration:"underline"},{tag:u.pJ.heading,fontWeight:"bold",color:b},{tag:[u.pJ.atom,u.pJ.bool,u.pJ.special(u.pJ.variableName)],color:le},{tag:[u.pJ.processingInstruction,u.pJ.string,u.pJ.inserted],color:_},{tag:u.pJ.invalid,color:A}]),Yr=[sn,(0,Se.nF)(Ts)];var Ko=G.tk.theme({"&":{backgroundColor:"#fff"}},{dark:!1}),qr=function(i){i===void 0&&(i={});var{indentWithTab:l=!0,editable:h=!0,readOnly:f=!1,theme:m="light",placeholder:k="",basicSetup:T=!0}=i,B=[];switch(l&&B.unshift(G.$f.of([cr])),T&&(typeof T=="boolean"?B.unshift(s()):B.unshift(s(T))),k&&B.unshift((0,G.W$)(k)),m){case"light":B.push(Ko);break;case"dark":B.push(Yr);break;case"none":break;default:B.push(m);break}return h===!1&&B.push(G.tk.editable.of(!1)),f&&B.push(L.yy.readOnly.of(!0)),[...B]},Qr=o=>({line:o.state.doc.lineAt(o.state.selection.main.from),lineCount:o.state.doc.lines,lineBreak:o.state.lineBreak,length:o.state.doc.length,readOnly:o.state.readOnly,tabSize:o.state.tabSize,selection:o.state.selection,selectionAsSingle:o.state.selection.asSingle().main,ranges:o.state.selection.ranges,selectionCode:o.state.sliceDoc(o.state.selection.main.from,o.state.selection.main.to),selections:o.state.selection.ranges.map(i=>o.state.sliceDoc(i.from,i.to)),selectedText:o.state.selection.ranges.some(i=>!i.empty)}),Ms=L.q6.define(),Es=[];function hr(o){var{value:i,selection:l,onChange:h,onStatistics:f,onCreateEditor:m,onUpdate:k,extensions:T=Es,autoFocus:B,theme:J="light",height:Y=null,minHeight:ge=null,maxHeight:Ie=null,width:ct=null,minWidth:Qt=null,maxWidth:Yi=null,placeholder:is="",editable:Ds=!0,readOnly:Ti=!1,indentWithTab:gs=!0,basicSetup:Dn=!0,root:hn,initialState:Os}=o,[Ps,Jo]=(0,ue.useState)(),[cn,Ys]=(0,ue.useState)(),[_r,eo]=(0,ue.useState)(),vl=G.tk.theme({"&":{height:Y,minHeight:ge,maxHeight:Ie,width:ct,minWidth:Qt,maxWidth:Yi},"& .cm-scroller":{height:"100% !important"}}),bl=G.tk.updateListener.of(ys=>{if(ys.docChanged&&typeof h=="function"&&!ys.transactions.some(Bl=>Bl.annotation(Ms))){var wo=ys.state.doc,Uo=wo.toString();h(Uo,ys)}f&&f(Qr(ys))}),Rl=qr({theme:J,editable:Ds,readOnly:Ti,placeholder:is,indentWithTab:gs,basicSetup:Dn}),xo=[bl,vl,...Rl];return k&&typeof k=="function"&&xo.push(G.tk.updateListener.of(k)),xo=xo.concat(T),(0,ue.useEffect)(()=>{if(Ps&&!_r){var ys={doc:i,selection:l,extensions:xo},wo=Os?L.yy.fromJSON(Os.json,ys,Os.fields):L.yy.create(ys);if(eo(wo),!cn){var Uo=new G.tk({state:wo,parent:Ps,root:hn});Ys(Uo),m&&m(Uo,wo)}}return()=>{cn&&(eo(void 0),Ys(void 0))}},[Ps,_r]),(0,ue.useEffect)(()=>Jo(o.container),[o.container]),(0,ue.useEffect)(()=>()=>{cn&&(cn.destroy(),Ys(void 0))},[cn]),(0,ue.useEffect)(()=>{B&&cn&&cn.focus()},[B,cn]),(0,ue.useEffect)(()=>{cn&&cn.dispatch({effects:L.Py.reconfigure.of(xo)})},[J,T,Y,ge,Ie,ct,Qt,Yi,is,Ds,Ti,gs,Dn,h,k]),(0,ue.useEffect)(()=>{if(i!==void 0){var ys=cn?cn.state.doc.toString():"";cn&&i!==ys&&cn.dispatch({changes:{from:0,to:ys.length,insert:i||""},annotations:[Ms.of(!0)]})}},[i,cn]),{state:_r,setState:eo,view:cn,setView:Ys,container:Ps,setContainer:Jo}}var Xs=q(52322),Tr=["className","value","selection","extensions","onChange","onStatistics","onCreateEditor","onUpdate","autoFocus","theme","height","minHeight","maxHeight","width","minWidth","maxWidth","basicSetup","placeholder","indentWithTab","editable","readOnly","root","initialState"],ts=(0,ue.forwardRef)((o,i)=>{var{className:l,value:h="",selection:f,extensions:m=[],onChange:k,onStatistics:T,onCreateEditor:B,onUpdate:J,autoFocus:Y,theme:ge="light",height:Ie,minHeight:ct,maxHeight:Qt,width:Yi,minWidth:is,maxWidth:Ds,basicSetup:Ti,placeholder:gs,indentWithTab:Dn,editable:hn,readOnly:Os,root:Ps,initialState:Jo}=o,cn=(0,we.Z)(o,Tr),Ys=(0,ue.useRef)(null),{state:_r,view:eo,container:vl}=hr({container:Ys.current,root:Ps,value:h,autoFocus:Y,theme:ge,height:Ie,minHeight:ct,maxHeight:Qt,width:Yi,minWidth:is,maxWidth:Ds,basicSetup:Ti,placeholder:gs,indentWithTab:Dn,editable:hn,readOnly:Os,selection:f,onChange:k,onStatistics:T,onCreateEditor:B,onUpdate:J,extensions:m,initialState:Jo});if((0,ue.useImperativeHandle)(i,()=>({editor:Ys.current,state:_r,view:eo}),[Ys,vl,_r,eo]),typeof h!="string")throw new Error("value must be typeof string but got "+typeof h);var bl=typeof ge=="string"?"cm-theme-"+ge:"cm-theme";return(0,Xs.jsx)("div",(0,p.Z)({ref:Ys,className:""+bl+(l?" "+l:"")},cn))});ts.displayName="CodeMirror";const ms=ts},77120:(wn,Nt,q)=>{q.d(Nt,{Gn:()=>ae,K0:()=>Mi,Qf:()=>yi,R_:()=>Qi,SS:()=>Ge,Um:()=>w,c:()=>_t,e7:()=>Ve,il:()=>Ne,mi:()=>gi,n$:()=>R,nF:()=>zi,nY:()=>te,qz:()=>_e,y1:()=>ei});var p=q(21649),we=q(1727),ue=q(65329),L=q(86253),G=q(37207),Se;const Fe=new p.md;function bt(O){return we.r$.define({combine:O?g=>g.concat(O):void 0})}const ft=new p.md;class xt{constructor(g,S,P=[],W=""){this.data=g,this.name=W,we.yy.prototype.hasOwnProperty("tree")||Object.defineProperty(we.yy.prototype,"tree",{get(){return _e(this)}}),this.parser=S,this.extension=[Ot.of(this),we.yy.languageData.of((K,U,he)=>{let oe=Ze(K,U,he),De=oe.type.prop(Fe);if(!De)return[];let je=K.facet(De),Wt=oe.type.prop(ft);if(Wt){let Ui=oe.resolve(U-oe.from,he);for(let Ei of Wt)if(Ei.test(Ui,K)){let gn=K.facet(Ei.facet);return Ei.type=="replace"?gn:gn.concat(je)}}return je})].concat(P)}isActiveAt(g,S,P=-1){return Ze(g,S,P).type.prop(Fe)==this.data}findRegions(g){let S=g.facet(Ot);if((S==null?void 0:S.data)==this.data)return[{from:0,to:g.doc.length}];if(!S||!S.allowsNesting)return[];let P=[],W=(K,U)=>{if(K.prop(Fe)==this.data){P.push({from:U,to:U+K.length});return}let he=K.prop(p.md.mounted);if(he){if(he.tree.prop(Fe)==this.data){if(he.overlay)for(let oe of he.overlay)P.push({from:oe.from+U,to:oe.to+U});else P.push({from:U,to:U+K.length});return}else if(he.overlay){let oe=P.length;if(W(he.tree,he.overlay[0].from+U),P.length>oe)return}}for(let oe=0;oe<K.children.length;oe++){let De=K.children[oe];De instanceof p.mp&&W(De,K.positions[oe]+U)}};return W(_e(g),0),P}get allowsNesting(){return!0}}xt.setState=we.Py.define();function Ze(O,g,S){let P=O.facet(Ot),W=_e(O).topNode;if(!P||P.allowsNesting)for(let K=W;K;K=K.enter(g,S,p.vj.ExcludeBuffers))K.type.isTop&&(W=K);return W}class nt extends null{constructor(g,S,P){super(g,S,[],P),this.parser=S}static define(g){let S=bt(g.languageData);return new nt(S,g.parser.configure({props:[Fe.add(P=>P.isTop?S:void 0)]}),g.name)}configure(g,S){return new nt(this.data,this.parser.configure(g),S||this.name)}get allowsNesting(){return this.parser.hasWrappers()}}function _e(O){let g=O.field(xt.state,!1);return g?g.tree:p.mp.empty}function mt(O,g,S=50){var P;let W=(P=O.field(xt.state,!1))===null||P===void 0?void 0:P.context;if(!W)return null;let K=W.viewport;W.updateViewport({from:0,to:g});let U=W.isDone(g)||W.work(S,g)?W.tree:null;return W.updateViewport(K),U}function mi(O,g=O.doc.length){var S;return((S=O.field(xt.state,!1))===null||S===void 0?void 0:S.context.isDone(g))||!1}function Xt(O,g=O.viewport.to,S=100){let P=mt(O.state,g,S);return P!=_e(O.state)&&O.dispatch({}),!!P}function me(O){var g;return((g=O.plugin(Pt))===null||g===void 0?void 0:g.isWorking())||!1}class ut{constructor(g){this.doc=g,this.cursorPos=0,this.string="",this.cursor=g.iter()}get length(){return this.doc.length}syncTo(g){return this.string=this.cursor.next(g-this.cursorPos).value,this.cursorPos=g+this.string.length,this.cursorPos-this.string.length}chunk(g){return this.syncTo(g),this.string}get lineChunks(){return!0}read(g,S){let P=this.cursorPos-this.string.length;return g<P||S>=this.cursorPos?this.doc.sliceString(g,S):this.string.slice(g-P,S-P)}}let Kt=null;class bi{constructor(g,S,P=[],W,K,U,he,oe){this.parser=g,this.state=S,this.fragments=P,this.tree=W,this.treeLen=K,this.viewport=U,this.skipped=he,this.scheduleOn=oe,this.parse=null,this.tempSkipped=[]}static create(g,S,P){return new bi(g,S,[],p.mp.empty,0,P,[],null)}startParse(){return this.parser.startParse(new ut(this.state.doc),this.fragments)}work(g,S){return S!=null&&S>=this.state.doc.length&&(S=void 0),this.tree!=p.mp.empty&&this.isDone(S!=null?S:this.state.doc.length)?(this.takeTree(),!0):this.withContext(()=>{var P;if(typeof g=="number"){let W=Date.now()+g;g=()=>Date.now()>W}for(this.parse||(this.parse=this.startParse()),S!=null&&(this.parse.stoppedAt==null||this.parse.stoppedAt>S)&&S<this.state.doc.length&&this.parse.stopAt(S);;){let W=this.parse.advance();if(W)if(this.fragments=this.withoutTempSkipped(p.i9.addTree(W,this.fragments,this.parse.stoppedAt!=null)),this.treeLen=(P=this.parse.stoppedAt)!==null&&P!==void 0?P:this.state.doc.length,this.tree=W,this.parse=null,this.treeLen<(S!=null?S:this.state.doc.length))this.parse=this.startParse();else return!0;if(g())return!1}})}takeTree(){let g,S;this.parse&&(g=this.parse.parsedPos)>=this.treeLen&&((this.parse.stoppedAt==null||this.parse.stoppedAt>g)&&this.parse.stopAt(g),this.withContext(()=>{for(;!(S=this.parse.advance()););}),this.treeLen=g,this.tree=S,this.fragments=this.withoutTempSkipped(p.i9.addTree(this.tree,this.fragments,!0)),this.parse=null)}withContext(g){let S=Kt;Kt=this;try{return g()}finally{Kt=S}}withoutTempSkipped(g){for(let S;S=this.tempSkipped.pop();)g=fi(g,S.from,S.to);return g}changes(g,S){let{fragments:P,tree:W,treeLen:K,viewport:U,skipped:he}=this;if(this.takeTree(),!g.empty){let oe=[];if(g.iterChangedRanges((De,je,Wt,Ui)=>oe.push({fromA:De,toA:je,fromB:Wt,toB:Ui})),P=p.i9.applyChanges(P,oe),W=p.mp.empty,K=0,U={from:g.mapPos(U.from,-1),to:g.mapPos(U.to,1)},this.skipped.length){he=[];for(let De of this.skipped){let je=g.mapPos(De.from,1),Wt=g.mapPos(De.to,-1);je<Wt&&he.push({from:je,to:Wt})}}}return new bi(this.parser,S,P,W,K,U,he,this.scheduleOn)}updateViewport(g){if(this.viewport.from==g.from&&this.viewport.to==g.to)return!1;this.viewport=g;let S=this.skipped.length;for(let P=0;P<this.skipped.length;P++){let{from:W,to:K}=this.skipped[P];W<g.to&&K>g.from&&(this.fragments=fi(this.fragments,W,K),this.skipped.splice(P--,1))}return this.skipped.length>=S?!1:(this.reset(),!0)}reset(){this.parse&&(this.takeTree(),this.parse=null)}skipUntilInView(g,S){this.skipped.push({from:g,to:S})}static getSkippingParser(g){return new class extends p._b{createParse(S,P,W){let K=W[0].from,U=W[W.length-1].to;return{parsedPos:K,advance(){let oe=Kt;if(oe){for(let De of W)oe.tempSkipped.push(De);g&&(oe.scheduleOn=oe.scheduleOn?Promise.all([oe.scheduleOn,g]):g)}return this.parsedPos=U,new p.mp(p.Jq.none,[],[],U-K)},stoppedAt:null,stopAt(){}}}}}isDone(g){g=Math.min(g,this.state.doc.length);let S=this.fragments;return this.treeLen>=g&&S.length&&S[0].from==0&&S[0].to>=g}static get(){return Kt}}function fi(O,g,S){return p.i9.applyChanges(O,[{fromA:g,toA:S,fromB:g,toB:S}])}class Et{constructor(g){this.context=g,this.tree=g.tree}apply(g){if(!g.docChanged&&this.tree==this.context.tree)return this;let S=this.context.changes(g.changes,g.state),P=this.context.treeLen==g.startState.doc.length?void 0:Math.max(g.changes.mapPos(this.context.treeLen),S.viewport.to);return S.work(20,P)||S.takeTree(),new Et(S)}static init(g){let S=Math.min(3e3,g.doc.length),P=bi.create(g.facet(Ot).parser,g,{from:0,to:S});return P.work(20,S)||P.takeTree(),new Et(P)}}xt.state=we.QQ.define({create:Et.init,update(O,g){for(let S of g.effects)if(S.is(xt.setState))return S.value;return g.startState.facet(Ot)!=g.state.facet(Ot)?Et.init(g.state):O.apply(g)}});let ui=O=>{let g=setTimeout(()=>O(),500);return()=>clearTimeout(g)};typeof requestIdleCallback!="undefined"&&(ui=O=>{let g=-1,S=setTimeout(()=>{g=requestIdleCallback(O,{timeout:500-100})},100);return()=>g<0?clearTimeout(S):cancelIdleCallback(g)});const Oi=typeof navigator!="undefined"&&(!((Se=navigator.scheduling)===null||Se===void 0)&&Se.isInputPending)?()=>navigator.scheduling.isInputPending():null,Pt=ue.lg.fromClass(class{constructor(g){this.view=g,this.working=null,this.workScheduled=0,this.chunkEnd=-1,this.chunkBudget=-1,this.work=this.work.bind(this),this.scheduleWork()}update(g){let S=this.view.state.field(xt.state).context;(S.updateViewport(g.view.viewport)||this.view.viewport.to>S.treeLen)&&this.scheduleWork(),(g.docChanged||g.selectionSet)&&(this.view.hasFocus&&(this.chunkBudget+=50),this.scheduleWork()),this.checkAsyncSchedule(S)}scheduleWork(){if(this.working)return;let{state:g}=this.view,S=g.field(xt.state);(S.tree!=S.context.tree||!S.context.isDone(g.doc.length))&&(this.working=ui(this.work))}work(g){this.working=null;let S=Date.now();if(this.chunkEnd<S&&(this.chunkEnd<0||this.view.hasFocus)&&(this.chunkEnd=S+3e4,this.chunkBudget=3e3),this.chunkBudget<=0)return;let{state:P,viewport:{to:W}}=this.view,K=P.field(xt.state);if(K.tree==K.context.tree&&K.context.isDone(W+1e5))return;let U=Date.now()+Math.min(this.chunkBudget,100,g&&!Oi?Math.max(25,g.timeRemaining()-5):1e9),he=K.context.treeLen<W&&P.doc.length>W+1e3,oe=K.context.work(()=>Oi&&Oi()||Date.now()>U,W+(he?0:1e5));this.chunkBudget-=Date.now()-S,(oe||this.chunkBudget<=0)&&(K.context.takeTree(),this.view.dispatch({effects:xt.setState.of(new Et(K.context))})),this.chunkBudget>0&&!(oe&&!he)&&this.scheduleWork(),this.checkAsyncSchedule(K.context)}checkAsyncSchedule(g){g.scheduleOn&&(this.workScheduled++,g.scheduleOn.then(()=>this.scheduleWork()).catch(S=>(0,ue.OO)(this.view.state,S)).then(()=>this.workScheduled--),g.scheduleOn=null)}destroy(){this.working&&this.working()}isWorking(){return!!(this.working||this.workScheduled>0)}},{eventHandlers:{focus(){this.scheduleWork()}}}),Ot=we.r$.define({combine(O){return O.length?O[0]:null},enables:O=>[xt.state,Pt,ue.tk.contentAttributes.compute([O],g=>{let S=g.facet(O);return S&&S.name?{"data-language":S.name}:{}})]});class Dt{constructor(g,S=[]){this.language=g,this.support=S,this.extension=[g,S]}}class wt{constructor(g,S,P,W,K,U=void 0){this.name=g,this.alias=S,this.extensions=P,this.filename=W,this.loadFunc=K,this.support=U,this.loading=null}load(){return this.loading||(this.loading=this.loadFunc().then(g=>this.support=g,g=>{throw this.loading=null,g}))}static of(g){let{load:S,support:P}=g;if(!S){if(!P)throw new RangeError("Must pass either 'load' or 'support' to LanguageDescription.of");S=()=>Promise.resolve(P)}return new wt(g.name,(g.alias||[]).concat(g.name).map(W=>W.toLowerCase()),g.extensions||[],g.filename,S,P)}static matchFilename(g,S){for(let W of g)if(W.filename&&W.filename.test(S))return W;let P=/\.([^.]+)$/.exec(S);if(P){for(let W of g)if(W.extensions.indexOf(P[1])>-1)return W}return null}static matchLanguageName(g,S,P=!0){S=S.toLowerCase();for(let W of g)if(W.alias.some(K=>K==S))return W;if(P)for(let W of g)for(let K of W.alias){let U=S.indexOf(K);if(U>-1&&(K.length>2||!/\w/.test(S[U-1])&&!/\w/.test(S[U+K.length])))return W}return null}}const ai=we.r$.define(),_t=we.r$.define({combine:O=>{if(!O.length)return"  ";let g=O[0];if(!g||/\S/.test(g)||Array.from(g).some(S=>S!=g[0]))throw new Error("Invalid indent unit: "+JSON.stringify(O[0]));return g}});function ei(O){let g=O.facet(_t);return g.charCodeAt(0)==9?O.tabSize*g.length:g.length}function Ge(O,g){let S="",P=O.tabSize,W=O.facet(_t)[0];if(W=="	"){for(;g>=P;)S+="	",g-=P;W=" "}for(let K=0;K<g;K++)S+=W;return S}function Mi(O,g){O instanceof we.yy&&(O=new ae(O));for(let P of O.state.facet(ai)){let W=P(O,g);if(W!==void 0)return W}let S=_e(O.state);return S.length>=g?ze(O,S,g):null}function Xe(O,g,S){let P=Object.create(null),W=new ae(O,{overrideIndentation:U=>{var he;return(he=P[U])!==null&&he!==void 0?he:-1}}),K=[];for(let U=g;U<=S;){let he=O.doc.lineAt(U);U=he.to+1;let oe=Mi(W,he.from);if(oe==null)continue;/\S/.test(he.text)||(oe=0);let De=/^\s*/.exec(he.text)[0],je=Ge(O,oe);De!=je&&(P[he.from]=oe,K.push({from:he.from,to:he.from+De.length,insert:je}))}return O.changes(K)}class ae{constructor(g,S={}){this.state=g,this.options=S,this.unit=ei(g)}lineAt(g,S=1){let P=this.state.doc.lineAt(g),{simulateBreak:W,simulateDoubleBreak:K}=this.options;return W!=null&&W>=P.from&&W<=P.to?K&&W==g?{text:"",from:g}:(S<0?W<g:W<=g)?{text:P.text.slice(W-P.from),from:W}:{text:P.text.slice(0,W-P.from),from:P.from}:P}textAfterPos(g,S=1){if(this.options.simulateDoubleBreak&&g==this.options.simulateBreak)return"";let{text:P,from:W}=this.lineAt(g,S);return P.slice(g-W,Math.min(P.length,g+100-W))}column(g,S=1){let{text:P,from:W}=this.lineAt(g,S),K=this.countColumn(P,g-W),U=this.options.overrideIndentation?this.options.overrideIndentation(W):-1;return U>-1&&(K+=U-this.countColumn(P,P.search(/\S|$/))),K}countColumn(g,S=g.length){return(0,we.IS)(g,this.state.tabSize,S)}lineIndent(g,S=1){let{text:P,from:W}=this.lineAt(g,S),K=this.options.overrideIndentation;if(K){let U=K(W);if(U>-1)return U}return this.countColumn(P,P.search(/\S|$/))}get simulatedBreak(){return this.options.simulateBreak||null}}const be=new p.md;function ze(O,g,S){let P=g.resolveStack(S),W=P.node.enterUnfinishedNodesBefore(S);if(W!=P.node){let K=[];for(let U=W;U!=P.node;U=U.parent)K.push(U);for(let U=K.length-1;U>=0;U--)P={node:K[U],next:P}}return ke(P,O,S)}function ke(O,g,S){for(let P=O;P;P=P.next){let W=zt(P.node);if(W)return W(Yt.create(g,S,P))}return 0}function Ee(O){return O.pos==O.options.simulateBreak&&O.options.simulateDoubleBreak}function zt(O){let g=O.type.prop(be);if(g)return g;let S=O.firstChild,P;if(S&&(P=S.type.prop(p.md.closedBy))){let W=O.lastChild,K=W&&P.indexOf(W.name)>-1;return U=>gt(U,!0,1,void 0,K&&!Ee(U)?W.from:void 0)}return O.parent==null?Le:null}function Le(){return 0}class Yt extends ae{constructor(g,S,P){super(g.state,g.options),this.base=g,this.pos=S,this.context=P}get node(){return this.context.node}static create(g,S,P){return new Yt(g,S,P)}get textAfter(){return this.textAfterPos(this.pos)}get baseIndent(){return this.baseIndentFor(this.node)}baseIndentFor(g){let S=this.state.doc.lineAt(g.from);for(;;){let P=g.resolve(S.from);for(;P.parent&&P.parent.from==P.from;)P=P.parent;if(et(P,g))break;S=this.state.doc.lineAt(P.from)}return this.lineIndent(S.from)}continue(){return ke(this.context.next,this.base,this.pos)}}function et(O,g){for(let S=g;S;S=S.parent)if(O==S)return!0;return!1}function Pi(O){let g=O.node,S=g.childAfter(g.from),P=g.lastChild;if(!S)return null;let W=O.options.simulateBreak,K=O.state.doc.lineAt(S.from),U=W==null||W<=K.from?K.to:Math.min(K.to,W);for(let he=S.to;;){let oe=g.childAfter(he);if(!oe||oe==P)return null;if(!oe.type.isSkipped)return oe.from<U?S:null;he=oe.to}}function Ft({closing:O,align:g=!0,units:S=1}){return P=>gt(P,g,S,O)}function gt(O,g,S,P,W){let K=O.textAfter,U=K.match(/^\s*/)[0].length,he=P&&K.slice(U,U+P.length)==P||W==O.pos+U,oe=g?Pi(O):null;return oe?he?O.column(oe.from):O.column(oe.to):O.baseIndent+(he?0:O.unit*S)}const si=O=>O.baseIndent;function rn({except:O,units:g=1}={}){return S=>{let P=O&&O.test(S.textAfter);return S.baseIndent+(P?0:g*S.unit)}}const Zi=200;function te(){return we.yy.transactionFilter.of(O=>{if(!O.docChanged||!O.isUserEvent("input.type")&&!O.isUserEvent("input.complete"))return O;let g=O.startState.languageDataAt("indentOnInput",O.startState.selection.main.head);if(!g.length)return O;let S=O.newDoc,{head:P}=O.newSelection.main,W=S.lineAt(P);if(P>W.from+Zi)return O;let K=S.sliceString(W.from,P);if(!g.some(De=>De.test(K)))return O;let{state:U}=O,he=-1,oe=[];for(let{head:De}of U.selection.ranges){let je=U.doc.lineAt(De);if(je.from==he)continue;he=je.from;let Wt=Mi(U,je.from);if(Wt==null)continue;let Ui=/^\s*/.exec(je.text)[0],Ei=Ge(U,Wt);Ui!=Ei&&oe.push({from:je.from,to:je.from+Ui.length,insert:Ei})}return oe.length?[O,{changes:oe,sequential:!0}]:O})}const x=we.r$.define(),C=new p.md;function I(O){let g=O.firstChild,S=O.lastChild;return g&&g.to<S.from?{from:g.to,to:S.type.isError?O.to:S.from}:null}function N(O,g,S){let P=_e(O);if(P.length<S)return null;let W=P.resolveStack(S,1),K=null;for(let U=W;U;U=U.next){let he=U.node;if(he.to<=S||he.from>S)continue;if(K&&he.from<g)break;let oe=he.type.prop(C);if(oe&&(he.to<P.length-50||P.length==O.doc.length||!Z(he))){let De=oe(he,O);De&&De.from<=S&&De.from>=g&&De.to>S&&(K=De)}}return K}function Z(O){let g=O.lastChild;return g&&g.to==O.to&&g.type.isError}function ee(O,g,S){for(let P of O.facet(x)){let W=P(O,g,S);if(W)return W}return N(O,g,S)}function re(O,g){let S=g.mapPos(O.from,1),P=g.mapPos(O.to,-1);return S>=P?void 0:{from:S,to:P}}const xe=we.Py.define({map:re}),He=we.Py.define({map:re});function Pe(O){let g=[];for(let{head:S}of O.state.selection.ranges)g.some(P=>P.from<=S&&P.to>=S)||g.push(O.lineBlockAt(S));return g}const Qe=we.QQ.define({create(){return ue.p.none},update(O,g){O=O.map(g.changes);for(let S of g.effects)if(S.is(xe)&&!ti(O,S.value.from,S.value.to)){let{preparePlaceholder:P}=g.state.facet(ot),W=P?ue.p.replace({widget:new Zt(P(g.state,S.value))}):lt;O=O.update({add:[W.range(S.value.from,S.value.to)]})}else S.is(He)&&(O=O.update({filter:(P,W)=>S.value.from!=P||S.value.to!=W,filterFrom:S.value.from,filterTo:S.value.to}));if(g.selection){let S=!1,{head:P}=g.selection.main;O.between(P,P,(W,K)=>{W<P&&K>P&&(S=!0)}),S&&(O=O.update({filterFrom:P,filterTo:P,filter:(W,K)=>K<=P||W>=P}))}return O},provide:O=>ue.tk.decorations.from(O),toJSON(O,g){let S=[];return O.between(0,g.doc.length,(P,W)=>{S.push(P,W)}),S},fromJSON(O){if(!Array.isArray(O)||O.length%2)throw new RangeError("Invalid JSON for fold state");let g=[];for(let S=0;S<O.length;){let P=O[S++],W=O[S++];if(typeof P!="number"||typeof W!="number")throw new RangeError("Invalid JSON for fold state");g.push(lt.range(P,W))}return ue.p.set(g,!0)}});function tt(O){return O.field(Qe,!1)||RangeSet.empty}function dt(O,g,S){var P;let W=null;return(P=O.field(Qe,!1))===null||P===void 0||P.between(g,S,(K,U)=>{(!W||W.from>K)&&(W={from:K,to:U})}),W}function ti(O,g,S){let P=!1;return O.between(g,g,(W,K)=>{W==g&&K==S&&(P=!0)}),P}function qt(O,g){return O.field(Qe,!1)?g:g.concat(we.Py.appendConfig.of(rt()))}const $t=O=>{for(let g of Pe(O)){let S=ee(O.state,g.from,g.to);if(S)return O.dispatch({effects:qt(O.state,[xe.of(S),Ct(O,S)])}),!0}return!1},jt=O=>{if(!O.state.field(Qe,!1))return!1;let g=[];for(let S of Pe(O)){let P=dt(O.state,S.from,S.to);P&&g.push(He.of(P),Ct(O,P,!1))}return g.length&&O.dispatch({effects:g}),g.length>0};function Ct(O,g,S=!0){let P=O.state.doc.lineAt(g.from).number,W=O.state.doc.lineAt(g.to).number;return ue.tk.announce.of(`${O.state.phrase(S?"Folded lines":"Unfolded lines")} ${P} ${O.state.phrase("to")} ${W}.`)}const Rt=O=>{let{state:g}=O,S=[];for(let P=0;P<g.doc.length;){let W=O.lineBlockAt(P),K=ee(g,W.from,W.to);K&&S.push(xe.of(K)),P=(K?O.lineBlockAt(K.to):W).to+1}return S.length&&O.dispatch({effects:qt(O.state,S)}),!!S.length},xi=O=>{let g=O.state.field(Qe,!1);if(!g||!g.size)return!1;let S=[];return g.between(0,O.state.doc.length,(P,W)=>{S.push(He.of({from:P,to:W}))}),O.dispatch({effects:S}),!0};function st(O,g){for(let S=g;;){let P=ee(O.state,S.from,S.to);if(P&&P.to>g.from)return P;if(!S.from)return null;S=O.lineBlockAt(S.from-1)}}const Ye=O=>{let g=[];for(let S of Pe(O)){let P=dt(O.state,S.from,S.to);if(P)g.push(He.of(P),Ct(O,P,!1));else{let W=st(O,S);W&&g.push(xe.of(W),Ct(O,W))}}return g.length>0&&O.dispatch({effects:qt(O.state,g)}),!!g.length},Ve=[{key:"Ctrl-Shift-[",mac:"Cmd-Alt-[",run:$t},{key:"Ctrl-Shift-]",mac:"Cmd-Alt-]",run:jt},{key:"Ctrl-Alt-[",run:Rt},{key:"Ctrl-Alt-]",run:xi}],Jt={placeholderDOM:null,preparePlaceholder:null,placeholderText:"\u2026"},ot=we.r$.define({combine(O){return(0,we.BO)(O,Jt)}});function rt(O){let g=[Qe,hi];return O&&g.push(ot.of(O)),g}function yt(O,g){let{state:S}=O,P=S.facet(ot),W=U=>{let he=O.lineBlockAt(O.posAtDOM(U.target)),oe=dt(O.state,he.from,he.to);oe&&O.dispatch({effects:He.of(oe)}),U.preventDefault()};if(P.placeholderDOM)return P.placeholderDOM(O,W,g);let K=document.createElement("span");return K.textContent=P.placeholderText,K.setAttribute("aria-label",S.phrase("folded code")),K.title=S.phrase("unfold"),K.className="cm-foldPlaceholder",K.onclick=W,K}const lt=ue.p.replace({widget:new class extends ue.l9{toDOM(O){return yt(O,null)}}});class Zt extends ue.l9{constructor(g){super(),this.value=g}eq(g){return this.value==g.value}toDOM(g){return yt(g,this.value)}}const Bt={openText:"\u2304",closedText:"\u203A",markerDOM:null,domEventHandlers:{},foldingChanged:()=>!1};class pt extends ue.SJ{constructor(g,S){super(),this.config=g,this.open=S}eq(g){return this.config==g.config&&this.open==g.open}toDOM(g){if(this.config.markerDOM)return this.config.markerDOM(this.open);let S=document.createElement("span");return S.textContent=this.open?this.config.openText:this.config.closedText,S.title=g.state.phrase(this.open?"Fold line":"Unfold line"),S}}function gi(O={}){let g=Object.assign(Object.assign({},Bt),O),S=new pt(g,!0),P=new pt(g,!1),W=ue.lg.fromClass(class{constructor(U){this.from=U.viewport.from,this.markers=this.buildMarkers(U)}update(U){(U.docChanged||U.viewportChanged||U.startState.facet(Ot)!=U.state.facet(Ot)||U.startState.field(Qe,!1)!=U.state.field(Qe,!1)||_e(U.startState)!=_e(U.state)||g.foldingChanged(U))&&(this.markers=this.buildMarkers(U.view))}buildMarkers(U){let he=new we.f_;for(let oe of U.viewportLineBlocks){let De=dt(U.state,oe.from,oe.to)?P:ee(U.state,oe.from,oe.to)?S:null;De&&he.add(oe.from,oe.from,De)}return he.finish()}}),{domEventHandlers:K}=g;return[W,(0,ue.v5)({class:"cm-foldGutter",markers(U){var he;return((he=U.plugin(W))===null||he===void 0?void 0:he.markers)||we.Xs.empty},initialSpacer(){return new pt(g,!1)},domEventHandlers:Object.assign(Object.assign({},K),{click:(U,he,oe)=>{if(K.click&&K.click(U,he,oe))return!0;let De=dt(U.state,he.from,he.to);if(De)return U.dispatch({effects:He.of(De)}),!0;let je=ee(U.state,he.from,he.to);return je?(U.dispatch({effects:xe.of(je)}),!0):!1}})}),rt()]}const hi=ue.tk.baseTheme({".cm-foldPlaceholder":{backgroundColor:"#eee",border:"1px solid #ddd",color:"#888",borderRadius:".2em",margin:"0 1px",padding:"0 1px",cursor:"pointer"},".cm-foldGutter span":{padding:"0 1px",cursor:"pointer"}});class yi{constructor(g,S){this.specs=g;let P;function W(he){let oe=G.V.newName();return(P||(P=Object.create(null)))["."+oe]=he,oe}const K=typeof S.all=="string"?S.all:S.all?W(S.all):void 0,U=S.scope;this.scope=U instanceof xt?he=>he.prop(Fe)==U.data:U?he=>he==U:void 0,this.style=(0,L.QR)(g.map(he=>({tag:he.tag,class:he.class||W(Object.assign({},he,{tag:null}))})),{all:K}).style,this.module=P?new G.V(P):null,this.themeType=S.themeType}static define(g,S){return new yi(g,S||{})}}const on=we.r$.define(),Ci=we.r$.define({combine(O){return O.length?[O[0]]:null}});function Lt(O){let g=O.facet(on);return g.length?g:O.facet(Ci)}function zi(O,g){let S=[Ki],P;return O instanceof yi&&(O.module&&S.push(ue.tk.styleModule.of(O.module)),P=O.themeType),g!=null&&g.fallback?S.push(Ci.of(O)):P?S.push(on.computeN([ue.tk.darkTheme],W=>W.facet(ue.tk.darkTheme)==(P=="dark")?[O]:[])):S.push(on.of(O)),S}function Ni(O,g,S){let P=Lt(O),W=null;if(P){for(let K of P)if(!K.scope||S&&K.scope(S)){let U=K.style(g);U&&(W=W?W+" "+U:U)}}return W}class qi{constructor(g){this.markCache=Object.create(null),this.tree=_e(g.state),this.decorations=this.buildDeco(g,Lt(g.state))}update(g){let S=_e(g.state),P=Lt(g.state),W=P!=Lt(g.startState);S.length<g.view.viewport.to&&!W&&S.type==this.tree.type?this.decorations=this.decorations.map(g.changes):(S!=this.tree||g.viewportChanged||W)&&(this.tree=S,this.decorations=this.buildDeco(g.view,P))}buildDeco(g,S){if(!S||!this.tree.length)return ue.p.none;let P=new we.f_;for(let{from:W,to:K}of g.visibleRanges)(0,L.bW)(this.tree,S,(U,he,oe)=>{P.add(U,he,this.markCache[oe]||(this.markCache[oe]=ue.p.mark({class:oe})))},W,K);return P.finish()}}const Ki=we.Wl.high(ue.lg.fromClass(qi,{decorations:O=>O.decorations})),Qi=yi.define([{tag:L.pJ.meta,color:"#404740"},{tag:L.pJ.link,textDecoration:"underline"},{tag:L.pJ.heading,textDecoration:"underline",fontWeight:"bold"},{tag:L.pJ.emphasis,fontStyle:"italic"},{tag:L.pJ.strong,fontWeight:"bold"},{tag:L.pJ.strikethrough,textDecoration:"line-through"},{tag:L.pJ.keyword,color:"#708"},{tag:[L.pJ.atom,L.pJ.bool,L.pJ.url,L.pJ.contentSeparator,L.pJ.labelName],color:"#219"},{tag:[L.pJ.literal,L.pJ.inserted],color:"#164"},{tag:[L.pJ.string,L.pJ.deleted],color:"#a11"},{tag:[L.pJ.regexp,L.pJ.escape,L.pJ.special(L.pJ.string)],color:"#e40"},{tag:L.pJ.definition(L.pJ.variableName),color:"#00f"},{tag:L.pJ.local(L.pJ.variableName),color:"#30a"},{tag:[L.pJ.typeName,L.pJ.namespace],color:"#085"},{tag:L.pJ.className,color:"#167"},{tag:[L.pJ.special(L.pJ.variableName),L.pJ.macroName],color:"#256"},{tag:L.pJ.definition(L.pJ.propertyName),color:"#00c"},{tag:L.pJ.comment,color:"#940"},{tag:L.pJ.invalid,color:"#f00"}]),ri=ue.tk.baseTheme({"&.cm-focused .cm-matchingBracket":{backgroundColor:"#328c8252"},"&.cm-focused .cm-nonmatchingBracket":{backgroundColor:"#bb555544"}}),Ji=1e4,Vn="()[]{}",fn=we.r$.define({combine(O){return(0,we.BO)(O,{afterCursor:!0,brackets:Vn,maxScanDistance:Ji,renderMatch:Cn})}}),vi=ue.p.mark({class:"cm-matchingBracket"}),kn=ue.p.mark({class:"cm-nonmatchingBracket"});function Cn(O){let g=[],S=O.matched?vi:kn;return g.push(S.range(O.start.from,O.start.to)),O.end&&g.push(S.range(O.end.from,O.end.to)),g}const On=[we.QQ.define({create(){return ue.p.none},update(O,g){if(!g.docChanged&&!g.selection)return O;let S=[],P=g.state.facet(fn);for(let W of g.state.selection.ranges){if(!W.empty)continue;let K=w(g.state,W.head,-1,P)||W.head>0&&w(g.state,W.head-1,1,P)||P.afterCursor&&(w(g.state,W.head,1,P)||W.head<g.state.doc.length&&w(g.state,W.head+1,-1,P));K&&(S=S.concat(P.renderMatch(K,g.state)))}return ue.p.set(S,!0)},provide:O=>ue.tk.decorations.from(O)}),ri];function R(O={}){return[fn.of(O),On]}const a=new p.md;function d(O,g,S){let P=O.prop(g<0?p.md.openedBy:p.md.closedBy);if(P)return P;if(O.name.length==1){let W=S.indexOf(O.name);if(W>-1&&W%2==(g<0?1:0))return[S[W+g]]}return null}function v(O){let g=O.type.prop(a);return g?g(O.node):O}function w(O,g,S,P={}){let W=P.maxScanDistance||Ji,K=P.brackets||Vn,U=_e(O),he=U.resolveInner(g,S);for(let oe=he;oe;oe=oe.parent){let De=d(oe.type,S,K);if(De&&oe.from<oe.to){let je=v(oe);if(je&&(S>0?g>=je.from&&g<je.to:g>je.from&&g<=je.to))return E(O,g,S,oe,je,De,K)}}return D(O,g,S,U,he.type,W,K)}function E(O,g,S,P,W,K,U){let he=P.parent,oe={from:W.from,to:W.to},De=0,je=he==null?void 0:he.cursor();if(je&&(S<0?je.childBefore(P.from):je.childAfter(P.to)))do if(S<0?je.to<=P.from:je.from>=P.to){if(De==0&&K.indexOf(je.type.name)>-1&&je.from<je.to){let Wt=v(je);return{start:oe,end:Wt?{from:Wt.from,to:Wt.to}:void 0,matched:!0}}else if(d(je.type,S,U))De++;else if(d(je.type,-S,U)){if(De==0){let Wt=v(je);return{start:oe,end:Wt&&Wt.from<Wt.to?{from:Wt.from,to:Wt.to}:void 0,matched:!1}}De--}}while(S<0?je.prevSibling():je.nextSibling());return{start:oe,matched:!1}}function D(O,g,S,P,W,K,U){let he=S<0?O.sliceDoc(g-1,g):O.sliceDoc(g,g+1),oe=U.indexOf(he);if(oe<0||oe%2==0!=S>0)return null;let De={from:S<0?g-1:g,to:S>0?g+1:g},je=O.doc.iterRange(g,S>0?O.doc.length:0),Wt=0;for(let Ui=0;!je.next().done&&Ui<=K;){let Ei=je.value;S<0&&(Ui+=Ei.length);let gn=g+Ui*S;for(let Tn=S>0?0:Ei.length-1,Qs=S>0?Ei.length:-1;Tn!=Qs;Tn+=S){let $n=U.indexOf(Ei[Tn]);if(!($n<0||P.resolveInner(gn+Tn,1).type!=W))if($n%2==0==S>0)Wt++;else{if(Wt==1)return{start:De,end:{from:gn+Tn,to:gn+Tn+1},matched:$n>>1==oe>>1};Wt--}}S>0&&(Ui+=Ei.length)}return je.done?{start:De,matched:!1}:null}function H(O,g,S,P=0,W=0){g==null&&(g=O.search(/[^\s\u00a0]/),g==-1&&(g=O.length));let K=W;for(let U=P;U<g;U++)O.charCodeAt(U)==9?K+=S-K%S:K++;return K}class j{constructor(g,S,P,W){this.string=g,this.tabSize=S,this.indentUnit=P,this.overrideIndent=W,this.pos=0,this.start=0,this.lastColumnPos=0,this.lastColumnValue=0}eol(){return this.pos>=this.string.length}sol(){return this.pos==0}peek(){return this.string.charAt(this.pos)||void 0}next(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)}eat(g){let S=this.string.charAt(this.pos),P;if(typeof g=="string"?P=S==g:P=S&&(g instanceof RegExp?g.test(S):g(S)),P)return++this.pos,S}eatWhile(g){let S=this.pos;for(;this.eat(g););return this.pos>S}eatSpace(){let g=this.pos;for(;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>g}skipToEnd(){this.pos=this.string.length}skipTo(g){let S=this.string.indexOf(g,this.pos);if(S>-1)return this.pos=S,!0}backUp(g){this.pos-=g}column(){return this.lastColumnPos<this.start&&(this.lastColumnValue=H(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue}indentation(){var g;return(g=this.overrideIndent)!==null&&g!==void 0?g:H(this.string,null,this.tabSize)}match(g,S,P){if(typeof g=="string"){let W=U=>P?U.toLowerCase():U,K=this.string.substr(this.pos,g.length);return W(K)==W(g)?(S!==!1&&(this.pos+=g.length),!0):null}else{let W=this.string.slice(this.pos).match(g);return W&&W.index>0?null:(W&&S!==!1&&(this.pos+=W[0].length),W)}}current(){return this.string.slice(this.start,this.pos)}}function ne(O){return{name:O.name||"",token:O.token,blankLine:O.blankLine||(()=>{}),startState:O.startState||(()=>!0),copyState:O.copyState||fe,indent:O.indent||(()=>null),languageData:O.languageData||{},tokenTable:O.tokenTable||mn}}function fe(O){if(typeof O!="object")return O;let g={};for(let S in O){let P=O[S];g[S]=P instanceof Array?P.slice():P}return g}const ye=new WeakMap;class Ne extends xt{constructor(g){let S=bt(g.languageData),P=ne(g),W,K=new class extends p._b{createParse(U,he,oe){return new pi(W,U,he,oe)}};super(S,K,[ai.of((U,he)=>this.getIndent(U,he))],g.name),this.topNode=ss(S),W=this,this.streamParser=P,this.stateAfter=new p.md({perNode:!0}),this.tokenTable=g.tokenTable?new vs(P.tokenTable):Ls}static define(g){return new Ne(g)}getIndent(g,S){let P=_e(g.state),W=P.resolve(S);for(;W&&W.type!=this.topNode;)W=W.parent;if(!W)return null;let K,{overrideIndentation:U}=g.options;U&&(K=ye.get(g.state),K!=null&&K<S-1e4&&(K=void 0));let he=Be(this,P,0,W.from,K!=null?K:S),oe,De;if(he?(De=he.state,oe=he.pos+1):(De=this.streamParser.startState(g.unit),oe=0),S-oe>1e4)return null;for(;oe<S;){let Wt=g.state.doc.lineAt(oe),Ui=Math.min(S,Wt.to);if(Wt.length){let Ei=U?U(Wt.from):-1,gn=new j(Wt.text,g.state.tabSize,g.unit,Ei<0?void 0:Ei);for(;gn.pos<Ui-Wt.from;)zn(this.streamParser.token,gn,De)}else this.streamParser.blankLine(De,g.unit);if(Ui==S)break;oe=Wt.to+1}let je=g.lineAt(S);return U&&K==null&&ye.set(g.state,je.from),this.streamParser.indent(De,/^\s*(.*)/.exec(je.text)[1],g)}get allowsNesting(){return!1}}function Be(O,g,S,P,W){let K=S>=P&&S+g.length<=W&&g.prop(O.stateAfter);if(K)return{state:O.streamParser.copyState(K),pos:S+g.length};for(let U=g.children.length-1;U>=0;U--){let he=g.children[U],oe=S+g.positions[U],De=he instanceof p.mp&&oe<W&&Be(O,he,oe,P,W);if(De)return De}return null}function Ut(O,g,S,P,W){if(W&&S<=0&&P>=g.length)return g;!W&&g.type==O.topNode&&(W=!0);for(let K=g.children.length-1;K>=0;K--){let U=g.positions[K],he=g.children[K],oe;if(U<P&&he instanceof p.mp){if(!(oe=Ut(O,he,S-U,P-U,W)))break;return W?new p.mp(g.type,g.children.slice(0,K).concat(oe),g.positions.slice(0,K+1),U+oe.length):oe}}return null}function di(O,g,S,P){for(let W of g){let K=W.from+(W.openStart?25:0),U=W.to-(W.openEnd?25:0),he=K<=S&&U>S&&Be(O,W.tree,0-W.offset,S,U),oe;if(he&&(oe=Ut(O,W.tree,S+W.offset,he.pos+W.offset,!1)))return{state:he.state,tree:oe}}return{state:O.streamParser.startState(P?ei(P):4),tree:p.mp.empty}}class pi{constructor(g,S,P,W){this.lang=g,this.input=S,this.fragments=P,this.ranges=W,this.stoppedAt=null,this.chunks=[],this.chunkPos=[],this.chunk=[],this.chunkReused=void 0,this.rangeIndex=0,this.to=W[W.length-1].to;let K=bi.get(),U=W[0].from,{state:he,tree:oe}=di(g,P,U,K==null?void 0:K.state);this.state=he,this.parsedPos=this.chunkStart=U+oe.length;for(let De=0;De<oe.children.length;De++)this.chunks.push(oe.children[De]),this.chunkPos.push(oe.positions[De]);K&&this.parsedPos<K.viewport.from-1e5&&(this.state=this.lang.streamParser.startState(ei(K.state)),K.skipUntilInView(this.parsedPos,K.viewport.from),this.parsedPos=K.viewport.from),this.moveRangeIndex()}advance(){let g=bi.get(),S=this.stoppedAt==null?this.to:Math.min(this.to,this.stoppedAt),P=Math.min(S,this.chunkStart+2048);for(g&&(P=Math.min(P,g.viewport.to));this.parsedPos<P;)this.parseLine(g);return this.chunkStart<this.parsedPos&&this.finishChunk(),this.parsedPos>=S?this.finish():g&&this.parsedPos>=g.viewport.to?(g.skipUntilInView(this.parsedPos,S),this.finish()):null}stopAt(g){this.stoppedAt=g}lineAfter(g){let S=this.input.chunk(g);if(this.input.lineChunks)S==`
`&&(S="");else{let P=S.indexOf(`
`);P>-1&&(S=S.slice(0,P))}return g+S.length<=this.to?S:S.slice(0,this.to-g)}nextLine(){let g=this.parsedPos,S=this.lineAfter(g),P=g+S.length;for(let W=this.rangeIndex;;){let K=this.ranges[W].to;if(K>=P||(S=S.slice(0,K-(P-S.length)),W++,W==this.ranges.length))break;let U=this.ranges[W].from,he=this.lineAfter(U);S+=he,P=U+he.length}return{line:S,end:P}}skipGapsTo(g,S,P){for(;;){let W=this.ranges[this.rangeIndex].to,K=g+S;if(P>0?W>K:W>=K)break;let U=this.ranges[++this.rangeIndex].from;S+=U-W}return S}moveRangeIndex(){for(;this.ranges[this.rangeIndex].to<this.parsedPos;)this.rangeIndex++}emitToken(g,S,P,W,K){if(this.ranges.length>1){K=this.skipGapsTo(S,K,1),S+=K;let U=this.chunk.length;K=this.skipGapsTo(P,K,-1),P+=K,W+=this.chunk.length-U}return this.chunk.push(g,S,P,W),K}parseLine(g){let{line:S,end:P}=this.nextLine(),W=0,{streamParser:K}=this.lang,U=new j(S,g?g.state.tabSize:4,g?ei(g.state):2);if(U.eol())K.blankLine(this.state,U.indentUnit);else for(;!U.eol();){let he=zn(K.token,U,this.state);if(he&&(W=this.emitToken(this.lang.tokenTable.resolve(he),this.parsedPos+U.start,this.parsedPos+U.pos,4,W)),U.start>1e4)break}this.parsedPos=P,this.moveRangeIndex(),this.parsedPos<this.to&&this.parsedPos++}finishChunk(){let g=p.mp.build({buffer:this.chunk,start:this.chunkStart,length:this.parsedPos-this.chunkStart,nodeSet:Gt,topID:0,maxBufferLength:2048,reused:this.chunkReused});g=new p.mp(g.type,g.children,g.positions,g.length,[[this.lang.stateAfter,this.lang.streamParser.copyState(this.state)]]),this.chunks.push(g),this.chunkPos.push(this.chunkStart-this.ranges[0].from),this.chunk=[],this.chunkReused=void 0,this.chunkStart=this.parsedPos}finish(){return new p.mp(this.lang.topNode,this.chunks,this.chunkPos,this.parsedPos-this.ranges[0].from).balance()}}function zn(O,g,S){g.start=g.pos;for(let P=0;P<10;P++){let W=O(g,S);if(g.pos>g.start)return W}throw new Error("Stream parser failed to advance stream.")}const mn=Object.create(null),Pn=[p.Jq.none],Gt=new p.Lj(Pn),Rs=[],Bs=Object.create(null),qs=Object.create(null);for(let[O,g]of[["variable","variableName"],["variable-2","variableName.special"],["string-2","string.special"],["def","variableName.definition"],["tag","tagName"],["attribute","attributeName"],["type","typeName"],["builtin","variableName.standard"],["qualifier","modifier"],["error","invalid"],["header","heading"],["property","propertyName"]])qs[O]=An(mn,g);class vs{constructor(g){this.extra=g,this.table=Object.assign(Object.create(null),qs)}resolve(g){return g?this.table[g]||(this.table[g]=An(this.extra,g)):0}}const Ls=new vs(mn);function bs(O,g){Rs.indexOf(O)>-1||(Rs.push(O),console.warn(g))}function An(O,g){let S=[];for(let he of g.split(" ")){let oe=[];for(let De of he.split(".")){let je=O[De]||L.pJ[De];je?typeof je=="function"?oe.length?oe=oe.map(je):bs(De,`Modifier ${De} used at start of tag`):oe.length?bs(De,`Tag ${De} used as modifier`):oe=Array.isArray(je)?je:[je]:bs(De,`Unknown highlighting tag ${De}`)}for(let De of oe)S.push(De)}if(!S.length)return 0;let P=g.replace(/ /g,"_"),W=P+" "+S.map(he=>he.id),K=Bs[W];if(K)return K.id;let U=Bs[W]=p.Jq.define({id:Pn.length,name:P,props:[(0,L.Gv)({[P]:S})]});return Pn.push(U),U.id}function ss(O){let g=p.Jq.define({id:Pn.length,name:"Document",props:[Fe.add(()=>O)],top:!0});return Pn.push(g),g}},42123:(wn,Nt,q)=>{q.d(Nt,{r:()=>ue});var p=["true","false","on","off","yes","no"],we=new RegExp("\\b(("+p.join(")|(")+"))$","i");const ue={name:"yaml",token:function(L,G){var Se=L.peek(),Fe=G.escaped;if(G.escaped=!1,Se=="#"&&(L.pos==0||/\s/.test(L.string.charAt(L.pos-1))))return L.skipToEnd(),"comment";if(L.match(/^('([^']|\\.)*'?|"([^"]|\\.)*"?)/))return"string";if(G.literal&&L.indentation()>G.keyCol)return L.skipToEnd(),"string";if(G.literal&&(G.literal=!1),L.sol()){if(G.keyCol=0,G.pair=!1,G.pairStart=!1,L.match("---")||L.match("..."))return"def";if(L.match(/^\s*-\s+/))return"meta"}if(L.match(/^(\{|\}|\[|\])/))return Se=="{"?G.inlinePairs++:Se=="}"?G.inlinePairs--:Se=="["?G.inlineList++:G.inlineList--,"meta";if(G.inlineList>0&&!Fe&&Se==",")return L.next(),"meta";if(G.inlinePairs>0&&!Fe&&Se==",")return G.keyCol=0,G.pair=!1,G.pairStart=!1,L.next(),"meta";if(G.pairStart){if(L.match(/^\s*(\||\>)\s*/))return G.literal=!0,"meta";if(L.match(/^\s*(\&|\*)[a-z0-9\._-]+\b/i))return"variable";if(G.inlinePairs==0&&L.match(/^\s*-?[0-9\.\,]+\s?$/)||G.inlinePairs>0&&L.match(/^\s*-?[0-9\.\,]+\s?(?=(,|}))/))return"number";if(L.match(we))return"keyword"}return!G.pair&&L.match(/^\s*(?:[,\[\]{}&*!|>'"%@`][^\s'":]|[^,\[\]{}#&*!|>'"%@`])[^#]*?(?=\s*:($|\s))/)?(G.pair=!0,G.keyCol=L.indentation(),"atom"):G.pair&&L.match(/^:\s*/)?(G.pairStart=!0,"meta"):(G.pairStart=!1,G.escaped=Se=="\\",L.next(),null)},startState:function(){return{pair:!1,pairStart:!1,keyCol:0,inlinePairs:0,inlineList:0,literal:!1,escaped:!1}},languageData:{commentTokens:{line:"#"}}}},1727:(wn,Nt,q)=>{q.d(Nt,{BO:()=>gi,D0:()=>rt,Gz:()=>On,IS:()=>ns,Py:()=>$t,QQ:()=>Ft,Wl:()=>rn,Xs:()=>Lt,YW:()=>jt,as:()=>Dt,bg:()=>Et,cp:()=>Xt,f_:()=>Ni,gc:()=>Pt,gm:()=>fi,jT:()=>ae,n0:()=>Ot,nZ:()=>ui,q6:()=>dt,r$:()=>ke,uU:()=>hi,xv:()=>p,yy:()=>pt});class p{lineAt(a){if(a<0||a>this.length)throw new RangeError(`Invalid position ${a} in document of length ${this.length}`);return this.lineInner(a,!1,1,0)}line(a){if(a<1||a>this.lines)throw new RangeError(`Invalid line number ${a} in ${this.lines}-line document`);return this.lineInner(a,!0,1,0)}replace(a,d,v){[a,d]=Ze(this,a,d);let w=[];return this.decompose(0,a,w,2),v.length&&v.decompose(0,v.length,w,3),this.decompose(d,this.length,w,1),ue.from(w,this.length-(d-a)+v.length)}append(a){return this.replace(this.length,this.length,a)}slice(a,d=this.length){[a,d]=Ze(this,a,d);let v=[];return this.decompose(a,d,v,0),ue.from(v,d-a)}eq(a){if(a==this)return!0;if(a.length!=this.length||a.lines!=this.lines)return!1;let d=this.scanIdentical(a,1),v=this.length-this.scanIdentical(a,-1),w=new Fe(this),E=new Fe(a);for(let D=d,H=d;;){if(w.next(D),E.next(D),D=0,w.lineBreak!=E.lineBreak||w.done!=E.done||w.value!=E.value)return!1;if(H+=w.value.length,w.done||H>=v)return!0}}iter(a=1){return new Fe(this,a)}iterRange(a,d=this.length){return new bt(this,a,d)}iterLines(a,d){let v;if(a==null)v=this.iter();else{d==null&&(d=this.lines+1);let w=this.line(a).from;v=this.iterRange(w,Math.max(w,d==this.lines+1?this.length:d<=1?0:this.line(d-1).to))}return new ft(v)}toString(){return this.sliceString(0)}toJSON(){let a=[];return this.flatten(a),a}constructor(){}static of(a){if(a.length==0)throw new RangeError("A document must have at least one line");return a.length==1&&!a[0]?p.empty:a.length<=32?new we(a):ue.from(we.split(a,[]))}}class we extends p{constructor(a,d=L(a)){super(),this.text=a,this.length=d}get lines(){return this.text.length}get children(){return null}lineInner(a,d,v,w){for(let E=0;;E++){let D=this.text[E],H=w+D.length;if((d?v:H)>=a)return new xt(w,H,v,D);w=H+1,v++}}decompose(a,d,v,w){let E=a<=0&&d>=this.length?this:new we(Se(this.text,a,d),Math.min(d,this.length)-Math.max(0,a));if(w&1){let D=v.pop(),H=G(E.text,D.text.slice(),0,E.length);if(H.length<=32)v.push(new we(H,D.length+E.length));else{let j=H.length>>1;v.push(new we(H.slice(0,j)),new we(H.slice(j)))}}else v.push(E)}replace(a,d,v){if(!(v instanceof we))return super.replace(a,d,v);[a,d]=Ze(this,a,d);let w=G(this.text,G(v.text,Se(this.text,0,a)),d),E=this.length+v.length-(d-a);return w.length<=32?new we(w,E):ue.from(we.split(w,[]),E)}sliceString(a,d=this.length,v=`
`){[a,d]=Ze(this,a,d);let w="";for(let E=0,D=0;E<=d&&D<this.text.length;D++){let H=this.text[D],j=E+H.length;E>a&&D&&(w+=v),a<j&&d>E&&(w+=H.slice(Math.max(0,a-E),d-E)),E=j+1}return w}flatten(a){for(let d of this.text)a.push(d)}scanIdentical(){return 0}static split(a,d){let v=[],w=-1;for(let E of a)v.push(E),w+=E.length+1,v.length==32&&(d.push(new we(v,w)),v=[],w=-1);return w>-1&&d.push(new we(v,w)),d}}class ue extends p{constructor(a,d){super(),this.children=a,this.length=d,this.lines=0;for(let v of a)this.lines+=v.lines}lineInner(a,d,v,w){for(let E=0;;E++){let D=this.children[E],H=w+D.length,j=v+D.lines-1;if((d?j:H)>=a)return D.lineInner(a,d,v,w);w=H+1,v=j+1}}decompose(a,d,v,w){for(let E=0,D=0;D<=d&&E<this.children.length;E++){let H=this.children[E],j=D+H.length;if(a<=j&&d>=D){let ne=w&((D<=a?1:0)|(j>=d?2:0));D>=a&&j<=d&&!ne?v.push(H):H.decompose(a-D,d-D,v,ne)}D=j+1}}replace(a,d,v){if([a,d]=Ze(this,a,d),v.lines<this.lines)for(let w=0,E=0;w<this.children.length;w++){let D=this.children[w],H=E+D.length;if(a>=E&&d<=H){let j=D.replace(a-E,d-E,v),ne=this.lines-D.lines+j.lines;if(j.lines<ne>>5-1&&j.lines>ne>>5+1){let fe=this.children.slice();return fe[w]=j,new ue(fe,this.length-(d-a)+v.length)}return super.replace(E,H,j)}E=H+1}return super.replace(a,d,v)}sliceString(a,d=this.length,v=`
`){[a,d]=Ze(this,a,d);let w="";for(let E=0,D=0;E<this.children.length&&D<=d;E++){let H=this.children[E],j=D+H.length;D>a&&E&&(w+=v),a<j&&d>D&&(w+=H.sliceString(a-D,d-D,v)),D=j+1}return w}flatten(a){for(let d of this.children)d.flatten(a)}scanIdentical(a,d){if(!(a instanceof ue))return 0;let v=0,[w,E,D,H]=d>0?[0,0,this.children.length,a.children.length]:[this.children.length-1,a.children.length-1,-1,-1];for(;;w+=d,E+=d){if(w==D||E==H)return v;let j=this.children[w],ne=a.children[E];if(j!=ne)return v+j.scanIdentical(ne,d);v+=j.length+1}}static from(a,d=a.reduce((v,w)=>v+w.length+1,-1)){let v=0;for(let Be of a)v+=Be.lines;if(v<32){let Be=[];for(let Ut of a)Ut.flatten(Be);return new we(Be,d)}let w=Math.max(32,v>>5),E=w<<1,D=w>>1,H=[],j=0,ne=-1,fe=[];function ye(Be){let Ut;if(Be.lines>E&&Be instanceof ue)for(let di of Be.children)ye(di);else Be.lines>D&&(j>D||!j)?(Ne(),H.push(Be)):Be instanceof we&&j&&(Ut=fe[fe.length-1])instanceof we&&Be.lines+Ut.lines<=32?(j+=Be.lines,ne+=Be.length+1,fe[fe.length-1]=new we(Ut.text.concat(Be.text),Ut.length+1+Be.length)):(j+Be.lines>w&&Ne(),j+=Be.lines,ne+=Be.length+1,fe.push(Be))}function Ne(){j!=0&&(H.push(fe.length==1?fe[0]:ue.from(fe,ne)),ne=-1,j=fe.length=0)}for(let Be of a)ye(Be);return Ne(),H.length==1?H[0]:new ue(H,d)}}p.empty=new we([""],0);function L(R){let a=-1;for(let d of R)a+=d.length+1;return a}function G(R,a,d=0,v=1e9){for(let w=0,E=0,D=!0;E<R.length&&w<=v;E++){let H=R[E],j=w+H.length;j>=d&&(j>v&&(H=H.slice(0,v-w)),w<d&&(H=H.slice(d-w)),D?(a[a.length-1]+=H,D=!1):a.push(H)),w=j+1}return a}function Se(R,a,d){return G(R,[""],a,d)}class Fe{constructor(a,d=1){this.dir=d,this.done=!1,this.lineBreak=!1,this.value="",this.nodes=[a],this.offsets=[d>0?1:(a instanceof we?a.text.length:a.children.length)<<1]}nextInner(a,d){for(this.done=this.lineBreak=!1;;){let v=this.nodes.length-1,w=this.nodes[v],E=this.offsets[v],D=E>>1,H=w instanceof we?w.text.length:w.children.length;if(D==(d>0?H:0)){if(v==0)return this.done=!0,this.value="",this;d>0&&this.offsets[v-1]++,this.nodes.pop(),this.offsets.pop()}else if((E&1)==(d>0?0:1)){if(this.offsets[v]+=d,a==0)return this.lineBreak=!0,this.value=`
`,this;a--}else if(w instanceof we){let j=w.text[D+(d<0?-1:0)];if(this.offsets[v]+=d,j.length>Math.max(0,a))return this.value=a==0?j:d>0?j.slice(a):j.slice(0,j.length-a),this;a-=j.length}else{let j=w.children[D+(d<0?-1:0)];a>j.length?(a-=j.length,this.offsets[v]+=d):(d<0&&this.offsets[v]--,this.nodes.push(j),this.offsets.push(d>0?1:(j instanceof we?j.text.length:j.children.length)<<1))}}}next(a=0){return a<0&&(this.nextInner(-a,-this.dir),a=this.value.length),this.nextInner(a,this.dir)}}class bt{constructor(a,d,v){this.value="",this.done=!1,this.cursor=new Fe(a,d>v?-1:1),this.pos=d>v?a.length:0,this.from=Math.min(d,v),this.to=Math.max(d,v)}nextInner(a,d){if(d<0?this.pos<=this.from:this.pos>=this.to)return this.value="",this.done=!0,this;a+=Math.max(0,d<0?this.pos-this.to:this.from-this.pos);let v=d<0?this.pos-this.from:this.to-this.pos;a>v&&(a=v),v-=a;let{value:w}=this.cursor.next(a);return this.pos+=(w.length+a)*d,this.value=w.length<=v?w:d<0?w.slice(w.length-v):w.slice(0,v),this.done=!this.value,this}next(a=0){return a<0?a=Math.max(a,this.from-this.pos):a>0&&(a=Math.min(a,this.to-this.pos)),this.nextInner(a,this.cursor.dir)}get lineBreak(){return this.cursor.lineBreak&&this.value!=""}}class ft{constructor(a){this.inner=a,this.afterBreak=!0,this.value="",this.done=!1}next(a=0){let{done:d,lineBreak:v,value:w}=this.inner.next(a);return d&&this.afterBreak?(this.value="",this.afterBreak=!1):d?(this.done=!0,this.value=""):v?this.afterBreak?this.value="":(this.afterBreak=!0,this.next()):(this.value=w,this.afterBreak=!1),this}get lineBreak(){return!1}}typeof Symbol!="undefined"&&(p.prototype[Symbol.iterator]=function(){return this.iter()},Fe.prototype[Symbol.iterator]=bt.prototype[Symbol.iterator]=ft.prototype[Symbol.iterator]=function(){return this});class xt{constructor(a,d,v,w){this.from=a,this.to=d,this.number=v,this.text=w}get length(){return this.to-this.from}}function Ze(R,a,d){return a=Math.max(0,Math.min(R.length,a)),[a,Math.max(a,Math.min(R.length,d))]}let nt="lc,34,7n,7,7b,19,,,,2,,2,,,20,b,1c,l,g,,2t,7,2,6,2,2,,4,z,,u,r,2j,b,1m,9,9,,o,4,,9,,3,,5,17,3,3b,f,,w,1j,,,,4,8,4,,3,7,a,2,t,,1m,,,,2,4,8,,9,,a,2,q,,2,2,1l,,4,2,4,2,2,3,3,,u,2,3,,b,2,1l,,4,5,,2,4,,k,2,m,6,,,1m,,,2,,4,8,,7,3,a,2,u,,1n,,,,c,,9,,14,,3,,1l,3,5,3,,4,7,2,b,2,t,,1m,,2,,2,,3,,5,2,7,2,b,2,s,2,1l,2,,,2,4,8,,9,,a,2,t,,20,,4,,2,3,,,8,,29,,2,7,c,8,2q,,2,9,b,6,22,2,r,,,,,,1j,e,,5,,2,5,b,,10,9,,2u,4,,6,,2,2,2,p,2,4,3,g,4,d,,2,2,6,,f,,jj,3,qa,3,t,3,t,2,u,2,1s,2,,7,8,,2,b,9,,19,3,3b,2,y,,3a,3,4,2,9,,6,3,63,2,2,,1m,,,7,,,,,2,8,6,a,2,,1c,h,1r,4,1c,7,,,5,,14,9,c,2,w,4,2,2,,3,1k,,,2,3,,,3,1m,8,2,2,48,3,,d,,7,4,,6,,3,2,5i,1m,,5,ek,,5f,x,2da,3,3x,,2o,w,fe,6,2x,2,n9w,4,,a,w,2,28,2,7k,,3,,4,,p,2,5,,47,2,q,i,d,,12,8,p,b,1a,3,1c,,2,4,2,2,13,,1v,6,2,2,2,2,c,,8,,1b,,1f,,,3,2,2,5,2,,,16,2,8,,6m,,2,,4,,fn4,,kh,g,g,g,a6,2,gt,,6a,,45,5,1ae,3,,2,5,4,14,3,4,,4l,2,fx,4,ar,2,49,b,4w,,1i,f,1k,3,1d,4,2,2,1x,3,10,5,,8,1q,,c,2,1g,9,a,4,2,,2n,3,2,,,2,6,,4g,,3,8,l,2,1l,2,,,,,m,,e,7,3,5,5f,8,2,3,,,n,,29,,2,6,,,2,,,2,,2,6j,,2,4,6,2,,2,r,2,2d,8,2,,,2,2y,,,,2,6,,,2t,3,2,4,,5,77,9,,2,6t,,a,2,,,4,,40,4,2,2,4,,w,a,14,6,2,4,8,,9,6,2,3,1a,d,,2,ba,7,,6,,,2a,m,2,7,,2,,2,3e,6,3,,,2,,7,,,20,2,3,,,,9n,2,f0b,5,1n,7,t4,,1r,4,29,,f5k,2,43q,,,3,4,5,8,8,2,7,u,4,44,3,1iz,1j,4,1e,8,,e,,m,5,,f,11s,7,,h,2,7,,2,,5,79,7,c5,4,15s,7,31,7,240,5,gx7k,2o,3k,6o".split(",").map(R=>R?parseInt(R,36):1);for(let R=1;R<nt.length;R++)nt[R]+=nt[R-1];function _e(R){for(let a=1;a<nt.length;a+=2)if(nt[a]>R)return nt[a-1]<=R;return!1}function mt(R){return R>=127462&&R<=127487}const mi=8205;function Xt(R,a,d=!0,v=!0){return(d?me:ut)(R,a,v)}function me(R,a,d){if(a==R.length)return a;a&&Kt(R.charCodeAt(a))&&bi(R.charCodeAt(a-1))&&a--;let v=fi(R,a);for(a+=ui(v);a<R.length;){let w=fi(R,a);if(v==mi||w==mi||d&&_e(w))a+=ui(w),v=w;else if(mt(w)){let E=0,D=a-2;for(;D>=0&&mt(fi(R,D));)E++,D-=2;if(E%2==0)break;a+=2}else break}return a}function ut(R,a,d){for(;a>0;){let v=me(R,a-2,d);if(v<a)return v;a--}return 0}function Kt(R){return R>=56320&&R<57344}function bi(R){return R>=55296&&R<56320}function fi(R,a){let d=R.charCodeAt(a);if(!bi(d)||a+1==R.length)return d;let v=R.charCodeAt(a+1);return Kt(v)?(d-55296<<10)+(v-56320)+65536:d}function Et(R){return R<=65535?String.fromCharCode(R):(R-=65536,String.fromCharCode((R>>10)+55296,(R&1023)+56320))}function ui(R){return R<65536?1:2}const Oi=/\r\n?|\n/;var Pt=function(R){return R[R.Simple=0]="Simple",R[R.TrackDel=1]="TrackDel",R[R.TrackBefore=2]="TrackBefore",R[R.TrackAfter=3]="TrackAfter",R}(Pt||(Pt={}));class Ot{constructor(a){this.sections=a}get length(){let a=0;for(let d=0;d<this.sections.length;d+=2)a+=this.sections[d];return a}get newLength(){let a=0;for(let d=0;d<this.sections.length;d+=2){let v=this.sections[d+1];a+=v<0?this.sections[d]:v}return a}get empty(){return this.sections.length==0||this.sections.length==2&&this.sections[1]<0}iterGaps(a){for(let d=0,v=0,w=0;d<this.sections.length;){let E=this.sections[d++],D=this.sections[d++];D<0?(a(v,w,E),w+=E):w+=D,v+=E}}iterChangedRanges(a,d=!1){_t(this,a,d)}get invertedDesc(){let a=[];for(let d=0;d<this.sections.length;){let v=this.sections[d++],w=this.sections[d++];w<0?a.push(v,w):a.push(w,v)}return new Ot(a)}composeDesc(a){return this.empty?a:a.empty?this:Ge(this,a)}mapDesc(a,d=!1){return a.empty?this:ei(this,a,d)}mapPos(a,d=-1,v=Pt.Simple){let w=0,E=0;for(let D=0;D<this.sections.length;){let H=this.sections[D++],j=this.sections[D++],ne=w+H;if(j<0){if(ne>a)return E+(a-w);E+=H}else{if(v!=Pt.Simple&&ne>=a&&(v==Pt.TrackDel&&w<a&&ne>a||v==Pt.TrackBefore&&w<a||v==Pt.TrackAfter&&ne>a))return null;if(ne>a||ne==a&&d<0&&!H)return a==w||d<0?E:E+j;E+=j}w=ne}if(a>w)throw new RangeError(`Position ${a} is out of range for changeset of length ${w}`);return E}touchesRange(a,d=a){for(let v=0,w=0;v<this.sections.length&&w<=d;){let E=this.sections[v++],D=this.sections[v++],H=w+E;if(D>=0&&w<=d&&H>=a)return w<a&&H>d?"cover":!0;w=H}return!1}toString(){let a="";for(let d=0;d<this.sections.length;){let v=this.sections[d++],w=this.sections[d++];a+=(a?" ":"")+v+(w>=0?":"+w:"")}return a}toJSON(){return this.sections}static fromJSON(a){if(!Array.isArray(a)||a.length%2||a.some(d=>typeof d!="number"))throw new RangeError("Invalid JSON representation of ChangeDesc");return new Ot(a)}static create(a){return new Ot(a)}}class Dt extends Ot{constructor(a,d){super(a),this.inserted=d}apply(a){if(this.length!=a.length)throw new RangeError("Applying change set to a document with the wrong length");return _t(this,(d,v,w,E,D)=>a=a.replace(w,w+(v-d),D),!1),a}mapDesc(a,d=!1){return ei(this,a,d,!0)}invert(a){let d=this.sections.slice(),v=[];for(let w=0,E=0;w<d.length;w+=2){let D=d[w],H=d[w+1];if(H>=0){d[w]=H,d[w+1]=D;let j=w>>1;for(;v.length<j;)v.push(p.empty);v.push(D?a.slice(E,E+D):p.empty)}E+=D}return new Dt(d,v)}compose(a){return this.empty?a:a.empty?this:Ge(this,a,!0)}map(a,d=!1){return a.empty?this:ei(this,a,d,!0)}iterChanges(a,d=!1){_t(this,a,d)}get desc(){return Ot.create(this.sections)}filter(a){let d=[],v=[],w=[],E=new Mi(this);e:for(let D=0,H=0;;){let j=D==a.length?1e9:a[D++];for(;H<j||H==j&&E.len==0;){if(E.done)break e;let fe=Math.min(E.len,j-H);wt(w,fe,-1);let ye=E.ins==-1?-1:E.off==0?E.ins:0;wt(d,fe,ye),ye>0&&ai(v,d,E.text),E.forward(fe),H+=fe}let ne=a[D++];for(;H<ne;){if(E.done)break e;let fe=Math.min(E.len,ne-H);wt(d,fe,-1),wt(w,fe,E.ins==-1?-1:E.off==0?E.ins:0),E.forward(fe),H+=fe}}return{changes:new Dt(d,v),filtered:Ot.create(w)}}toJSON(){let a=[];for(let d=0;d<this.sections.length;d+=2){let v=this.sections[d],w=this.sections[d+1];w<0?a.push(v):w==0?a.push([v]):a.push([v].concat(this.inserted[d>>1].toJSON()))}return a}static of(a,d,v){let w=[],E=[],D=0,H=null;function j(fe=!1){if(!fe&&!w.length)return;D<d&&wt(w,d-D,-1);let ye=new Dt(w,E);H=H?H.compose(ye.map(H)):ye,w=[],E=[],D=0}function ne(fe){if(Array.isArray(fe))for(let ye of fe)ne(ye);else if(fe instanceof Dt){if(fe.length!=d)throw new RangeError(`Mismatched change set length (got ${fe.length}, expected ${d})`);j(),H=H?H.compose(fe.map(H)):fe}else{let{from:ye,to:Ne=ye,insert:Be}=fe;if(ye>Ne||ye<0||Ne>d)throw new RangeError(`Invalid change range ${ye} to ${Ne} (in doc of length ${d})`);let Ut=Be?typeof Be=="string"?p.of(Be.split(v||Oi)):Be:p.empty,di=Ut.length;if(ye==Ne&&di==0)return;ye<D&&j(),ye>D&&wt(w,ye-D,-1),wt(w,Ne-ye,di),ai(E,w,Ut),D=Ne}}return ne(a),j(!H),H}static empty(a){return new Dt(a?[a,-1]:[],[])}static fromJSON(a){if(!Array.isArray(a))throw new RangeError("Invalid JSON representation of ChangeSet");let d=[],v=[];for(let w=0;w<a.length;w++){let E=a[w];if(typeof E=="number")d.push(E,-1);else{if(!Array.isArray(E)||typeof E[0]!="number"||E.some((D,H)=>H&&typeof D!="string"))throw new RangeError("Invalid JSON representation of ChangeSet");if(E.length==1)d.push(E[0],0);else{for(;v.length<w;)v.push(p.empty);v[w]=p.of(E.slice(1)),d.push(E[0],v[w].length)}}}return new Dt(d,v)}static createSet(a,d){return new Dt(a,d)}}function wt(R,a,d,v=!1){if(a==0&&d<=0)return;let w=R.length-2;w>=0&&d<=0&&d==R[w+1]?R[w]+=a:a==0&&R[w]==0?R[w+1]+=d:v?(R[w]+=a,R[w+1]+=d):R.push(a,d)}function ai(R,a,d){if(d.length==0)return;let v=a.length-2>>1;if(v<R.length)R[R.length-1]=R[R.length-1].append(d);else{for(;R.length<v;)R.push(p.empty);R.push(d)}}function _t(R,a,d){let v=R.inserted;for(let w=0,E=0,D=0;D<R.sections.length;){let H=R.sections[D++],j=R.sections[D++];if(j<0)w+=H,E+=H;else{let ne=w,fe=E,ye=p.empty;for(;ne+=H,fe+=j,j&&v&&(ye=ye.append(v[D-2>>1])),!(d||D==R.sections.length||R.sections[D+1]<0);)H=R.sections[D++],j=R.sections[D++];a(w,ne,E,fe,ye),w=ne,E=fe}}}function ei(R,a,d,v=!1){let w=[],E=v?[]:null,D=new Mi(R),H=new Mi(a);for(let j=-1;;)if(D.ins==-1&&H.ins==-1){let ne=Math.min(D.len,H.len);wt(w,ne,-1),D.forward(ne),H.forward(ne)}else if(H.ins>=0&&(D.ins<0||j==D.i||D.off==0&&(H.len<D.len||H.len==D.len&&!d))){let ne=H.len;for(wt(w,H.ins,-1);ne;){let fe=Math.min(D.len,ne);D.ins>=0&&j<D.i&&D.len<=fe&&(wt(w,0,D.ins),E&&ai(E,w,D.text),j=D.i),D.forward(fe),ne-=fe}H.next()}else if(D.ins>=0){let ne=0,fe=D.len;for(;fe;)if(H.ins==-1){let ye=Math.min(fe,H.len);ne+=ye,fe-=ye,H.forward(ye)}else if(H.ins==0&&H.len<fe)fe-=H.len,H.next();else break;wt(w,ne,j<D.i?D.ins:0),E&&j<D.i&&ai(E,w,D.text),j=D.i,D.forward(D.len-fe)}else{if(D.done&&H.done)return E?Dt.createSet(w,E):Ot.create(w);throw new Error("Mismatched change set lengths")}}function Ge(R,a,d=!1){let v=[],w=d?[]:null,E=new Mi(R),D=new Mi(a);for(let H=!1;;){if(E.done&&D.done)return w?Dt.createSet(v,w):Ot.create(v);if(E.ins==0)wt(v,E.len,0,H),E.next();else if(D.len==0&&!D.done)wt(v,0,D.ins,H),w&&ai(w,v,D.text),D.next();else{if(E.done||D.done)throw new Error("Mismatched change set lengths");{let j=Math.min(E.len2,D.len),ne=v.length;if(E.ins==-1){let fe=D.ins==-1?-1:D.off?0:D.ins;wt(v,j,fe,H),w&&fe&&ai(w,v,D.text)}else D.ins==-1?(wt(v,E.off?0:E.len,j,H),w&&ai(w,v,E.textBit(j))):(wt(v,E.off?0:E.len,D.off?0:D.ins,H),w&&!D.off&&ai(w,v,D.text));H=(E.ins>j||D.ins>=0&&D.len>j)&&(H||v.length>ne),E.forward2(j),D.forward(j)}}}}class Mi{constructor(a){this.set=a,this.i=0,this.next()}next(){let{sections:a}=this.set;this.i<a.length?(this.len=a[this.i++],this.ins=a[this.i++]):(this.len=0,this.ins=-2),this.off=0}get done(){return this.ins==-2}get len2(){return this.ins<0?this.len:this.ins}get text(){let{inserted:a}=this.set,d=this.i-2>>1;return d>=a.length?p.empty:a[d]}textBit(a){let{inserted:d}=this.set,v=this.i-2>>1;return v>=d.length&&!a?p.empty:d[v].slice(this.off,a==null?void 0:this.off+a)}forward(a){a==this.len?this.next():(this.len-=a,this.off+=a)}forward2(a){this.ins==-1?this.forward(a):a==this.ins?this.next():(this.ins-=a,this.off+=a)}}class Xe{constructor(a,d,v){this.from=a,this.to=d,this.flags=v}get anchor(){return this.flags&32?this.to:this.from}get head(){return this.flags&32?this.from:this.to}get empty(){return this.from==this.to}get assoc(){return this.flags&8?-1:this.flags&16?1:0}get bidiLevel(){let a=this.flags&7;return a==7?null:a}get goalColumn(){let a=this.flags>>6;return a==16777215?void 0:a}map(a,d=-1){let v,w;return this.empty?v=w=a.mapPos(this.from,d):(v=a.mapPos(this.from,1),w=a.mapPos(this.to,-1)),v==this.from&&w==this.to?this:new Xe(v,w,this.flags)}extend(a,d=a){if(a<=this.anchor&&d>=this.anchor)return ae.range(a,d);let v=Math.abs(a-this.anchor)>Math.abs(d-this.anchor)?a:d;return ae.range(this.anchor,v)}eq(a){return this.anchor==a.anchor&&this.head==a.head}toJSON(){return{anchor:this.anchor,head:this.head}}static fromJSON(a){if(!a||typeof a.anchor!="number"||typeof a.head!="number")throw new RangeError("Invalid JSON representation for SelectionRange");return ae.range(a.anchor,a.head)}static create(a,d,v){return new Xe(a,d,v)}}class ae{constructor(a,d){this.ranges=a,this.mainIndex=d}map(a,d=-1){return a.empty?this:ae.create(this.ranges.map(v=>v.map(a,d)),this.mainIndex)}eq(a){if(this.ranges.length!=a.ranges.length||this.mainIndex!=a.mainIndex)return!1;for(let d=0;d<this.ranges.length;d++)if(!this.ranges[d].eq(a.ranges[d]))return!1;return!0}get main(){return this.ranges[this.mainIndex]}asSingle(){return this.ranges.length==1?this:new ae([this.main],0)}addRange(a,d=!0){return ae.create([a].concat(this.ranges),d?0:this.mainIndex+1)}replaceRange(a,d=this.mainIndex){let v=this.ranges.slice();return v[d]=a,ae.create(v,this.mainIndex)}toJSON(){return{ranges:this.ranges.map(a=>a.toJSON()),main:this.mainIndex}}static fromJSON(a){if(!a||!Array.isArray(a.ranges)||typeof a.main!="number"||a.main>=a.ranges.length)throw new RangeError("Invalid JSON representation for EditorSelection");return new ae(a.ranges.map(d=>Xe.fromJSON(d)),a.main)}static single(a,d=a){return new ae([ae.range(a,d)],0)}static create(a,d=0){if(a.length==0)throw new RangeError("A selection needs at least one range");for(let v=0,w=0;w<a.length;w++){let E=a[w];if(E.empty?E.from<=v:E.from<v)return ae.normalized(a.slice(),d);v=E.to}return new ae(a,d)}static cursor(a,d=0,v,w){return Xe.create(a,a,(d==0?0:d<0?8:16)|(v==null?7:Math.min(6,v))|(w!=null?w:16777215)<<6)}static range(a,d,v,w){let E=(v!=null?v:16777215)<<6|(w==null?7:Math.min(6,w));return d<a?Xe.create(d,a,48|E):Xe.create(a,d,(d>a?8:0)|E)}static normalized(a,d=0){let v=a[d];a.sort((w,E)=>w.from-E.from),d=a.indexOf(v);for(let w=1;w<a.length;w++){let E=a[w],D=a[w-1];if(E.empty?E.from<=D.to:E.from<D.to){let H=D.from,j=Math.max(E.to,D.to);w<=d&&d--,a.splice(--w,2,E.anchor>E.head?ae.range(j,H):ae.range(H,j))}}return new ae(a,d)}}function be(R,a){for(let d of R.ranges)if(d.to>a)throw new RangeError("Selection points outside of document")}let ze=0;class ke{constructor(a,d,v,w,E){this.combine=a,this.compareInput=d,this.compare=v,this.isStatic=w,this.id=ze++,this.default=a([]),this.extensions=typeof E=="function"?E(this):E}get reader(){return this}static define(a={}){return new ke(a.combine||(d=>d),a.compareInput||((d,v)=>d===v),a.compare||(a.combine?(d,v)=>d===v:Ee),!!a.static,a.enables)}of(a){return new zt([],this,0,a)}compute(a,d){if(this.isStatic)throw new Error("Can't compute a static facet");return new zt(a,this,1,d)}computeN(a,d){if(this.isStatic)throw new Error("Can't compute a static facet");return new zt(a,this,2,d)}from(a,d){return d||(d=v=>v),this.compute([a],v=>d(v.field(a)))}}function Ee(R,a){return R==a||R.length==a.length&&R.every((d,v)=>d===a[v])}class zt{constructor(a,d,v,w){this.dependencies=a,this.facet=d,this.type=v,this.value=w,this.id=ze++}dynamicSlot(a){var d;let v=this.value,w=this.facet.compareInput,E=this.id,D=a[E]>>1,H=this.type==2,j=!1,ne=!1,fe=[];for(let ye of this.dependencies)ye=="doc"?j=!0:ye=="selection"?ne=!0:((d=a[ye.id])!==null&&d!==void 0?d:1)&1||fe.push(a[ye.id]);return{create(ye){return ye.values[D]=v(ye),1},update(ye,Ne){if(j&&Ne.docChanged||ne&&(Ne.docChanged||Ne.selection)||Yt(ye,fe)){let Be=v(ye);if(H?!Le(Be,ye.values[D],w):!w(Be,ye.values[D]))return ye.values[D]=Be,1}return 0},reconfigure:(ye,Ne)=>{let Be,Ut=Ne.config.address[E];if(Ut!=null){let di=Z(Ne,Ut);if(this.dependencies.every(pi=>pi instanceof ke?Ne.facet(pi)===ye.facet(pi):pi instanceof Ft?Ne.field(pi,!1)==ye.field(pi,!1):!0)||(H?Le(Be=v(ye),di,w):w(Be=v(ye),di)))return ye.values[D]=di,0}else Be=v(ye);return ye.values[D]=Be,1}}}}function Le(R,a,d){if(R.length!=a.length)return!1;for(let v=0;v<R.length;v++)if(!d(R[v],a[v]))return!1;return!0}function Yt(R,a){let d=!1;for(let v of a)N(R,v)&1&&(d=!0);return d}function et(R,a,d){let v=d.map(j=>R[j.id]),w=d.map(j=>j.type),E=v.filter(j=>!(j&1)),D=R[a.id]>>1;function H(j){let ne=[];for(let fe=0;fe<v.length;fe++){let ye=Z(j,v[fe]);if(w[fe]==2)for(let Ne of ye)ne.push(Ne);else ne.push(ye)}return a.combine(ne)}return{create(j){for(let ne of v)N(j,ne);return j.values[D]=H(j),1},update(j,ne){if(!Yt(j,E))return 0;let fe=H(j);return a.compare(fe,j.values[D])?0:(j.values[D]=fe,1)},reconfigure(j,ne){let fe=Yt(j,v),ye=ne.config.facets[a.id],Ne=ne.facet(a);if(ye&&!fe&&Ee(d,ye))return j.values[D]=Ne,0;let Be=H(j);return a.compare(Be,Ne)?(j.values[D]=Ne,0):(j.values[D]=Be,1)}}}const Pi=ke.define({static:!0});class Ft{constructor(a,d,v,w,E){this.id=a,this.createF=d,this.updateF=v,this.compareF=w,this.spec=E,this.provides=void 0}static define(a){let d=new Ft(ze++,a.create,a.update,a.compare||((v,w)=>v===w),a);return a.provide&&(d.provides=a.provide(d)),d}create(a){let d=a.facet(Pi).find(v=>v.field==this);return((d==null?void 0:d.create)||this.createF)(a)}slot(a){let d=a[this.id]>>1;return{create:v=>(v.values[d]=this.create(v),1),update:(v,w)=>{let E=v.values[d],D=this.updateF(E,w);return this.compareF(E,D)?0:(v.values[d]=D,1)},reconfigure:(v,w)=>w.config.address[this.id]!=null?(v.values[d]=w.field(this),0):(v.values[d]=this.create(v),1)}}init(a){return[this,Pi.of({field:this,create:a})]}get extension(){return this}}const gt={lowest:4,low:3,default:2,high:1,highest:0};function si(R){return a=>new Zi(a,R)}const rn={highest:si(gt.highest),high:si(gt.high),default:si(gt.default),low:si(gt.low),lowest:si(gt.lowest)};class Zi{constructor(a,d){this.inner=a,this.prec=d}}class te{of(a){return new x(this,a)}reconfigure(a){return te.reconfigure.of({compartment:this,extension:a})}get(a){return a.config.compartments.get(this)}}class x{constructor(a,d){this.compartment=a,this.inner=d}}class C{constructor(a,d,v,w,E,D){for(this.base=a,this.compartments=d,this.dynamicSlots=v,this.address=w,this.staticValues=E,this.facets=D,this.statusTemplate=[];this.statusTemplate.length<v.length;)this.statusTemplate.push(0)}staticFacet(a){let d=this.address[a.id];return d==null?a.default:this.staticValues[d>>1]}static resolve(a,d,v){let w=[],E=Object.create(null),D=new Map;for(let Ne of I(a,d,D))Ne instanceof Ft?w.push(Ne):(E[Ne.facet.id]||(E[Ne.facet.id]=[])).push(Ne);let H=Object.create(null),j=[],ne=[];for(let Ne of w)H[Ne.id]=ne.length<<1,ne.push(Be=>Ne.slot(Be));let fe=v==null?void 0:v.config.facets;for(let Ne in E){let Be=E[Ne],Ut=Be[0].facet,di=fe&&fe[Ne]||[];if(Be.every(pi=>pi.type==0))if(H[Ut.id]=j.length<<1|1,Ee(di,Be))j.push(v.facet(Ut));else{let pi=Ut.combine(Be.map(zn=>zn.value));j.push(v&&Ut.compare(pi,v.facet(Ut))?v.facet(Ut):pi)}else{for(let pi of Be)pi.type==0?(H[pi.id]=j.length<<1|1,j.push(pi.value)):(H[pi.id]=ne.length<<1,ne.push(zn=>pi.dynamicSlot(zn)));H[Ut.id]=ne.length<<1,ne.push(pi=>et(pi,Ut,Be))}}let ye=ne.map(Ne=>Ne(H));return new C(a,D,ye,H,j,E)}}function I(R,a,d){let v=[[],[],[],[],[]],w=new Map;function E(D,H){let j=w.get(D);if(j!=null){if(j<=H)return;let ne=v[j].indexOf(D);ne>-1&&v[j].splice(ne,1),D instanceof x&&d.delete(D.compartment)}if(w.set(D,H),Array.isArray(D))for(let ne of D)E(ne,H);else if(D instanceof x){if(d.has(D.compartment))throw new RangeError("Duplicate use of compartment in extensions");let ne=a.get(D.compartment)||D.inner;d.set(D.compartment,ne),E(ne,H)}else if(D instanceof Zi)E(D.inner,D.prec);else if(D instanceof Ft)v[H].push(D),D.provides&&E(D.provides,H);else if(D instanceof zt)v[H].push(D),D.facet.extensions&&E(D.facet.extensions,gt.default);else{let ne=D.extension;if(!ne)throw new Error(`Unrecognized extension value in extension set (${D}). This sometimes happens because multiple instances of @codemirror/state are loaded, breaking instanceof checks.`);E(ne,H)}}return E(R,gt.default),v.reduce((D,H)=>D.concat(H))}function N(R,a){if(a&1)return 2;let d=a>>1,v=R.status[d];if(v==4)throw new Error("Cyclic dependency between fields and/or facets");if(v&2)return v;R.status[d]=4;let w=R.computeSlot(R,R.config.dynamicSlots[d]);return R.status[d]=2|w}function Z(R,a){return a&1?R.config.staticValues[a>>1]:R.values[a>>1]}const ee=ke.define(),re=ke.define({combine:R=>R.some(a=>a),static:!0}),xe=ke.define({combine:R=>R.length?R[0]:void 0,static:!0}),He=ke.define(),Pe=ke.define(),Qe=ke.define(),tt=ke.define({combine:R=>R.length?R[0]:!1});class dt{constructor(a,d){this.type=a,this.value=d}static define(){return new ti}}class ti{of(a){return new dt(this,a)}}class qt{constructor(a){this.map=a}of(a){return new $t(this,a)}}class $t{constructor(a,d){this.type=a,this.value=d}map(a){let d=this.type.map(this.value,a);return d===void 0?void 0:d==this.value?this:new $t(this.type,d)}is(a){return this.type==a}static define(a={}){return new qt(a.map||(d=>d))}static mapEffects(a,d){if(!a.length)return a;let v=[];for(let w of a){let E=w.map(d);E&&v.push(E)}return v}}$t.reconfigure=$t.define(),$t.appendConfig=$t.define();class jt{constructor(a,d,v,w,E,D){this.startState=a,this.changes=d,this.selection=v,this.effects=w,this.annotations=E,this.scrollIntoView=D,this._doc=null,this._state=null,v&&be(v,d.newLength),E.some(H=>H.type==jt.time)||(this.annotations=E.concat(jt.time.of(Date.now())))}static create(a,d,v,w,E,D){return new jt(a,d,v,w,E,D)}get newDoc(){return this._doc||(this._doc=this.changes.apply(this.startState.doc))}get newSelection(){return this.selection||this.startState.selection.map(this.changes)}get state(){return this._state||this.startState.applyTransaction(this),this._state}annotation(a){for(let d of this.annotations)if(d.type==a)return d.value}get docChanged(){return!this.changes.empty}get reconfigured(){return this.startState.config!=this.state.config}isUserEvent(a){let d=this.annotation(jt.userEvent);return!!(d&&(d==a||d.length>a.length&&d.slice(0,a.length)==a&&d[a.length]=="."))}}jt.time=dt.define(),jt.userEvent=dt.define(),jt.addToHistory=dt.define(),jt.remote=dt.define();function Ct(R,a){let d=[];for(let v=0,w=0;;){let E,D;if(v<R.length&&(w==a.length||a[w]>=R[v]))E=R[v++],D=R[v++];else if(w<a.length)E=a[w++],D=a[w++];else return d;!d.length||d[d.length-1]<E?d.push(E,D):d[d.length-1]<D&&(d[d.length-1]=D)}}function Rt(R,a,d){var v;let w,E,D;return d?(w=a.changes,E=Dt.empty(a.changes.length),D=R.changes.compose(a.changes)):(w=a.changes.map(R.changes),E=R.changes.mapDesc(a.changes,!0),D=R.changes.compose(w)),{changes:D,selection:a.selection?a.selection.map(E):(v=R.selection)===null||v===void 0?void 0:v.map(w),effects:$t.mapEffects(R.effects,w).concat($t.mapEffects(a.effects,E)),annotations:R.annotations.length?R.annotations.concat(a.annotations):a.annotations,scrollIntoView:R.scrollIntoView||a.scrollIntoView}}function xi(R,a,d){let v=a.selection,w=ot(a.annotations);return a.userEvent&&(w=w.concat(jt.userEvent.of(a.userEvent))),{changes:a.changes instanceof Dt?a.changes:Dt.of(a.changes||[],d,R.facet(xe)),selection:v&&(v instanceof ae?v:ae.single(v.anchor,v.head)),effects:ot(a.effects),annotations:w,scrollIntoView:!!a.scrollIntoView}}function st(R,a,d){let v=xi(R,a.length?a[0]:{},R.doc.length);a.length&&a[0].filter===!1&&(d=!1);for(let E=1;E<a.length;E++){a[E].filter===!1&&(d=!1);let D=!!a[E].sequential;v=Rt(v,xi(R,a[E],D?v.changes.newLength:R.doc.length),D)}let w=jt.create(R,v.changes,v.selection,v.effects,v.annotations,v.scrollIntoView);return Ve(d?Ye(w):w)}function Ye(R){let a=R.startState,d=!0;for(let w of a.facet(He)){let E=w(R);if(E===!1){d=!1;break}Array.isArray(E)&&(d=d===!0?E:Ct(d,E))}if(d!==!0){let w,E;if(d===!1)E=R.changes.invertedDesc,w=Dt.empty(a.doc.length);else{let D=R.changes.filter(d);w=D.changes,E=D.filtered.mapDesc(D.changes).invertedDesc}R=jt.create(a,w,R.selection&&R.selection.map(E),$t.mapEffects(R.effects,E),R.annotations,R.scrollIntoView)}let v=a.facet(Pe);for(let w=v.length-1;w>=0;w--){let E=v[w](R);E instanceof jt?R=E:Array.isArray(E)&&E.length==1&&E[0]instanceof jt?R=E[0]:R=st(a,ot(E),!1)}return R}function Ve(R){let a=R.startState,d=a.facet(Qe),v=R;for(let w=d.length-1;w>=0;w--){let E=d[w](R);E&&Object.keys(E).length&&(v=Rt(v,xi(a,E,R.changes.newLength),!0))}return v==R?R:jt.create(a,R.changes,R.selection,v.effects,v.annotations,v.scrollIntoView)}const Jt=[];function ot(R){return R==null?Jt:Array.isArray(R)?R:[R]}var rt=function(R){return R[R.Word=0]="Word",R[R.Space=1]="Space",R[R.Other=2]="Other",R}(rt||(rt={}));const yt=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;let lt;try{lt=new RegExp("[\\p{Alphabetic}\\p{Number}_]","u")}catch{}function Zt(R){if(lt)return lt.test(R);for(let a=0;a<R.length;a++){let d=R[a];if(/\w/.test(d)||d>"\x80"&&(d.toUpperCase()!=d.toLowerCase()||yt.test(d)))return!0}return!1}function Bt(R){return a=>{if(!/\S/.test(a))return rt.Space;if(Zt(a))return rt.Word;for(let d=0;d<R.length;d++)if(a.indexOf(R[d])>-1)return rt.Word;return rt.Other}}class pt{constructor(a,d,v,w,E,D){this.config=a,this.doc=d,this.selection=v,this.values=w,this.status=a.statusTemplate.slice(),this.computeSlot=E,D&&(D._state=this);for(let H=0;H<this.config.dynamicSlots.length;H++)N(this,H<<1);this.computeSlot=null}field(a,d=!0){let v=this.config.address[a.id];if(v==null){if(d)throw new RangeError("Field is not present in this state");return}return N(this,v),Z(this,v)}update(...a){return st(this,a,!0)}applyTransaction(a){let d=this.config,{base:v,compartments:w}=d;for(let H of a.effects)H.is(te.reconfigure)?(d&&(w=new Map,d.compartments.forEach((j,ne)=>w.set(ne,j)),d=null),w.set(H.value.compartment,H.value.extension)):H.is($t.reconfigure)?(d=null,v=H.value):H.is($t.appendConfig)&&(d=null,v=ot(v).concat(H.value));let E;d?E=a.startState.values.slice():(d=C.resolve(v,w,this),E=new pt(d,this.doc,this.selection,d.dynamicSlots.map(()=>null),(j,ne)=>ne.reconfigure(j,this),null).values);let D=a.startState.facet(re)?a.newSelection:a.newSelection.asSingle();new pt(d,a.newDoc,D,E,(H,j)=>j.update(H,a),a)}replaceSelection(a){return typeof a=="string"&&(a=this.toText(a)),this.changeByRange(d=>({changes:{from:d.from,to:d.to,insert:a},range:ae.cursor(d.from+a.length)}))}changeByRange(a){let d=this.selection,v=a(d.ranges[0]),w=this.changes(v.changes),E=[v.range],D=ot(v.effects);for(let H=1;H<d.ranges.length;H++){let j=a(d.ranges[H]),ne=this.changes(j.changes),fe=ne.map(w);for(let Ne=0;Ne<H;Ne++)E[Ne]=E[Ne].map(fe);let ye=w.mapDesc(ne,!0);E.push(j.range.map(ye)),w=w.compose(fe),D=$t.mapEffects(D,fe).concat($t.mapEffects(ot(j.effects),ye))}return{changes:w,selection:ae.create(E,d.mainIndex),effects:D}}changes(a=[]){return a instanceof Dt?a:Dt.of(a,this.doc.length,this.facet(pt.lineSeparator))}toText(a){return p.of(a.split(this.facet(pt.lineSeparator)||Oi))}sliceDoc(a=0,d=this.doc.length){return this.doc.sliceString(a,d,this.lineBreak)}facet(a){let d=this.config.address[a.id];return d==null?a.default:(N(this,d),Z(this,d))}toJSON(a){let d={doc:this.sliceDoc(),selection:this.selection.toJSON()};if(a)for(let v in a){let w=a[v];w instanceof Ft&&this.config.address[w.id]!=null&&(d[v]=w.spec.toJSON(this.field(a[v]),this))}return d}static fromJSON(a,d={},v){if(!a||typeof a.doc!="string")throw new RangeError("Invalid JSON representation for EditorState");let w=[];if(v){for(let E in v)if(Object.prototype.hasOwnProperty.call(a,E)){let D=v[E],H=a[E];w.push(D.init(j=>D.spec.fromJSON(H,j)))}}return pt.create({doc:a.doc,selection:ae.fromJSON(a.selection),extensions:d.extensions?w.concat([d.extensions]):w})}static create(a={}){let d=C.resolve(a.extensions||[],new Map),v=a.doc instanceof p?a.doc:p.of((a.doc||"").split(d.staticFacet(pt.lineSeparator)||Oi)),w=a.selection?a.selection instanceof ae?a.selection:ae.single(a.selection.anchor,a.selection.head):ae.single(0);return be(w,v.length),d.staticFacet(re)||(w=w.asSingle()),new pt(d,v,w,d.dynamicSlots.map(()=>null),(E,D)=>D.create(E),null)}get tabSize(){return this.facet(pt.tabSize)}get lineBreak(){return this.facet(pt.lineSeparator)||`
`}get readOnly(){return this.facet(tt)}phrase(a,...d){for(let v of this.facet(pt.phrases))if(Object.prototype.hasOwnProperty.call(v,a)){a=v[a];break}return d.length&&(a=a.replace(/\$(\$|\d*)/g,(v,w)=>{if(w=="$")return"$";let E=+(w||1);return!E||E>d.length?v:d[E-1]})),a}languageDataAt(a,d,v=-1){let w=[];for(let E of this.facet(ee))for(let D of E(this,d,v))Object.prototype.hasOwnProperty.call(D,a)&&w.push(D[a]);return w}charCategorizer(a){return Bt(this.languageDataAt("wordChars",a).join(""))}wordAt(a){let{text:d,from:v,length:w}=this.doc.lineAt(a),E=this.charCategorizer(a),D=a-v,H=a-v;for(;D>0;){let j=Xt(d,D,!1);if(E(d.slice(j,D))!=rt.Word)break;D=j}for(;H<w;){let j=Xt(d,H);if(E(d.slice(H,j))!=rt.Word)break;H=j}return D==H?null:ae.range(D+v,H+v)}}pt.allowMultipleSelections=re,pt.tabSize=ke.define({combine:R=>R.length?R[0]:4}),pt.lineSeparator=xe,pt.readOnly=tt,pt.phrases=ke.define({compare(R,a){let d=Object.keys(R),v=Object.keys(a);return d.length==v.length&&d.every(w=>R[w]==a[w])}}),pt.languageData=ee,pt.changeFilter=He,pt.transactionFilter=Pe,pt.transactionExtender=Qe,te.reconfigure=$t.define();function gi(R,a,d={}){let v={};for(let w of R)for(let E of Object.keys(w)){let D=w[E],H=v[E];if(H===void 0)v[E]=D;else if(!(H===D||D===void 0))if(Object.hasOwnProperty.call(d,E))v[E]=d[E](H,D);else throw new Error("Config merge conflict for field "+E)}for(let w in a)v[w]===void 0&&(v[w]=a[w]);return v}class hi{eq(a){return this==a}range(a,d=a){return yi.create(a,d,this)}}hi.prototype.startSide=hi.prototype.endSide=0,hi.prototype.point=!1,hi.prototype.mapMode=Pt.TrackDel;class yi{constructor(a,d,v){this.from=a,this.to=d,this.value=v}static create(a,d,v){return new yi(a,d,v)}}function on(R,a){return R.from-a.from||R.value.startSide-a.value.startSide}class Ci{constructor(a,d,v,w){this.from=a,this.to=d,this.value=v,this.maxPoint=w}get length(){return this.to[this.to.length-1]}findIndex(a,d,v,w=0){let E=v?this.to:this.from;for(let D=w,H=E.length;;){if(D==H)return D;let j=D+H>>1,ne=E[j]-a||(v?this.value[j].endSide:this.value[j].startSide)-d;if(j==D)return ne>=0?D:H;ne>=0?H=j:D=j+1}}between(a,d,v,w){for(let E=this.findIndex(d,-1e9,!0),D=this.findIndex(v,1e9,!1,E);E<D;E++)if(w(this.from[E]+a,this.to[E]+a,this.value[E])===!1)return!1}map(a,d){let v=[],w=[],E=[],D=-1,H=-1;for(let j=0;j<this.value.length;j++){let ne=this.value[j],fe=this.from[j]+a,ye=this.to[j]+a,Ne,Be;if(fe==ye){let Ut=d.mapPos(fe,ne.startSide,ne.mapMode);if(Ut==null||(Ne=Be=Ut,ne.startSide!=ne.endSide&&(Be=d.mapPos(fe,ne.endSide),Be<Ne)))continue}else if(Ne=d.mapPos(fe,ne.startSide),Be=d.mapPos(ye,ne.endSide),Ne>Be||Ne==Be&&ne.startSide>0&&ne.endSide<=0)continue;(Be-Ne||ne.endSide-ne.startSide)<0||(D<0&&(D=Ne),ne.point&&(H=Math.max(H,Be-Ne)),v.push(ne),w.push(Ne-D),E.push(Be-D))}return{mapped:v.length?new Ci(w,E,v,H):null,pos:D}}}class Lt{constructor(a,d,v,w){this.chunkPos=a,this.chunk=d,this.nextLayer=v,this.maxPoint=w}static create(a,d,v,w){return new Lt(a,d,v,w)}get length(){let a=this.chunk.length-1;return a<0?0:Math.max(this.chunkEnd(a),this.nextLayer.length)}get size(){if(this.isEmpty)return 0;let a=this.nextLayer.size;for(let d of this.chunk)a+=d.value.length;return a}chunkEnd(a){return this.chunkPos[a]+this.chunk[a].length}update(a){let{add:d=[],sort:v=!1,filterFrom:w=0,filterTo:E=this.length}=a,D=a.filter;if(d.length==0&&!D)return this;if(v&&(d=d.slice().sort(on)),this.isEmpty)return d.length?Lt.of(d):this;let H=new Ki(this,null,-1).goto(0),j=0,ne=[],fe=new Ni;for(;H.value||j<d.length;)if(j<d.length&&(H.from-d[j].from||H.startSide-d[j].value.startSide)>=0){let ye=d[j++];fe.addInner(ye.from,ye.to,ye.value)||ne.push(ye)}else H.rangeIndex==1&&H.chunkIndex<this.chunk.length&&(j==d.length||this.chunkEnd(H.chunkIndex)<d[j].from)&&(!D||w>this.chunkEnd(H.chunkIndex)||E<this.chunkPos[H.chunkIndex])&&fe.addChunk(this.chunkPos[H.chunkIndex],this.chunk[H.chunkIndex])?H.nextChunk():((!D||w>H.to||E<H.from||D(H.from,H.to,H.value))&&(fe.addInner(H.from,H.to,H.value)||ne.push(yi.create(H.from,H.to,H.value))),H.next());return fe.finishInner(this.nextLayer.isEmpty&&!ne.length?Lt.empty:this.nextLayer.update({add:ne,filter:D,filterFrom:w,filterTo:E}))}map(a){if(a.empty||this.isEmpty)return this;let d=[],v=[],w=-1;for(let D=0;D<this.chunk.length;D++){let H=this.chunkPos[D],j=this.chunk[D],ne=a.touchesRange(H,H+j.length);if(ne===!1)w=Math.max(w,j.maxPoint),d.push(j),v.push(a.mapPos(H));else if(ne===!0){let{mapped:fe,pos:ye}=j.map(H,a);fe&&(w=Math.max(w,fe.maxPoint),d.push(fe),v.push(ye))}}let E=this.nextLayer.map(a);return d.length==0?E:new Lt(v,d,E||Lt.empty,w)}between(a,d,v){if(!this.isEmpty){for(let w=0;w<this.chunk.length;w++){let E=this.chunkPos[w],D=this.chunk[w];if(d>=E&&a<=E+D.length&&D.between(E,a-E,d-E,v)===!1)return}this.nextLayer.between(a,d,v)}}iter(a=0){return Qi.from([this]).goto(a)}get isEmpty(){return this.nextLayer==this}static iter(a,d=0){return Qi.from(a).goto(d)}static compare(a,d,v,w,E=-1){let D=a.filter(ye=>ye.maxPoint>0||!ye.isEmpty&&ye.maxPoint>=E),H=d.filter(ye=>ye.maxPoint>0||!ye.isEmpty&&ye.maxPoint>=E),j=qi(D,H,v),ne=new Ji(D,j,E),fe=new Ji(H,j,E);v.iterGaps((ye,Ne,Be)=>Vn(ne,ye,fe,Ne,Be,w)),v.empty&&v.length==0&&Vn(ne,0,fe,0,0,w)}static eq(a,d,v=0,w){w==null&&(w=1e9-1);let E=a.filter(fe=>!fe.isEmpty&&d.indexOf(fe)<0),D=d.filter(fe=>!fe.isEmpty&&a.indexOf(fe)<0);if(E.length!=D.length)return!1;if(!E.length)return!0;let H=qi(E,D),j=new Ji(E,H,0).goto(v),ne=new Ji(D,H,0).goto(v);for(;;){if(j.to!=ne.to||!fn(j.active,ne.active)||j.point&&(!ne.point||!j.point.eq(ne.point)))return!1;if(j.to>w)return!0;j.next(),ne.next()}}static spans(a,d,v,w,E=-1){let D=new Ji(a,null,E).goto(d),H=d,j=D.openStart;for(;;){let ne=Math.min(D.to,v);if(D.point){let fe=D.activeForPoint(D.to),ye=D.pointFrom<d?fe.length+1:Math.min(fe.length,j);w.point(H,ne,D.point,fe,ye,D.pointRank),j=Math.min(D.openEnd(ne),fe.length)}else ne>H&&(w.span(H,ne,D.active,j),j=D.openEnd(ne));if(D.to>v)return j+(D.point&&D.to>v?1:0);H=D.to,D.next()}}static of(a,d=!1){let v=new Ni;for(let w of a instanceof yi?[a]:d?zi(a):a)v.add(w.from,w.to,w.value);return v.finish()}}Lt.empty=new Lt([],[],null,-1);function zi(R){if(R.length>1)for(let a=R[0],d=1;d<R.length;d++){let v=R[d];if(on(a,v)>0)return R.slice().sort(on);a=v}return R}Lt.empty.nextLayer=Lt.empty;class Ni{finishChunk(a){this.chunks.push(new Ci(this.from,this.to,this.value,this.maxPoint)),this.chunkPos.push(this.chunkStart),this.chunkStart=-1,this.setMaxPoint=Math.max(this.setMaxPoint,this.maxPoint),this.maxPoint=-1,a&&(this.from=[],this.to=[],this.value=[])}constructor(){this.chunks=[],this.chunkPos=[],this.chunkStart=-1,this.last=null,this.lastFrom=-1e9,this.lastTo=-1e9,this.from=[],this.to=[],this.value=[],this.maxPoint=-1,this.setMaxPoint=-1,this.nextLayer=null}add(a,d,v){this.addInner(a,d,v)||(this.nextLayer||(this.nextLayer=new Ni)).add(a,d,v)}addInner(a,d,v){let w=a-this.lastTo||v.startSide-this.last.endSide;if(w<=0&&(a-this.lastFrom||v.startSide-this.last.startSide)<0)throw new Error("Ranges must be added sorted by `from` position and `startSide`");return w<0?!1:(this.from.length==250&&this.finishChunk(!0),this.chunkStart<0&&(this.chunkStart=a),this.from.push(a-this.chunkStart),this.to.push(d-this.chunkStart),this.last=v,this.lastFrom=a,this.lastTo=d,this.value.push(v),v.point&&(this.maxPoint=Math.max(this.maxPoint,d-a)),!0)}addChunk(a,d){if((a-this.lastTo||d.value[0].startSide-this.last.endSide)<0)return!1;this.from.length&&this.finishChunk(!0),this.setMaxPoint=Math.max(this.setMaxPoint,d.maxPoint),this.chunks.push(d),this.chunkPos.push(a);let v=d.value.length-1;return this.last=d.value[v],this.lastFrom=d.from[v]+a,this.lastTo=d.to[v]+a,!0}finish(){return this.finishInner(Lt.empty)}finishInner(a){if(this.from.length&&this.finishChunk(!1),this.chunks.length==0)return a;let d=Lt.create(this.chunkPos,this.chunks,this.nextLayer?this.nextLayer.finishInner(a):a,this.setMaxPoint);return this.from=null,d}}function qi(R,a,d){let v=new Map;for(let E of R)for(let D=0;D<E.chunk.length;D++)E.chunk[D].maxPoint<=0&&v.set(E.chunk[D],E.chunkPos[D]);let w=new Set;for(let E of a)for(let D=0;D<E.chunk.length;D++){let H=v.get(E.chunk[D]);H!=null&&(d?d.mapPos(H):H)==E.chunkPos[D]&&!(d!=null&&d.touchesRange(H,H+E.chunk[D].length))&&w.add(E.chunk[D])}return w}class Ki{constructor(a,d,v,w=0){this.layer=a,this.skip=d,this.minPoint=v,this.rank=w}get startSide(){return this.value?this.value.startSide:0}get endSide(){return this.value?this.value.endSide:0}goto(a,d=-1e9){return this.chunkIndex=this.rangeIndex=0,this.gotoInner(a,d,!1),this}gotoInner(a,d,v){for(;this.chunkIndex<this.layer.chunk.length;){let w=this.layer.chunk[this.chunkIndex];if(!(this.skip&&this.skip.has(w)||this.layer.chunkEnd(this.chunkIndex)<a||w.maxPoint<this.minPoint))break;this.chunkIndex++,v=!1}if(this.chunkIndex<this.layer.chunk.length){let w=this.layer.chunk[this.chunkIndex].findIndex(a-this.layer.chunkPos[this.chunkIndex],d,!0);(!v||this.rangeIndex<w)&&this.setRangeIndex(w)}this.next()}forward(a,d){(this.to-a||this.endSide-d)<0&&this.gotoInner(a,d,!0)}next(){for(;;)if(this.chunkIndex==this.layer.chunk.length){this.from=this.to=1e9,this.value=null;break}else{let a=this.layer.chunkPos[this.chunkIndex],d=this.layer.chunk[this.chunkIndex],v=a+d.from[this.rangeIndex];if(this.from=v,this.to=a+d.to[this.rangeIndex],this.value=d.value[this.rangeIndex],this.setRangeIndex(this.rangeIndex+1),this.minPoint<0||this.value.point&&this.to-this.from>=this.minPoint)break}}setRangeIndex(a){if(a==this.layer.chunk[this.chunkIndex].value.length){if(this.chunkIndex++,this.skip)for(;this.chunkIndex<this.layer.chunk.length&&this.skip.has(this.layer.chunk[this.chunkIndex]);)this.chunkIndex++;this.rangeIndex=0}else this.rangeIndex=a}nextChunk(){this.chunkIndex++,this.rangeIndex=0,this.next()}compare(a){return this.from-a.from||this.startSide-a.startSide||this.rank-a.rank||this.to-a.to||this.endSide-a.endSide}}class Qi{constructor(a){this.heap=a}static from(a,d=null,v=-1){let w=[];for(let E=0;E<a.length;E++)for(let D=a[E];!D.isEmpty;D=D.nextLayer)D.maxPoint>=v&&w.push(new Ki(D,d,v,E));return w.length==1?w[0]:new Qi(w)}get startSide(){return this.value?this.value.startSide:0}goto(a,d=-1e9){for(let v of this.heap)v.goto(a,d);for(let v=this.heap.length>>1;v>=0;v--)ri(this.heap,v);return this.next(),this}forward(a,d){for(let v of this.heap)v.forward(a,d);for(let v=this.heap.length>>1;v>=0;v--)ri(this.heap,v);(this.to-a||this.value.endSide-d)<0&&this.next()}next(){if(this.heap.length==0)this.from=this.to=1e9,this.value=null,this.rank=-1;else{let a=this.heap[0];this.from=a.from,this.to=a.to,this.value=a.value,this.rank=a.rank,a.value&&a.next(),ri(this.heap,0)}}}function ri(R,a){for(let d=R[a];;){let v=(a<<1)+1;if(v>=R.length)break;let w=R[v];if(v+1<R.length&&w.compare(R[v+1])>=0&&(w=R[v+1],v++),d.compare(w)<0)break;R[v]=d,R[a]=w,a=v}}class Ji{constructor(a,d,v){this.minPoint=v,this.active=[],this.activeTo=[],this.activeRank=[],this.minActive=-1,this.point=null,this.pointFrom=0,this.pointRank=0,this.to=-1e9,this.endSide=0,this.openStart=-1,this.cursor=Qi.from(a,d,v)}goto(a,d=-1e9){return this.cursor.goto(a,d),this.active.length=this.activeTo.length=this.activeRank.length=0,this.minActive=-1,this.to=a,this.endSide=d,this.openStart=-1,this.next(),this}forward(a,d){for(;this.minActive>-1&&(this.activeTo[this.minActive]-a||this.active[this.minActive].endSide-d)<0;)this.removeActive(this.minActive);this.cursor.forward(a,d)}removeActive(a){vi(this.active,a),vi(this.activeTo,a),vi(this.activeRank,a),this.minActive=Cn(this.active,this.activeTo)}addActive(a){let d=0,{value:v,to:w,rank:E}=this.cursor;for(;d<this.activeRank.length&&this.activeRank[d]<=E;)d++;kn(this.active,d,v),kn(this.activeTo,d,w),kn(this.activeRank,d,E),a&&kn(a,d,this.cursor.from),this.minActive=Cn(this.active,this.activeTo)}next(){let a=this.to,d=this.point;this.point=null;let v=this.openStart<0?[]:null;for(;;){let w=this.minActive;if(w>-1&&(this.activeTo[w]-this.cursor.from||this.active[w].endSide-this.cursor.startSide)<0){if(this.activeTo[w]>a){this.to=this.activeTo[w],this.endSide=this.active[w].endSide;break}this.removeActive(w),v&&vi(v,w)}else if(this.cursor.value)if(this.cursor.from>a){this.to=this.cursor.from,this.endSide=this.cursor.startSide;break}else{let E=this.cursor.value;if(!E.point)this.addActive(v),this.cursor.next();else if(d&&this.cursor.to==this.to&&this.cursor.from<this.cursor.to)this.cursor.next();else{this.point=E,this.pointFrom=this.cursor.from,this.pointRank=this.cursor.rank,this.to=this.cursor.to,this.endSide=E.endSide,this.cursor.next(),this.forward(this.to,this.endSide);break}}else{this.to=this.endSide=1e9;break}}if(v){this.openStart=0;for(let w=v.length-1;w>=0&&v[w]<a;w--)this.openStart++}}activeForPoint(a){if(!this.active.length)return this.active;let d=[];for(let v=this.active.length-1;v>=0&&!(this.activeRank[v]<this.pointRank);v--)(this.activeTo[v]>a||this.activeTo[v]==a&&this.active[v].endSide>=this.point.endSide)&&d.push(this.active[v]);return d.reverse()}openEnd(a){let d=0;for(let v=this.activeTo.length-1;v>=0&&this.activeTo[v]>a;v--)d++;return d}}function Vn(R,a,d,v,w,E){R.goto(a),d.goto(v);let D=v+w,H=v,j=v-a;for(;;){let ne=R.to+j-d.to||R.endSide-d.endSide,fe=ne<0?R.to+j:d.to,ye=Math.min(fe,D);if(R.point||d.point?R.point&&d.point&&(R.point==d.point||R.point.eq(d.point))&&fn(R.activeForPoint(R.to),d.activeForPoint(d.to))||E.comparePoint(H,ye,R.point,d.point):ye>H&&!fn(R.active,d.active)&&E.compareRange(H,ye,R.active,d.active),fe>D)break;H=fe,ne<=0&&R.next(),ne>=0&&d.next()}}function fn(R,a){if(R.length!=a.length)return!1;for(let d=0;d<R.length;d++)if(R[d]!=a[d]&&!R[d].eq(a[d]))return!1;return!0}function vi(R,a){for(let d=a,v=R.length-1;d<v;d++)R[d]=R[d+1];R.pop()}function kn(R,a,d){for(let v=R.length-1;v>=a;v--)R[v+1]=R[v];R[a]=d}function Cn(R,a){let d=-1,v=1e9;for(let w=0;w<a.length;w++)(a[w]-v||R[w].endSide-R[d].endSide)<0&&(d=w,v=a[w]);return d}function ns(R,a,d=R.length){let v=0;for(let w=0;w<d;)R.charCodeAt(w)==9?(v+=a-v%a,w++):(v++,w=Xt(R,w));return v}function On(R,a,d,v){for(let w=0,E=0;;){if(E>=a)return w;if(w==R.length)break;E+=R.charCodeAt(w)==9?d-E%d:1,w=Xt(R,w)}return v===!0?-1:R.length}},65329:(wn,Nt,q)=>{q.d(Nt,{p:()=>Ye,Nm:()=>j,tk:()=>Mt,SJ:()=>ki,lg:()=>vi,l9:()=>xi,S2:()=>il,Uw:()=>At,qr:()=>br,Sd:()=>Wo,gB:()=>Tl,v5:()=>Ho,ZO:()=>el,HQ:()=>dl,AE:()=>xl,bF:()=>Al,$f:()=>ni,Eu:()=>Xr,OO:()=>ri,W$:()=>wr,Zs:()=>Po,$1:()=>Wr,mH:()=>Kr,hJ:()=>$r});for(var p=q(1727),we=q(37207),ue={8:"Backspace",9:"Tab",10:"Enter",12:"NumLock",13:"Enter",16:"Shift",17:"Control",18:"Alt",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",44:"PrintScreen",45:"Insert",46:"Delete",59:";",61:"=",91:"Meta",92:"Meta",106:"*",107:"+",108:",",109:"-",110:".",111:"/",144:"NumLock",145:"ScrollLock",160:"Shift",161:"Shift",162:"Control",163:"Control",164:"Alt",165:"Alt",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'"},L={48:")",49:"!",50:"@",51:"#",52:"$",53:"%",54:"^",55:"&",56:"*",57:"(",59:":",61:"+",173:"_",186:":",187:"+",188:"<",189:"_",190:">",191:"?",192:"~",219:"{",220:"|",221:"}",222:'"'},G=typeof navigator!="undefined"&&/Mac/.test(navigator.platform),Se=typeof navigator!="undefined"&&/MSIE \d|Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(navigator.userAgent),Fe=0;Fe<10;Fe++)ue[48+Fe]=ue[96+Fe]=String(Fe);for(var Fe=1;Fe<=24;Fe++)ue[Fe+111]="F"+Fe;for(var Fe=65;Fe<=90;Fe++)ue[Fe]=String.fromCharCode(Fe+32),L[Fe]=String.fromCharCode(Fe);for(var bt in ue)L.hasOwnProperty(bt)||(L[bt]=ue[bt]);function ft(r){var e=G&&r.metaKey&&r.shiftKey&&!r.ctrlKey&&!r.altKey||Se&&r.shiftKey&&r.key&&r.key.length==1||r.key=="Unidentified",t=!e&&r.key||(r.shiftKey?L:ue)[r.keyCode]||r.key||"Unidentified";return t=="Esc"&&(t="Escape"),t=="Del"&&(t="Delete"),t=="Left"&&(t="ArrowLeft"),t=="Up"&&(t="ArrowUp"),t=="Right"&&(t="ArrowRight"),t=="Down"&&(t="ArrowDown"),t}function xt(r){let e;return r.nodeType==11?e=r.getSelection?r:r.ownerDocument:e=r,e.getSelection()}function Ze(r,e){return e?r==e||r.contains(e.nodeType!=1?e.parentNode:e):!1}function nt(r){let e=r.activeElement;for(;e&&e.shadowRoot;)e=e.shadowRoot.activeElement;return e}function _e(r,e){if(!e.anchorNode)return!1;try{return Ze(r,e.anchorNode)}catch{return!1}}function mt(r){return r.nodeType==3?wt(r,0,r.nodeValue.length).getClientRects():r.nodeType==1?r.getClientRects():[]}function mi(r,e,t,n){return t?me(r,e,t,n,-1)||me(r,e,t,n,1):!1}function Xt(r){for(var e=0;;e++)if(r=r.previousSibling,!r)return e}function me(r,e,t,n,s){for(;;){if(r==t&&e==n)return!0;if(e==(s<0?0:ut(r))){if(r.nodeName=="DIV")return!1;let c=r.parentNode;if(!c||c.nodeType!=1)return!1;e=Xt(r)+(s<0?0:1),r=c}else if(r.nodeType==1){if(r=r.childNodes[e+(s<0?-1:0)],r.nodeType==1&&r.contentEditable=="false")return!1;e=s<0?ut(r):0}else return!1}}function ut(r){return r.nodeType==3?r.nodeValue.length:r.childNodes.length}function Kt(r,e){let t=e?r.left:r.right;return{left:t,right:t,top:r.top,bottom:r.bottom}}function bi(r){return{left:0,right:r.innerWidth,top:0,bottom:r.innerHeight}}function fi(r,e){let t=e.width/r.offsetWidth,n=e.height/r.offsetHeight;return(t>.995&&t<1.005||!isFinite(t)||Math.abs(e.width-r.offsetWidth)<1)&&(t=1),(n>.995&&n<1.005||!isFinite(n)||Math.abs(e.height-r.offsetHeight)<1)&&(n=1),{scaleX:t,scaleY:n}}function Et(r,e,t,n,s,c,u,y){let b=r.ownerDocument,M=b.defaultView||window;for(let A=r,F=!1;A&&!F;)if(A.nodeType==1){let $,X=A==b.body,_=1,le=1;if(X)$=bi(M);else{if(/^(fixed|sticky)$/.test(getComputedStyle(A).position)&&(F=!0),A.scrollHeight<=A.clientHeight&&A.scrollWidth<=A.clientWidth){A=A.assignedSlot||A.parentNode;continue}let Je=A.getBoundingClientRect();({scaleX:_,scaleY:le}=fi(A,Je)),$={left:Je.left,right:Je.left+A.clientWidth*_,top:Je.top,bottom:Je.top+A.clientHeight*le}}let se=0,de=0;if(s=="nearest")e.top<$.top?(de=-($.top-e.top+u),t>0&&e.bottom>$.bottom+de&&(de=e.bottom-$.bottom+de+u)):e.bottom>$.bottom&&(de=e.bottom-$.bottom+u,t<0&&e.top-de<$.top&&(de=-($.top+de-e.top+u)));else{let Je=e.bottom-e.top,ht=$.bottom-$.top;de=(s=="center"&&Je<=ht?e.top+Je/2-ht/2:s=="start"||s=="center"&&t<0?e.top-u:e.bottom-ht+u)-$.top}if(n=="nearest"?e.left<$.left?(se=-($.left-e.left+c),t>0&&e.right>$.right+se&&(se=e.right-$.right+se+c)):e.right>$.right&&(se=e.right-$.right+c,t<0&&e.left<$.left+se&&(se=-($.left+se-e.left+c))):se=(n=="center"?e.left+(e.right-e.left)/2-($.right-$.left)/2:n=="start"==y?e.left-c:e.right-($.right-$.left)+c)-$.left,se||de)if(X)M.scrollBy(se,de);else{let Je=0,ht=0;if(de){let Ue=A.scrollTop;A.scrollTop+=de/le,ht=(A.scrollTop-Ue)*le}if(se){let Ue=A.scrollLeft;A.scrollLeft+=se/_,Je=(A.scrollLeft-Ue)*_}e={left:e.left-Je,top:e.top-ht,right:e.right-Je,bottom:e.bottom-ht},Je&&Math.abs(Je-se)<1&&(n="nearest"),ht&&Math.abs(ht-de)<1&&(s="nearest")}if(X)break;A=A.assignedSlot||A.parentNode}else if(A.nodeType==11)A=A.host;else break}function ui(r){let e=r.ownerDocument;for(let t=r.parentNode;t&&t!=e.body;)if(t.nodeType==1){if(t.scrollHeight>t.clientHeight||t.scrollWidth>t.clientWidth)return t;t=t.assignedSlot||t.parentNode}else if(t.nodeType==11)t=t.host;else break;return null}class Oi{constructor(){this.anchorNode=null,this.anchorOffset=0,this.focusNode=null,this.focusOffset=0}eq(e){return this.anchorNode==e.anchorNode&&this.anchorOffset==e.anchorOffset&&this.focusNode==e.focusNode&&this.focusOffset==e.focusOffset}setRange(e){let{anchorNode:t,focusNode:n}=e;this.set(t,Math.min(e.anchorOffset,t?ut(t):0),n,Math.min(e.focusOffset,n?ut(n):0))}set(e,t,n,s){this.anchorNode=e,this.anchorOffset=t,this.focusNode=n,this.focusOffset=s}}let Pt=null;function Ot(r){if(r.setActive)return r.setActive();if(Pt)return r.focus(Pt);let e=[];for(let t=r;t&&(e.push(t,t.scrollTop,t.scrollLeft),t!=t.ownerDocument);t=t.parentNode);if(r.focus(Pt==null?{get preventScroll(){return Pt={preventScroll:!0},!0}}:void 0),!Pt){Pt=!1;for(let t=0;t<e.length;){let n=e[t++],s=e[t++],c=e[t++];n.scrollTop!=s&&(n.scrollTop=s),n.scrollLeft!=c&&(n.scrollLeft=c)}}}let Dt;function wt(r,e,t=e){let n=Dt||(Dt=document.createRange());return n.setEnd(r,t),n.setStart(r,e),n}function ai(r,e,t){let n={key:e,code:e,keyCode:t,which:t,cancelable:!0},s=new KeyboardEvent("keydown",n);s.synthetic=!0,r.dispatchEvent(s);let c=new KeyboardEvent("keyup",n);return c.synthetic=!0,r.dispatchEvent(c),s.defaultPrevented||c.defaultPrevented}function _t(r){for(;r;){if(r&&(r.nodeType==9||r.nodeType==11&&r.host))return r;r=r.assignedSlot||r.parentNode}return null}function ei(r){for(;r.attributes.length;)r.removeAttributeNode(r.attributes[0])}function Ge(r,e){let t=e.focusNode,n=e.focusOffset;if(!t||e.anchorNode!=t||e.anchorOffset!=n)return!1;for(n=Math.min(n,ut(t));;)if(n){if(t.nodeType!=1)return!1;let s=t.childNodes[n-1];s.contentEditable=="false"?n--:(t=s,n=ut(t))}else{if(t==r)return!0;n=Xt(t),t=t.parentNode}}function Mi(r){return r.scrollTop>Math.max(1,r.scrollHeight-r.clientHeight-4)}class Xe{constructor(e,t,n=!0){this.node=e,this.offset=t,this.precise=n}static before(e,t){return new Xe(e.parentNode,Xt(e),t)}static after(e,t){return new Xe(e.parentNode,Xt(e)+1,t)}}const ae=[];class be{constructor(){this.parent=null,this.dom=null,this.flags=2}get overrideDOMText(){return null}get posAtStart(){return this.parent?this.parent.posBefore(this):0}get posAtEnd(){return this.posAtStart+this.length}posBefore(e){let t=this.posAtStart;for(let n of this.children){if(n==e)return t;t+=n.length+n.breakAfter}throw new RangeError("Invalid child in posBefore")}posAfter(e){return this.posBefore(e)+e.length}sync(e,t){if(this.flags&2){let n=this.dom,s=null,c;for(let u of this.children){if(u.flags&7){if(!u.dom&&(c=s?s.nextSibling:n.firstChild)){let y=be.get(c);(!y||!y.parent&&y.canReuseDOM(u))&&u.reuseDOM(c)}u.sync(e,t),u.flags&=-8}if(c=s?s.nextSibling:n.firstChild,t&&!t.written&&t.node==n&&c!=u.dom&&(t.written=!0),u.dom.parentNode==n)for(;c&&c!=u.dom;)c=ze(c);else n.insertBefore(u.dom,c);s=u.dom}for(c=s?s.nextSibling:n.firstChild,c&&t&&t.node==n&&(t.written=!0);c;)c=ze(c)}else if(this.flags&1)for(let n of this.children)n.flags&7&&(n.sync(e,t),n.flags&=-8)}reuseDOM(e){}localPosFromDOM(e,t){let n;if(e==this.dom)n=this.dom.childNodes[t];else{let s=ut(e)==0?0:t==0?-1:1;for(;;){let c=e.parentNode;if(c==this.dom)break;s==0&&c.firstChild!=c.lastChild&&(e==c.firstChild?s=-1:s=1),e=c}s<0?n=e:n=e.nextSibling}if(n==this.dom.firstChild)return 0;for(;n&&!be.get(n);)n=n.nextSibling;if(!n)return this.length;for(let s=0,c=0;;s++){let u=this.children[s];if(u.dom==n)return c;c+=u.length+u.breakAfter}}domBoundsAround(e,t,n=0){let s=-1,c=-1,u=-1,y=-1;for(let b=0,M=n,A=n;b<this.children.length;b++){let F=this.children[b],$=M+F.length;if(M<e&&$>t)return F.domBoundsAround(e,t,M);if($>=e&&s==-1&&(s=b,c=M),M>t&&F.dom.parentNode==this.dom){u=b,y=A;break}A=$,M=$+F.breakAfter}return{from:c,to:y<0?n+this.length:y,startDOM:(s?this.children[s-1].dom.nextSibling:null)||this.dom.firstChild,endDOM:u<this.children.length&&u>=0?this.children[u].dom:null}}markDirty(e=!1){this.flags|=2,this.markParentsDirty(e)}markParentsDirty(e){for(let t=this.parent;t;t=t.parent){if(e&&(t.flags|=2),t.flags&1)return;t.flags|=1,e=!1}}setParent(e){this.parent!=e&&(this.parent=e,this.flags&7&&this.markParentsDirty(!0))}setDOM(e){this.dom!=e&&(this.dom&&(this.dom.cmView=null),this.dom=e,e.cmView=this)}get rootView(){for(let e=this;;){let t=e.parent;if(!t)return e;e=t}}replaceChildren(e,t,n=ae){this.markDirty();for(let s=e;s<t;s++){let c=this.children[s];c.parent==this&&n.indexOf(c)<0&&c.destroy()}this.children.splice(e,t-e,...n);for(let s=0;s<n.length;s++)n[s].setParent(this)}ignoreMutation(e){return!1}ignoreEvent(e){return!1}childCursor(e=this.length){return new ke(this.children,e,this.children.length)}childPos(e,t=1){return this.childCursor().findPos(e,t)}toString(){let e=this.constructor.name.replace("View","");return e+(this.children.length?"("+this.children.join()+")":this.length?"["+(e=="Text"?this.text:this.length)+"]":"")+(this.breakAfter?"#":"")}static get(e){return e.cmView}get isEditable(){return!0}get isWidget(){return!1}get isHidden(){return!1}merge(e,t,n,s,c,u){return!1}become(e){return!1}canReuseDOM(e){return e.constructor==this.constructor&&!((this.flags|e.flags)&8)}getSide(){return 0}destroy(){for(let e of this.children)e.parent==this&&e.destroy();this.parent=null}}be.prototype.breakAfter=0;function ze(r){let e=r.nextSibling;return r.parentNode.removeChild(r),e}class ke{constructor(e,t,n){this.children=e,this.pos=t,this.i=n,this.off=0}findPos(e,t=1){for(;;){if(e>this.pos||e==this.pos&&(t>0||this.i==0||this.children[this.i-1].breakAfter))return this.off=e-this.pos,this;let n=this.children[--this.i];this.pos-=n.length+n.breakAfter}}}function Ee(r,e,t,n,s,c,u,y,b){let{children:M}=r,A=M.length?M[e]:null,F=c.length?c[c.length-1]:null,$=F?F.breakAfter:u;if(!(e==n&&A&&!u&&!$&&c.length<2&&A.merge(t,s,c.length?F:null,t==0,y,b))){if(n<M.length){let X=M[n];X&&(s<X.length||X.breakAfter&&(F!=null&&F.breakAfter))?(e==n&&(X=X.split(s),s=0),!$&&F&&X.merge(0,s,F,!0,0,b)?c[c.length-1]=X:((s||X.children.length&&!X.children[0].length)&&X.merge(0,s,null,!1,0,b),c.push(X))):X!=null&&X.breakAfter&&(F?F.breakAfter=1:u=1),n++}for(A&&(A.breakAfter=u,t>0&&(!u&&c.length&&A.merge(t,A.length,c[0],!1,y,0)?A.breakAfter=c.shift().breakAfter:(t<A.length||A.children.length&&A.children[A.children.length-1].length==0)&&A.merge(t,A.length,null,!1,y,0),e++));e<n&&c.length;)if(M[n-1].become(c[c.length-1]))n--,c.pop(),b=c.length?0:y;else if(M[e].become(c[0]))e++,c.shift(),y=c.length?0:b;else break;!c.length&&e&&n<M.length&&!M[e-1].breakAfter&&M[n].merge(0,0,M[e-1],!1,y,b)&&e--,(e<n||c.length)&&r.replaceChildren(e,n,c)}}function zt(r,e,t,n,s,c){let u=r.childCursor(),{i:y,off:b}=u.findPos(t,1),{i:M,off:A}=u.findPos(e,-1),F=e-t;for(let $ of n)F+=$.length;r.length+=F,Ee(r,M,A,y,b,n,0,s,c)}let Le=typeof navigator!="undefined"?navigator:{userAgent:"",vendor:"",platform:""},Yt=typeof document!="undefined"?document:{documentElement:{style:{}}};const et=/Edge\/(\d+)/.exec(Le.userAgent),Pi=/MSIE \d/.test(Le.userAgent),Ft=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(Le.userAgent),gt=!!(Pi||Ft||et),si=!gt&&/gecko\/(\d+)/i.test(Le.userAgent),rn=!gt&&/Chrome\/(\d+)/.exec(Le.userAgent),Zi="webkitFontSmoothing"in Yt.documentElement.style,te=!gt&&/Apple Computer/.test(Le.vendor),x=te&&(/Mobile\/\w+/.test(Le.userAgent)||Le.maxTouchPoints>2);var C={mac:x||/Mac/.test(Le.platform),windows:/Win/.test(Le.platform),linux:/Linux|X11/.test(Le.platform),ie:gt,ie_version:Pi?Yt.documentMode||6:Ft?+Ft[1]:et?+et[1]:0,gecko:si,gecko_version:si?+(/Firefox\/(\d+)/.exec(Le.userAgent)||[0,0])[1]:0,chrome:!!rn,chrome_version:rn?+rn[1]:0,ios:x,android:/Android\b/.test(Le.userAgent),webkit:Zi,safari:te,webkit_version:Zi?+(/\bAppleWebKit\/(\d+)/.exec(navigator.userAgent)||[0,0])[1]:0,tabSize:Yt.documentElement.style.tabSize!=null?"tab-size":"-moz-tab-size"};const I=256;class N extends be{constructor(e){super(),this.text=e}get length(){return this.text.length}createDOM(e){this.setDOM(e||document.createTextNode(this.text))}sync(e,t){this.dom||this.createDOM(),this.dom.nodeValue!=this.text&&(t&&t.node==this.dom&&(t.written=!0),this.dom.nodeValue=this.text)}reuseDOM(e){e.nodeType==3&&this.createDOM(e)}merge(e,t,n){return this.flags&8||n&&(!(n instanceof N)||this.length-(t-e)+n.length>I||n.flags&8)?!1:(this.text=this.text.slice(0,e)+(n?n.text:"")+this.text.slice(t),this.markDirty(),!0)}split(e){let t=new N(this.text.slice(e));return this.text=this.text.slice(0,e),this.markDirty(),t.flags|=this.flags&8,t}localPosFromDOM(e,t){return e==this.dom?t:t?this.text.length:0}domAtPos(e){return new Xe(this.dom,e)}domBoundsAround(e,t,n){return{from:n,to:n+this.length,startDOM:this.dom,endDOM:this.dom.nextSibling}}coordsAt(e,t){return ee(this.dom,e,t)}}class Z extends be{constructor(e,t=[],n=0){super(),this.mark=e,this.children=t,this.length=n;for(let s of t)s.setParent(this)}setAttrs(e){if(ei(e),this.mark.class&&(e.className=this.mark.class),this.mark.attrs)for(let t in this.mark.attrs)e.setAttribute(t,this.mark.attrs[t]);return e}canReuseDOM(e){return super.canReuseDOM(e)&&!((this.flags|e.flags)&8)}reuseDOM(e){e.nodeName==this.mark.tagName.toUpperCase()&&(this.setDOM(e),this.flags|=6)}sync(e,t){this.dom?this.flags&4&&this.setAttrs(this.dom):this.setDOM(this.setAttrs(document.createElement(this.mark.tagName))),super.sync(e,t)}merge(e,t,n,s,c,u){return n&&(!(n instanceof Z&&n.mark.eq(this.mark))||e&&c<=0||t<this.length&&u<=0)?!1:(zt(this,e,t,n?n.children.slice():[],c-1,u-1),this.markDirty(),!0)}split(e){let t=[],n=0,s=-1,c=0;for(let y of this.children){let b=n+y.length;b>e&&t.push(n<e?y.split(e-n):y),s<0&&n>=e&&(s=c),n=b,c++}let u=this.length-e;return this.length=e,s>-1&&(this.children.length=s,this.markDirty()),new Z(this.mark,t,u)}domAtPos(e){return He(this,e)}coordsAt(e,t){return Qe(this,e,t)}}function ee(r,e,t){let n=r.nodeValue.length;e>n&&(e=n);let s=e,c=e,u=0;e==0&&t<0||e==n&&t>=0?C.chrome||C.gecko||(e?(s--,u=1):c<n&&(c++,u=-1)):t<0?s--:c<n&&c++;let y=wt(r,s,c).getClientRects();if(!y.length)return null;let b=y[(u?u<0:t>=0)?0:y.length-1];return C.safari&&!u&&b.width==0&&(b=Array.prototype.find.call(y,M=>M.width)||b),u?Kt(b,u<0):b||null}class re extends be{static create(e,t,n){return new re(e,t,n)}constructor(e,t,n){super(),this.widget=e,this.length=t,this.side=n,this.prevWidget=null}split(e){let t=re.create(this.widget,this.length-e,this.side);return this.length-=e,t}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}getSide(){return this.side}merge(e,t,n,s,c,u){return n&&(!(n instanceof re)||!this.widget.compare(n.widget)||e>0&&c<=0||t<this.length&&u<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}become(e){return e instanceof re&&e.side==this.side&&this.widget.constructor==e.widget.constructor?(this.widget.compare(e.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get overrideDOMText(){if(this.length==0)return p.xv.empty;let e=this;for(;e.parent;)e=e.parent;let{view:t}=e,n=t&&t.state.doc,s=this.posAtStart;return n?n.slice(s,s+this.length):p.xv.empty}domAtPos(e){return(this.length?e==0:this.side>0)?Xe.before(this.dom):Xe.after(this.dom,e==this.length)}domBoundsAround(){return null}coordsAt(e,t){let n=this.widget.coordsAt(this.dom,e,t);if(n)return n;let s=this.dom.getClientRects(),c=null;if(!s.length)return null;let u=this.side?this.side<0:e>0;for(let y=u?s.length-1:0;c=s[y],!(e>0?y==0:y==s.length-1||c.top<c.bottom);y+=u?-1:1);return Kt(c,!u)}get isEditable(){return!1}get isWidget(){return!0}get isHidden(){return this.widget.isHidden}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}}class xe extends be{constructor(e){super(),this.side=e}get length(){return 0}merge(){return!1}become(e){return e instanceof xe&&e.side==this.side}split(){return new xe(this.side)}sync(){if(!this.dom){let e=document.createElement("img");e.className="cm-widgetBuffer",e.setAttribute("aria-hidden","true"),this.setDOM(e)}}getSide(){return this.side}domAtPos(e){return this.side>0?Xe.before(this.dom):Xe.after(this.dom)}localPosFromDOM(){return 0}domBoundsAround(){return null}coordsAt(e){return this.dom.getBoundingClientRect()}get overrideDOMText(){return p.xv.empty}get isHidden(){return!0}}N.prototype.children=re.prototype.children=xe.prototype.children=ae;function He(r,e){let t=r.dom,{children:n}=r,s=0;for(let c=0;s<n.length;s++){let u=n[s],y=c+u.length;if(!(y==c&&u.getSide()<=0)){if(e>c&&e<y&&u.dom.parentNode==t)return u.domAtPos(e-c);if(e<=c)break;c=y}}for(let c=s;c>0;c--){let u=n[c-1];if(u.dom.parentNode==t)return u.domAtPos(u.length)}for(let c=s;c<n.length;c++){let u=n[c];if(u.dom.parentNode==t)return u.domAtPos(0)}return new Xe(t,0)}function Pe(r,e,t){let n,{children:s}=r;t>0&&e instanceof Z&&s.length&&(n=s[s.length-1])instanceof Z&&n.mark.eq(e.mark)?Pe(n,e.children[0],t-1):(s.push(e),e.setParent(r)),r.length+=e.length}function Qe(r,e,t){let n=null,s=-1,c=null,u=-1;function y(M,A){for(let F=0,$=0;F<M.children.length&&$<=A;F++){let X=M.children[F],_=$+X.length;_>=A&&(X.children.length?y(X,A-$):(!c||c.isHidden&&t>0)&&(_>A||$==_&&X.getSide()>0)?(c=X,u=A-$):($<A||$==_&&X.getSide()<0&&!X.isHidden)&&(n=X,s=A-$)),$=_}}y(r,e);let b=(t<0?n:c)||n||c;return b?b.coordsAt(Math.max(0,b==n?s:u),t):tt(r)}function tt(r){let e=r.dom.lastChild;if(!e)return r.dom.getBoundingClientRect();let t=mt(e);return t[t.length-1]||null}function dt(r,e){for(let t in r)t=="class"&&e.class?e.class+=" "+r.class:t=="style"&&e.style?e.style+=";"+r.style:e[t]=r[t];return e}const ti=Object.create(null);function qt(r,e,t){if(r==e)return!0;r||(r=ti),e||(e=ti);let n=Object.keys(r),s=Object.keys(e);if(n.length-(t&&n.indexOf(t)>-1?1:0)!=s.length-(t&&s.indexOf(t)>-1?1:0))return!1;for(let c of n)if(c!=t&&(s.indexOf(c)==-1||r[c]!==e[c]))return!1;return!0}function $t(r,e,t){let n=!1;if(e)for(let s in e)t&&s in t||(n=!0,s=="style"?r.style.cssText="":r.removeAttribute(s));if(t)for(let s in t)e&&e[s]==t[s]||(n=!0,s=="style"?r.style.cssText=t[s]:r.setAttribute(s,t[s]));return n}function jt(r){let e=Object.create(null);for(let t=0;t<r.attributes.length;t++){let n=r.attributes[t];e[n.name]=n.value}return e}class Ct extends be{constructor(){super(...arguments),this.children=[],this.length=0,this.prevAttrs=void 0,this.attrs=null,this.breakAfter=0}merge(e,t,n,s,c,u){if(n){if(!(n instanceof Ct))return!1;this.dom||n.transferDOM(this)}return s&&this.setDeco(n?n.attrs:null),zt(this,e,t,n?n.children.slice():[],c,u),!0}split(e){let t=new Ct;if(t.breakAfter=this.breakAfter,this.length==0)return t;let{i:n,off:s}=this.childPos(e);s&&(t.append(this.children[n].split(s),0),this.children[n].merge(s,this.children[n].length,null,!1,0,0),n++);for(let c=n;c<this.children.length;c++)t.append(this.children[c],0);for(;n>0&&this.children[n-1].length==0;)this.children[--n].destroy();return this.children.length=n,this.markDirty(),this.length=e,t}transferDOM(e){this.dom&&(this.markDirty(),e.setDOM(this.dom),e.prevAttrs=this.prevAttrs===void 0?this.attrs:this.prevAttrs,this.prevAttrs=void 0,this.dom=null)}setDeco(e){qt(this.attrs,e)||(this.dom&&(this.prevAttrs=this.attrs,this.markDirty()),this.attrs=e)}append(e,t){Pe(this,e,t)}addLineDeco(e){let t=e.spec.attributes,n=e.spec.class;t&&(this.attrs=dt(t,this.attrs||{})),n&&(this.attrs=dt({class:n},this.attrs||{}))}domAtPos(e){return He(this,e)}reuseDOM(e){e.nodeName=="DIV"&&(this.setDOM(e),this.flags|=6)}sync(e,t){var n;this.dom?this.flags&4&&(ei(this.dom),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0):(this.setDOM(document.createElement("div")),this.dom.className="cm-line",this.prevAttrs=this.attrs?null:void 0),this.prevAttrs!==void 0&&($t(this.dom,this.prevAttrs,this.attrs),this.dom.classList.add("cm-line"),this.prevAttrs=void 0),super.sync(e,t);let s=this.dom.lastChild;for(;s&&be.get(s)instanceof Z;)s=s.lastChild;if(!s||!this.length||s.nodeName!="BR"&&((n=be.get(s))===null||n===void 0?void 0:n.isEditable)==!1&&(!C.ios||!this.children.some(c=>c instanceof N))){let c=document.createElement("BR");c.cmIgnore=!0,this.dom.appendChild(c)}}measureTextSize(){if(this.children.length==0||this.length>20)return null;let e=0,t;for(let n of this.children){if(!(n instanceof N)||/[^ -~]/.test(n.text))return null;let s=mt(n.dom);if(s.length!=1)return null;e+=s[0].width,t=s[0].height}return e?{lineHeight:this.dom.getBoundingClientRect().height,charWidth:e/this.length,textHeight:t}:null}coordsAt(e,t){let n=Qe(this,e,t);if(!this.children.length&&n&&this.parent){let{heightOracle:s}=this.parent.view.viewState,c=n.bottom-n.top;if(Math.abs(c-s.lineHeight)<2&&s.textHeight<c){let u=(c-s.textHeight)/2;return{top:n.top+u,bottom:n.bottom-u,left:n.left,right:n.left}}}return n}become(e){return!1}covers(){return!0}static find(e,t){for(let n=0,s=0;n<e.children.length;n++){let c=e.children[n],u=s+c.length;if(u>=t){if(c instanceof Ct)return c;if(u>t)break}s=u+c.breakAfter}return null}}class Rt extends be{constructor(e,t,n){super(),this.widget=e,this.length=t,this.deco=n,this.breakAfter=0,this.prevWidget=null}merge(e,t,n,s,c,u){return n&&(!(n instanceof Rt)||!this.widget.compare(n.widget)||e>0&&c<=0||t<this.length&&u<=0)?!1:(this.length=e+(n?n.length:0)+(this.length-t),!0)}domAtPos(e){return e==0?Xe.before(this.dom):Xe.after(this.dom,e==this.length)}split(e){let t=this.length-e;this.length=e;let n=new Rt(this.widget,t,this.deco);return n.breakAfter=this.breakAfter,n}get children(){return ae}sync(e){(!this.dom||!this.widget.updateDOM(this.dom,e))&&(this.dom&&this.prevWidget&&this.prevWidget.destroy(this.dom),this.prevWidget=null,this.setDOM(this.widget.toDOM(e)),this.dom.contentEditable="false")}get overrideDOMText(){return this.parent?this.parent.view.state.doc.slice(this.posAtStart,this.posAtEnd):p.xv.empty}domBoundsAround(){return null}become(e){return e instanceof Rt&&e.widget.constructor==this.widget.constructor?(e.widget.compare(this.widget)||this.markDirty(!0),this.dom&&!this.prevWidget&&(this.prevWidget=this.widget),this.widget=e.widget,this.length=e.length,this.deco=e.deco,this.breakAfter=e.breakAfter,!0):!1}ignoreMutation(){return!0}ignoreEvent(e){return this.widget.ignoreEvent(e)}get isEditable(){return!1}get isWidget(){return!0}coordsAt(e,t){return this.widget.coordsAt(this.dom,e,t)}destroy(){super.destroy(),this.dom&&this.widget.destroy(this.dom)}covers(e){let{startSide:t,endSide:n}=this.deco;return t==n?!1:e<0?t<0:n>0}}class xi{eq(e){return!1}updateDOM(e,t){return!1}compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}get estimatedHeight(){return-1}get lineBreaks(){return 0}ignoreEvent(e){return!0}coordsAt(e,t,n){return null}get isHidden(){return!1}destroy(e){}}var st=function(r){return r[r.Text=0]="Text",r[r.WidgetBefore=1]="WidgetBefore",r[r.WidgetAfter=2]="WidgetAfter",r[r.WidgetRange=3]="WidgetRange",r}(st||(st={}));class Ye extends p.uU{constructor(e,t,n,s){super(),this.startSide=e,this.endSide=t,this.widget=n,this.spec=s}get heightRelevant(){return!1}static mark(e){return new Ve(e)}static widget(e){let t=Math.max(-1e4,Math.min(1e4,e.side||0)),n=!!e.block;return t+=n&&!e.inlineOrder?t>0?3e8:-4e8:t>0?1e8:-1e8,new ot(e,t,t,n,e.widget||null,!1)}static replace(e){let t=!!e.block,n,s;if(e.isBlockGap)n=-5e8,s=4e8;else{let{start:c,end:u}=rt(e,t);n=(c?t?-3e8:-1:5e8)-1,s=(u?t?2e8:1:-6e8)+1}return new ot(e,n,s,t,e.widget||null,!0)}static line(e){return new Jt(e)}static set(e,t=!1){return p.Xs.of(e,t)}hasHeight(){return this.widget?this.widget.estimatedHeight>-1:!1}}Ye.none=p.Xs.empty;class Ve extends Ye{constructor(e){let{start:t,end:n}=rt(e);super(t?-1:5e8,n?1:-6e8,null,e),this.tagName=e.tagName||"span",this.class=e.class||"",this.attrs=e.attributes||null}eq(e){var t,n;return this==e||e instanceof Ve&&this.tagName==e.tagName&&(this.class||((t=this.attrs)===null||t===void 0?void 0:t.class))==(e.class||((n=e.attrs)===null||n===void 0?void 0:n.class))&&qt(this.attrs,e.attrs,"class")}range(e,t=e){if(e>=t)throw new RangeError("Mark decorations may not be empty");return super.range(e,t)}}Ve.prototype.point=!1;class Jt extends Ye{constructor(e){super(-2e8,-2e8,null,e)}eq(e){return e instanceof Jt&&this.spec.class==e.spec.class&&qt(this.spec.attributes,e.spec.attributes)}range(e,t=e){if(t!=e)throw new RangeError("Line decoration ranges must be zero-length");return super.range(e,t)}}Jt.prototype.mapMode=p.gc.TrackBefore,Jt.prototype.point=!0;class ot extends Ye{constructor(e,t,n,s,c,u){super(t,n,c,e),this.block=s,this.isReplace=u,this.mapMode=s?t<=0?p.gc.TrackBefore:p.gc.TrackAfter:p.gc.TrackDel}get type(){return this.startSide!=this.endSide?st.WidgetRange:this.startSide<=0?st.WidgetBefore:st.WidgetAfter}get heightRelevant(){return this.block||!!this.widget&&(this.widget.estimatedHeight>=5||this.widget.lineBreaks>0)}eq(e){return e instanceof ot&&yt(this.widget,e.widget)&&this.block==e.block&&this.startSide==e.startSide&&this.endSide==e.endSide}range(e,t=e){if(this.isReplace&&(e>t||e==t&&this.startSide>0&&this.endSide<=0))throw new RangeError("Invalid range for replacement decoration");if(!this.isReplace&&t!=e)throw new RangeError("Widget decorations can only have zero-length ranges");return super.range(e,t)}}ot.prototype.point=!0;function rt(r,e=!1){let{inclusiveStart:t,inclusiveEnd:n}=r;return t==null&&(t=r.inclusive),n==null&&(n=r.inclusive),{start:t!=null?t:e,end:n!=null?n:e}}function yt(r,e){return r==e||!!(r&&e&&r.compare(e))}function lt(r,e,t,n=0){let s=t.length-1;s>=0&&t[s]+n>=r?t[s]=Math.max(t[s],e):t.push(r,e)}class Zt{constructor(e,t,n,s){this.doc=e,this.pos=t,this.end=n,this.disallowBlockEffectsFor=s,this.content=[],this.curLine=null,this.breakAtStart=0,this.pendingBuffer=0,this.bufferMarks=[],this.atCursorPos=!0,this.openStart=-1,this.openEnd=-1,this.text="",this.textOff=0,this.cursor=e.iter(),this.skip=t}posCovered(){if(this.content.length==0)return!this.breakAtStart&&this.doc.lineAt(this.pos).from!=this.pos;let e=this.content[this.content.length-1];return!(e.breakAfter||e instanceof Rt&&e.deco.endSide<0)}getLine(){return this.curLine||(this.content.push(this.curLine=new Ct),this.atCursorPos=!0),this.curLine}flushBuffer(e=this.bufferMarks){this.pendingBuffer&&(this.curLine.append(Bt(new xe(-1),e),e.length),this.pendingBuffer=0)}addBlockWidget(e){this.flushBuffer(),this.curLine=null,this.content.push(e)}finish(e){this.pendingBuffer&&e<=this.bufferMarks.length?this.flushBuffer():this.pendingBuffer=0,!this.posCovered()&&!(e&&this.content.length&&this.content[this.content.length-1]instanceof Rt)&&this.getLine()}buildText(e,t,n){for(;e>0;){if(this.textOff==this.text.length){let{value:c,lineBreak:u,done:y}=this.cursor.next(this.skip);if(this.skip=0,y)throw new Error("Ran out of text content when drawing inline views");if(u){this.posCovered()||this.getLine(),this.content.length?this.content[this.content.length-1].breakAfter=1:this.breakAtStart=1,this.flushBuffer(),this.curLine=null,this.atCursorPos=!0,e--;continue}else this.text=c,this.textOff=0}let s=Math.min(this.text.length-this.textOff,e,512);this.flushBuffer(t.slice(t.length-n)),this.getLine().append(Bt(new N(this.text.slice(this.textOff,this.textOff+s)),t),n),this.atCursorPos=!0,this.textOff+=s,e-=s,n=0}}span(e,t,n,s){this.buildText(t-e,n,s),this.pos=t,this.openStart<0&&(this.openStart=s)}point(e,t,n,s,c,u){if(this.disallowBlockEffectsFor[u]&&n instanceof ot){if(n.block)throw new RangeError("Block decorations may not be specified via plugins");if(t>this.doc.lineAt(this.pos).to)throw new RangeError("Decorations that replace line breaks may not be specified via plugins")}let y=t-e;if(n instanceof ot)if(n.block)n.startSide>0&&!this.posCovered()&&this.getLine(),this.addBlockWidget(new Rt(n.widget||new pt("div"),y,n));else{let b=re.create(n.widget||new pt("span"),y,y?0:n.startSide),M=this.atCursorPos&&!b.isEditable&&c<=s.length&&(e<t||n.startSide>0),A=!b.isEditable&&(e<t||c>s.length||n.startSide<=0),F=this.getLine();this.pendingBuffer==2&&!M&&!b.isEditable&&(this.pendingBuffer=0),this.flushBuffer(s),M&&(F.append(Bt(new xe(1),s),c),c=s.length+Math.max(0,c-s.length)),F.append(Bt(b,s),c),this.atCursorPos=A,this.pendingBuffer=A?e<t||c>s.length?1:2:0,this.pendingBuffer&&(this.bufferMarks=s.slice())}else this.doc.lineAt(this.pos).from==this.pos&&this.getLine().addLineDeco(n);y&&(this.textOff+y<=this.text.length?this.textOff+=y:(this.skip+=y-(this.text.length-this.textOff),this.text="",this.textOff=0),this.pos=t),this.openStart<0&&(this.openStart=c)}static build(e,t,n,s,c){let u=new Zt(e,t,n,c);return u.openEnd=p.Xs.spans(s,t,n,u),u.openStart<0&&(u.openStart=u.openEnd),u.finish(u.openEnd),u}}function Bt(r,e){for(let t of e)r=new Z(t,[r],r.length);return r}class pt extends xi{constructor(e){super(),this.tag=e}eq(e){return e.tag==this.tag}toDOM(){return document.createElement(this.tag)}updateDOM(e){return e.nodeName.toLowerCase()==this.tag}get isHidden(){return!0}}const gi=p.r$.define(),hi=p.r$.define(),yi=p.r$.define(),on=p.r$.define(),Ci=p.r$.define(),Lt=p.r$.define(),zi=p.r$.define(),Ni=p.r$.define({combine:r=>r.some(e=>e)}),qi=p.r$.define({combine:r=>r.some(e=>e)});class Ki{constructor(e,t="nearest",n="nearest",s=5,c=5,u=!1){this.range=e,this.y=t,this.x=n,this.yMargin=s,this.xMargin=c,this.isSnapshot=u}map(e){return e.empty?this:new Ki(this.range.map(e),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}clip(e){return this.range.to<=e.doc.length?this:new Ki(p.jT.cursor(e.doc.length),this.y,this.x,this.yMargin,this.xMargin,this.isSnapshot)}}const Qi=p.Py.define({map:(r,e)=>r.map(e)});function ri(r,e,t){let n=r.facet(on);n.length?n[0](e):window.onerror?window.onerror(String(e),t,void 0,void 0,e):t?console.error(t+":",e):console.error(e)}const Ji=p.r$.define({combine:r=>r.length?r[0]:!0});let Vn=0;const fn=p.r$.define();class vi{constructor(e,t,n,s,c){this.id=e,this.create=t,this.domEventHandlers=n,this.domEventObservers=s,this.extension=c(this)}static define(e,t){const{eventHandlers:n,eventObservers:s,provide:c,decorations:u}=t||{};return new vi(Vn++,e,n,s,y=>{let b=[fn.of(y)];return u&&b.push(On.of(M=>{let A=M.plugin(y);return A?u(A):Ye.none})),c&&b.push(c(y)),b})}static fromClass(e,t){return vi.define(n=>new e(n),t)}}class kn{constructor(e){this.spec=e,this.mustUpdate=null,this.value=null}update(e){if(this.value){if(this.mustUpdate){let t=this.mustUpdate;if(this.mustUpdate=null,this.value.update)try{this.value.update(t)}catch(n){if(ri(t.state,n,"CodeMirror plugin crashed"),this.value.destroy)try{this.value.destroy()}catch{}this.deactivate()}}}else if(this.spec)try{this.value=this.spec.create(e)}catch(t){ri(e.state,t,"CodeMirror plugin crashed"),this.deactivate()}return this}destroy(e){var t;if(!((t=this.value)===null||t===void 0)&&t.destroy)try{this.value.destroy()}catch(n){ri(e.state,n,"CodeMirror plugin crashed")}}deactivate(){this.spec=this.value=null}}const Cn=p.r$.define(),ns=p.r$.define(),On=p.r$.define(),R=p.r$.define(),a=p.r$.define();function d(r,e,t){let n=r.state.facet(a);if(!n.length)return n;let s=n.map(u=>u instanceof Function?u(r):u),c=[];return p.Xs.spans(s,e,t,{point(){},span(u,y,b,M){let A=c;for(let F=b.length-1;F>=0;F--,M--){let $=b[F].spec.bidiIsolate,X;if($!=null)if(M>0&&A.length&&(X=A[A.length-1]).to==u&&X.direction==$)X.to=y,A=X.inner;else{let _={from:u,to:y,direction:$,inner:[]};A.push(_),A=_.inner}}}}),c}const v=p.r$.define();function w(r){let e=0,t=0,n=0,s=0;for(let c of r.state.facet(v)){let u=c(r);u&&(u.left!=null&&(e=Math.max(e,u.left)),u.right!=null&&(t=Math.max(t,u.right)),u.top!=null&&(n=Math.max(n,u.top)),u.bottom!=null&&(s=Math.max(s,u.bottom)))}return{left:e,right:t,top:n,bottom:s}}const E=p.r$.define();class D{constructor(e,t,n,s){this.fromA=e,this.toA=t,this.fromB=n,this.toB=s}join(e){return new D(Math.min(this.fromA,e.fromA),Math.max(this.toA,e.toA),Math.min(this.fromB,e.fromB),Math.max(this.toB,e.toB))}addToSet(e){let t=e.length,n=this;for(;t>0;t--){let s=e[t-1];if(!(s.fromA>n.toA)){if(s.toA<n.fromA)break;n=n.join(s),e.splice(t-1,1)}}return e.splice(t,0,n),e}static extendWithRanges(e,t){if(t.length==0)return e;let n=[];for(let s=0,c=0,u=0,y=0;;s++){let b=s==e.length?null:e[s],M=u-y,A=b?b.fromB:1e9;for(;c<t.length&&t[c]<A;){let F=t[c],$=t[c+1],X=Math.max(y,F),_=Math.min(A,$);if(X<=_&&new D(X+M,_+M,X,_).addToSet(n),$>A)break;c+=2}if(!b)return n;new D(b.fromA,b.toA,b.fromB,b.toB).addToSet(n),u=b.toA,y=b.toB}}}class H{constructor(e,t,n){this.view=e,this.state=t,this.transactions=n,this.flags=0,this.startState=e.state,this.changes=p.as.empty(this.startState.doc.length);for(let c of n)this.changes=this.changes.compose(c.changes);let s=[];this.changes.iterChangedRanges((c,u,y,b)=>s.push(new D(c,u,y,b))),this.changedRanges=s}static create(e,t,n){return new H(e,t,n)}get viewportChanged(){return(this.flags&4)>0}get heightChanged(){return(this.flags&2)>0}get geometryChanged(){return this.docChanged||(this.flags&10)>0}get focusChanged(){return(this.flags&1)>0}get docChanged(){return!this.changes.empty}get selectionSet(){return this.transactions.some(e=>e.selection)}get empty(){return this.flags==0&&this.transactions.length==0}}var j=function(r){return r[r.LTR=0]="LTR",r[r.RTL=1]="RTL",r}(j||(j={}));const ne=j.LTR,fe=j.RTL;function ye(r){let e=[];for(let t=0;t<r.length;t++)e.push(1<<+r[t]);return e}const Ne=ye("88888888888888888888888888888888888666888888787833333333337888888000000000000000000000000008888880000000000000000000000000088888888888888888888888888888888888887866668888088888663380888308888800000000000000000000000800000000000000000000000000000008"),Be=ye("4444448826627288999999999992222222222222222222222222222222222222222222222229999999999999999999994444444444644222822222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222222999999949999999229989999223333333333"),Ut=Object.create(null),di=[];for(let r of["()","[]","{}"]){let e=r.charCodeAt(0),t=r.charCodeAt(1);Ut[e]=t,Ut[t]=-e}function pi(r){return r<=247?Ne[r]:1424<=r&&r<=1524?2:1536<=r&&r<=1785?Be[r-1536]:1774<=r&&r<=2220?4:8192<=r&&r<=8204?256:64336<=r&&r<=65023?4:1}const zn=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac\ufb50-\ufdff]/;class mn{get dir(){return this.level%2?fe:ne}constructor(e,t,n){this.from=e,this.to=t,this.level=n}side(e,t){return this.dir==t==e?this.to:this.from}static find(e,t,n,s){let c=-1;for(let u=0;u<e.length;u++){let y=e[u];if(y.from<=t&&y.to>=t){if(y.level==n)return u;(c<0||(s!=0?s<0?y.from<t:y.to>t:e[c].level>y.level))&&(c=u)}}if(c<0)throw new RangeError("Index out of range");return c}}function Pn(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++){let n=r[t],s=e[t];if(n.from!=s.from||n.to!=s.to||n.direction!=s.direction||!Pn(n.inner,s.inner))return!1}return!0}const Gt=[];function Rs(r,e,t,n,s){for(let c=0;c<=n.length;c++){let u=c?n[c-1].to:e,y=c<n.length?n[c].from:t,b=c?256:s;for(let M=u,A=b,F=b;M<y;M++){let $=pi(r.charCodeAt(M));$==512?$=A:$==8&&F==4&&($=16),Gt[M]=$==4?2:$,$&7&&(F=$),A=$}for(let M=u,A=b,F=b;M<y;M++){let $=Gt[M];if($==128)M<y-1&&A==Gt[M+1]&&A&24?$=Gt[M]=A:Gt[M]=256;else if($==64){let X=M+1;for(;X<y&&Gt[X]==64;)X++;let _=M&&A==8||X<t&&Gt[X]==8?F==1?1:8:256;for(let le=M;le<X;le++)Gt[le]=_;M=X-1}else $==8&&F==1&&(Gt[M]=1);A=$,$&7&&(F=$)}}}function Bs(r,e,t,n,s){let c=s==1?2:1;for(let u=0,y=0,b=0;u<=n.length;u++){let M=u?n[u-1].to:e,A=u<n.length?n[u].from:t;for(let F=M,$,X,_;F<A;F++)if(X=Ut[$=r.charCodeAt(F)])if(X<0){for(let le=y-3;le>=0;le-=3)if(di[le+1]==-X){let se=di[le+2],de=se&2?s:se&4?se&1?c:s:0;de&&(Gt[F]=Gt[di[le]]=de),y=le;break}}else{if(di.length==189)break;di[y++]=F,di[y++]=$,di[y++]=b}else if((_=Gt[F])==2||_==1){let le=_==s;b=le?0:1;for(let se=y-3;se>=0;se-=3){let de=di[se+2];if(de&2)break;if(le)di[se+2]|=2;else{if(de&4)break;di[se+2]|=4}}}}}function qs(r,e,t,n){for(let s=0,c=n;s<=t.length;s++){let u=s?t[s-1].to:r,y=s<t.length?t[s].from:e;for(let b=u;b<y;){let M=Gt[b];if(M==256){let A=b+1;for(;;)if(A==y){if(s==t.length)break;A=t[s++].to,y=s<t.length?t[s].from:e}else if(Gt[A]==256)A++;else break;let F=c==1,$=(A<e?Gt[A]:n)==1,X=F==$?F?1:2:n;for(let _=A,le=s,se=le?t[le-1].to:r;_>b;)_==se&&(_=t[--le].from,se=le?t[le-1].to:r),Gt[--_]=X;b=A}else c=M,b++}}}function vs(r,e,t,n,s,c,u){let y=n%2?2:1;if(n%2==s%2)for(let b=e,M=0;b<t;){let A=!0,F=!1;if(M==c.length||b<c[M].from){let le=Gt[b];le!=y&&(A=!1,F=le==16)}let $=!A&&y==1?[]:null,X=A?n:n+1,_=b;e:for(;;)if(M<c.length&&_==c[M].from){if(F)break e;let le=c[M];if(!A)for(let se=le.to,de=M+1;;){if(se==t)break e;if(de<c.length&&c[de].from==se)se=c[de++].to;else{if(Gt[se]==y)break e;break}}if(M++,$)$.push(le);else{le.from>b&&u.push(new mn(b,le.from,X));let se=le.direction==ne!=!(X%2);Ls(r,se?n+1:n,s,le.inner,le.from,le.to,u),b=le.to}_=le.to}else{if(_==t||(A?Gt[_]!=y:Gt[_]==y))break;_++}$?vs(r,b,_,n+1,s,$,u):b<_&&u.push(new mn(b,_,X)),b=_}else for(let b=t,M=c.length;b>e;){let A=!0,F=!1;if(!M||b>c[M-1].to){let le=Gt[b-1];le!=y&&(A=!1,F=le==16)}let $=!A&&y==1?[]:null,X=A?n:n+1,_=b;e:for(;;)if(M&&_==c[M-1].to){if(F)break e;let le=c[--M];if(!A)for(let se=le.from,de=M;;){if(se==e)break e;if(de&&c[de-1].to==se)se=c[--de].from;else{if(Gt[se-1]==y)break e;break}}if($)$.push(le);else{le.to<b&&u.push(new mn(le.to,b,X));let se=le.direction==ne!=!(X%2);Ls(r,se?n+1:n,s,le.inner,le.from,le.to,u),b=le.from}_=le.from}else{if(_==e||(A?Gt[_-1]!=y:Gt[_-1]==y))break;_--}$?vs(r,_,b,n+1,s,$,u):_<b&&u.push(new mn(_,b,X)),b=_}}function Ls(r,e,t,n,s,c,u){let y=e%2?2:1;Rs(r,s,c,n,y),Bs(r,s,c,n,y),qs(s,c,n,y),vs(r,s,c,e,t,n,u)}function bs(r,e,t){if(!r)return[new mn(0,0,e==fe?1:0)];if(e==ne&&!t.length&&!zn.test(r))return An(r.length);if(t.length)for(;r.length>Gt.length;)Gt[Gt.length]=256;let n=[],s=e==ne?0:1;return Ls(r,s,s,t,0,r.length,n),n}function An(r){return[new mn(0,r,0)]}let ss="";function O(r,e,t,n,s){var c;let u=n.head-r.from,y=-1;if(u==0){if(!s||!r.length)return null;e[0].level!=t&&(u=e[0].side(!1,t),y=0)}else if(u==r.length){if(s)return null;let $=e[e.length-1];$.level!=t&&(u=$.side(!0,t),y=e.length-1)}y<0&&(y=mn.find(e,u,(c=n.bidiLevel)!==null&&c!==void 0?c:-1,n.assoc));let b=e[y];u==b.side(s,t)&&(b=e[y+=s?1:-1],u=b.side(!s,t));let M=s==(b.dir==t),A=(0,p.cp)(r.text,u,M);if(ss=r.text.slice(Math.min(u,A),Math.max(u,A)),A>b.from&&A<b.to)return p.jT.cursor(A+r.from,M?-1:1,b.level);let F=y==(s?e.length-1:0)?null:e[y+(s?1:-1)];return!F&&b.level!=t?p.jT.cursor(s?r.to:r.from,s?-1:1,t):F&&F.level<b.level?p.jT.cursor(F.side(!s,t)+r.from,s?1:-1,F.level):p.jT.cursor(A+r.from,s?-1:1,b.level)}class g extends be{get length(){return this.view.state.doc.length}constructor(e){super(),this.view=e,this.decorations=[],this.dynamicDecorationMap=[],this.domChanged=null,this.hasComposition=null,this.markedForComposition=new Set,this.minWidth=0,this.minWidthFrom=0,this.minWidthTo=0,this.impreciseAnchor=null,this.impreciseHead=null,this.forceSelection=!1,this.lastUpdate=Date.now(),this.setDOM(e.contentDOM),this.children=[new Ct],this.children[0].setParent(this),this.updateDeco(),this.updateInner([new D(0,0,0,e.state.doc.length)],0,null)}update(e){var t;let n=e.changedRanges;this.minWidth>0&&n.length&&(n.every(({fromA:M,toA:A})=>A<this.minWidthFrom||M>this.minWidthTo)?(this.minWidthFrom=e.changes.mapPos(this.minWidthFrom,1),this.minWidthTo=e.changes.mapPos(this.minWidthTo,1)):this.minWidth=this.minWidthFrom=this.minWidthTo=0);let s=-1;this.view.inputState.composing>=0&&(!((t=this.domChanged)===null||t===void 0)&&t.newSel?s=this.domChanged.newSel.head:!Wt(e.changes,this.hasComposition)&&!e.selectionSet&&(s=e.state.selection.main.head));let c=s>-1?K(this.view,e.changes,s):null;if(this.domChanged=null,this.hasComposition){this.markedForComposition.clear();let{from:M,to:A}=this.hasComposition;n=new D(M,A,e.changes.mapPos(M,-1),e.changes.mapPos(A,1)).addToSet(n.slice())}this.hasComposition=c?{from:c.range.fromB,to:c.range.toB}:null,(C.ie||C.chrome)&&!c&&e&&e.state.doc.lines!=e.startState.doc.lines&&(this.forceSelection=!0);let u=this.decorations,y=this.updateDeco(),b=De(u,y,e.changes);return n=D.extendWithRanges(n,b),!(this.flags&7)&&n.length==0?!1:(this.updateInner(n,e.startState.doc.length,c),e.transactions.length&&(this.lastUpdate=Date.now()),!0)}updateInner(e,t,n){this.view.viewState.mustMeasureContent=!0,this.updateChildren(e,t,n);let{observer:s}=this.view;s.ignore(()=>{this.dom.style.height=this.view.viewState.contentHeight/this.view.scaleY+"px",this.dom.style.flexBasis=this.minWidth?this.minWidth+"px":"";let u=C.chrome||C.ios?{node:s.selectionRange.focusNode,written:!1}:void 0;this.sync(this.view,u),this.flags&=-8,u&&(u.written||s.selectionRange.focusNode!=u.node)&&(this.forceSelection=!0),this.dom.style.height=""}),this.markedForComposition.forEach(u=>u.flags&=-9);let c=[];if(this.view.viewport.from||this.view.viewport.to<this.view.state.doc.length)for(let u of this.children)u instanceof Rt&&u.widget instanceof P&&c.push(u.dom);s.updateGaps(c)}updateChildren(e,t,n){let s=n?n.range.addToSet(e.slice()):e,c=this.childCursor(t);for(let u=s.length-1;;u--){let y=u>=0?s[u]:null;if(!y)break;let{fromA:b,toA:M,fromB:A,toB:F}=y,$,X,_,le;if(n&&n.range.fromB<F&&n.range.toB>A){let Ue=Zt.build(this.view.state.doc,A,n.range.fromB,this.decorations,this.dynamicDecorationMap),at=Zt.build(this.view.state.doc,n.range.toB,F,this.decorations,this.dynamicDecorationMap);X=Ue.breakAtStart,_=Ue.openStart,le=at.openEnd;let kt=this.compositionView(n);at.breakAtStart?kt.breakAfter=1:at.content.length&&kt.merge(kt.length,kt.length,at.content[0],!1,at.openStart,0)&&(kt.breakAfter=at.content[0].breakAfter,at.content.shift()),Ue.content.length&&kt.merge(0,0,Ue.content[Ue.content.length-1],!0,0,Ue.openEnd)&&Ue.content.pop(),$=Ue.content.concat(kt).concat(at.content)}else({content:$,breakAtStart:X,openStart:_,openEnd:le}=Zt.build(this.view.state.doc,A,F,this.decorations,this.dynamicDecorationMap));let{i:se,off:de}=c.findPos(M,1),{i:Je,off:ht}=c.findPos(b,-1);Ee(this,Je,ht,se,de,$,X,_,le)}n&&this.fixCompositionDOM(n)}compositionView(e){let t=new N(e.text.nodeValue);t.flags|=8;for(let{deco:s}of e.marks)t=new Z(s,[t],t.length);let n=new Ct;return n.append(t,0),n}fixCompositionDOM(e){let t=(c,u)=>{u.flags|=8|(u.children.some(b=>b.flags&7)?1:0),this.markedForComposition.add(u);let y=be.get(c);y&&y!=u&&(y.dom=null),u.setDOM(c)},n=this.childPos(e.range.fromB,1),s=this.children[n.i];t(e.line,s);for(let c=e.marks.length-1;c>=-1;c--)n=s.childPos(n.off,1),s=s.children[n.i],t(c>=0?e.marks[c].node:e.text,s)}updateSelection(e=!1,t=!1){(e||!this.view.observer.selectionRange.focusNode)&&this.view.observer.readSelectionRange();let n=this.view.root.activeElement,s=n==this.dom,c=!s&&_e(this.dom,this.view.observer.selectionRange)&&!(n&&this.dom.contains(n));if(!(s||t||c))return;let u=this.forceSelection;this.forceSelection=!1;let y=this.view.state.selection.main,b=this.moveToLine(this.domAtPos(y.anchor)),M=y.empty?b:this.moveToLine(this.domAtPos(y.head));if(C.gecko&&y.empty&&!this.hasComposition&&S(b)){let F=document.createTextNode("");this.view.observer.ignore(()=>b.node.insertBefore(F,b.node.childNodes[b.offset]||null)),b=M=new Xe(F,0),u=!0}let A=this.view.observer.selectionRange;(u||!A.focusNode||!mi(b.node,b.offset,A.anchorNode,A.anchorOffset)||!mi(M.node,M.offset,A.focusNode,A.focusOffset))&&(this.view.observer.ignore(()=>{C.android&&C.chrome&&this.dom.contains(A.focusNode)&&je(A.focusNode,this.dom)&&(this.dom.blur(),this.dom.focus({preventScroll:!0}));let F=xt(this.view.root);if(F)if(y.empty){if(C.gecko){let $=he(b.node,b.offset);if($&&$!=3){let X=U(b.node,b.offset,$==1?1:-1);X&&(b=new Xe(X.node,X.offset))}}F.collapse(b.node,b.offset),y.bidiLevel!=null&&F.caretBidiLevel!==void 0&&(F.caretBidiLevel=y.bidiLevel)}else if(F.extend){F.collapse(b.node,b.offset);try{F.extend(M.node,M.offset)}catch{}}else{let $=document.createRange();y.anchor>y.head&&([b,M]=[M,b]),$.setEnd(M.node,M.offset),$.setStart(b.node,b.offset),F.removeAllRanges(),F.addRange($)}c&&this.view.root.activeElement==this.dom&&(this.dom.blur(),n&&n.focus())}),this.view.observer.setSelectionRange(b,M)),this.impreciseAnchor=b.precise?null:new Xe(A.anchorNode,A.anchorOffset),this.impreciseHead=M.precise?null:new Xe(A.focusNode,A.focusOffset)}enforceCursorAssoc(){if(this.hasComposition)return;let{view:e}=this,t=e.state.selection.main,n=xt(e.root),{anchorNode:s,anchorOffset:c}=e.observer.selectionRange;if(!n||!t.empty||!t.assoc||!n.modify)return;let u=Ct.find(this,t.head);if(!u)return;let y=u.posAtStart;if(t.head==y||t.head==y+u.length)return;let b=this.coordsAt(t.head,-1),M=this.coordsAt(t.head,1);if(!b||!M||b.bottom>M.top)return;let A=this.domAtPos(t.head+t.assoc);n.collapse(A.node,A.offset),n.modify("move",t.assoc<0?"forward":"backward","lineboundary"),e.observer.readSelectionRange();let F=e.observer.selectionRange;e.docView.posFromDOM(F.anchorNode,F.anchorOffset)!=t.from&&n.collapse(s,c)}moveToLine(e){let t=this.dom,n;if(e.node!=t)return e;for(let s=e.offset;!n&&s<t.childNodes.length;s++){let c=be.get(t.childNodes[s]);c instanceof Ct&&(n=c.domAtPos(0))}for(let s=e.offset-1;!n&&s>=0;s--){let c=be.get(t.childNodes[s]);c instanceof Ct&&(n=c.domAtPos(c.length))}return n?new Xe(n.node,n.offset,!0):e}nearest(e){for(let t=e;t;){let n=be.get(t);if(n&&n.rootView==this)return n;t=t.parentNode}return null}posFromDOM(e,t){let n=this.nearest(e);if(!n)throw new RangeError("Trying to find position for a DOM position outside of the document");return n.localPosFromDOM(e,t)+n.posAtStart}domAtPos(e){let{i:t,off:n}=this.childCursor().findPos(e,-1);for(;t<this.children.length-1;){let s=this.children[t];if(n<s.length||s instanceof Ct)break;t++,n=0}return this.children[t].domAtPos(n)}coordsAt(e,t){let n=null,s=0;for(let c=this.length,u=this.children.length-1;u>=0;u--){let y=this.children[u],b=c-y.breakAfter,M=b-y.length;if(b<e)break;M<=e&&(M<e||y.covers(-1))&&(b>e||y.covers(1))&&(!n||y instanceof Ct&&!(n instanceof Ct&&t>=0))&&(n=y,s=M),c=M}return n?n.coordsAt(e-s,t):null}coordsForChar(e){let{i:t,off:n}=this.childPos(e,1),s=this.children[t];if(!(s instanceof Ct))return null;for(;s.children.length;){let{i:y,off:b}=s.childPos(n,1);for(;;y++){if(y==s.children.length)return null;if((s=s.children[y]).length)break}n=b}if(!(s instanceof N))return null;let c=(0,p.cp)(s.text,n);if(c==n)return null;let u=wt(s.dom,n,c).getClientRects();for(let y=0;y<u.length;y++){let b=u[y];if(y==u.length-1||b.top<b.bottom&&b.left<b.right)return b}return null}measureVisibleLineHeights(e){let t=[],{from:n,to:s}=e,c=this.view.contentDOM.clientWidth,u=c>Math.max(this.view.scrollDOM.clientWidth,this.minWidth)+1,y=-1,b=this.view.textDirection==j.LTR;for(let M=0,A=0;A<this.children.length;A++){let F=this.children[A],$=M+F.length;if($>s)break;if(M>=n){let X=F.dom.getBoundingClientRect();if(t.push(X.height),u){let _=F.dom.lastChild,le=_?mt(_):[];if(le.length){let se=le[le.length-1],de=b?se.right-X.left:X.right-se.left;de>y&&(y=de,this.minWidth=c,this.minWidthFrom=M,this.minWidthTo=$)}}}M=$+F.breakAfter}return t}textDirectionAt(e){let{i:t}=this.childPos(e,1);return getComputedStyle(this.children[t].dom).direction=="rtl"?j.RTL:j.LTR}measureTextSize(){for(let c of this.children)if(c instanceof Ct){let u=c.measureTextSize();if(u)return u}let e=document.createElement("div"),t,n,s;return e.className="cm-line",e.style.width="99999px",e.style.position="absolute",e.textContent="abc def ghi jkl mno pqr stu",this.view.observer.ignore(()=>{this.dom.appendChild(e);let c=mt(e.firstChild)[0];t=e.getBoundingClientRect().height,n=c?c.width/27:7,s=c?c.height:t,e.remove()}),{lineHeight:t,charWidth:n,textHeight:s}}childCursor(e=this.length){let t=this.children.length;return t&&(e-=this.children[--t].length),new ke(this.children,e,t)}computeBlockGapDeco(){let e=[],t=this.view.viewState;for(let n=0,s=0;;s++){let c=s==t.viewports.length?null:t.viewports[s],u=c?c.from-1:this.length;if(u>n){let y=(t.lineBlockAt(u).bottom-t.lineBlockAt(n).top)/this.view.scaleY;e.push(Ye.replace({widget:new P(y),block:!0,inclusive:!0,isBlockGap:!0}).range(n,u))}if(!c)break;n=c.to+1}return Ye.set(e)}updateDeco(){let e=this.view.state.facet(On).map((t,n)=>(this.dynamicDecorationMap[n]=typeof t=="function")?t(this.view):t);for(let t=e.length;t<e.length+3;t++)this.dynamicDecorationMap[t]=!1;return this.decorations=[...e,this.computeBlockGapDeco(),this.view.viewState.lineGapDeco]}scrollIntoView(e){if(e.isSnapshot){let M=this.view.viewState.lineBlockAt(e.range.head);this.view.scrollDOM.scrollTop=M.top-e.yMargin,this.view.scrollDOM.scrollLeft=e.xMargin;return}let{range:t}=e,n=this.coordsAt(t.head,t.empty?t.assoc:t.head>t.anchor?-1:1),s;if(!n)return;!t.empty&&(s=this.coordsAt(t.anchor,t.anchor>t.head?-1:1))&&(n={left:Math.min(n.left,s.left),top:Math.min(n.top,s.top),right:Math.max(n.right,s.right),bottom:Math.max(n.bottom,s.bottom)});let c=w(this.view),u={left:n.left-c.left,top:n.top-c.top,right:n.right+c.right,bottom:n.bottom+c.bottom},{offsetWidth:y,offsetHeight:b}=this.view.scrollDOM;Et(this.view.scrollDOM,u,t.head<t.anchor?-1:1,e.x,e.y,Math.max(Math.min(e.xMargin,y),-y),Math.max(Math.min(e.yMargin,b),-b),this.view.textDirection==j.LTR)}}function S(r){return r.node.nodeType==1&&r.node.firstChild&&(r.offset==0||r.node.childNodes[r.offset-1].contentEditable=="false")&&(r.offset==r.node.childNodes.length||r.node.childNodes[r.offset].contentEditable=="false")}class P extends xi{constructor(e){super(),this.height=e}toDOM(){let e=document.createElement("div");return this.updateDOM(e),e}eq(e){return e.height==this.height}updateDOM(e){return e.style.height=this.height+"px",!0}get estimatedHeight(){return this.height}}function W(r,e){let t=r.observer.selectionRange,n=t.focusNode&&U(t.focusNode,t.focusOffset,0);if(!n)return null;let s=e-n.offset;return{from:s,to:s+n.node.nodeValue.length,node:n.node}}function K(r,e,t){let n=W(r,t);if(!n)return null;let{node:s,from:c,to:u}=n,y=s.nodeValue;if(/[\n\r]/.test(y)||r.state.doc.sliceString(n.from,n.to)!=y)return null;let b=e.invertedDesc,M=new D(b.mapPos(c),b.mapPos(u),c,u),A=[];for(let F=s.parentNode;;F=F.parentNode){let $=be.get(F);if($ instanceof Z)A.push({node:F,deco:$.mark});else{if($ instanceof Ct||F.nodeName=="DIV"&&F.parentNode==r.contentDOM)return{range:M,text:s,marks:A,line:F};if(F!=r.contentDOM)A.push({node:F,deco:new Ve({inclusive:!0,attributes:jt(F),tagName:F.tagName.toLowerCase()})});else return null}}}function U(r,e,t){if(t<=0)for(let n=r,s=e;;){if(n.nodeType==3)return{node:n,offset:s};if(n.nodeType==1&&s>0)n=n.childNodes[s-1],s=ut(n);else break}if(t>=0)for(let n=r,s=e;;){if(n.nodeType==3)return{node:n,offset:s};if(n.nodeType==1&&s<n.childNodes.length&&t>=0)n=n.childNodes[s],s=0;else break}return null}function he(r,e){return r.nodeType!=1?0:(e&&r.childNodes[e-1].contentEditable=="false"?1:0)|(e<r.childNodes.length&&r.childNodes[e].contentEditable=="false"?2:0)}let oe=class{constructor(){this.changes=[]}compareRange(e,t){lt(e,t,this.changes)}comparePoint(e,t){lt(e,t,this.changes)}};function De(r,e,t){let n=new oe;return p.Xs.compare(r,e,t,n),n.changes}function je(r,e){for(let t=r;t&&t!=e;t=t.assignedSlot||t.parentNode)if(t.nodeType==1&&t.contentEditable=="false")return!0;return!1}function Wt(r,e){let t=!1;return e&&r.iterChangedRanges((n,s)=>{n<e.to&&s>e.from&&(t=!0)}),t}function Ui(r,e,t=1){let n=r.charCategorizer(e),s=r.doc.lineAt(e),c=e-s.from;if(s.length==0)return p.jT.cursor(e);c==0?t=1:c==s.length&&(t=-1);let u=c,y=c;t<0?u=(0,p.cp)(s.text,c,!1):y=(0,p.cp)(s.text,c);let b=n(s.text.slice(u,y));for(;u>0;){let M=(0,p.cp)(s.text,u,!1);if(n(s.text.slice(M,u))!=b)break;u=M}for(;y<s.length;){let M=(0,p.cp)(s.text,y);if(n(s.text.slice(y,M))!=b)break;y=M}return p.jT.range(u+s.from,y+s.from)}function Ei(r,e){return e.left>r?e.left-r:Math.max(0,r-e.right)}function gn(r,e){return e.top>r?e.top-r:Math.max(0,r-e.bottom)}function Tn(r,e){return r.top<e.bottom-1&&r.bottom>e.top+1}function Qs(r,e){return e<r.top?{top:e,left:r.left,right:r.right,bottom:r.bottom}:r}function $n(r,e){return e>r.bottom?{top:r.top,left:r.left,right:r.right,bottom:e}:r}function Ht(r,e,t){let n,s,c,u,y=!1,b,M,A,F;for(let _=r.firstChild;_;_=_.nextSibling){let le=mt(_);for(let se=0;se<le.length;se++){let de=le[se];s&&Tn(s,de)&&(de=Qs($n(de,s.bottom),s.top));let Je=Ei(e,de),ht=gn(t,de);if(Je==0&&ht==0)return _.nodeType==3?Mn(_,e,t):Ht(_,e,t);if(!n||u>ht||u==ht&&c>Je){n=_,s=de,c=Je,u=ht;let Ue=ht?t<de.top?-1:1:Je?e<de.left?-1:1:0;y=!Ue||(Ue>0?se<le.length-1:se>0)}Je==0?t>de.bottom&&(!A||A.bottom<de.bottom)?(b=_,A=de):t<de.top&&(!F||F.top>de.top)&&(M=_,F=de):A&&Tn(A,de)?A=$n(A,de.bottom):F&&Tn(F,de)&&(F=Qs(F,de.top))}}if(A&&A.bottom>=t?(n=b,s=A):F&&F.top<=t&&(n=M,s=F),!n)return{node:r,offset:0};let $=Math.max(s.left,Math.min(s.right,e));if(n.nodeType==3)return Mn(n,$,t);if(y&&n.contentEditable!="false")return Ht(n,$,t);let X=Array.prototype.indexOf.call(r.childNodes,n)+(e>=(s.left+s.right)/2?1:0);return{node:r,offset:X}}function Mn(r,e,t){let n=r.nodeValue.length,s=-1,c=1e9,u=0;for(let y=0;y<n;y++){let b=wt(r,y,y+1).getClientRects();for(let M=0;M<b.length;M++){let A=b[M];if(A.top==A.bottom)continue;u||(u=e-A.left);let F=(A.top>t?A.top-t:t-A.bottom)-1;if(A.left-1<=e&&A.right+1>=e&&F<c){let $=e>=(A.left+A.right)/2,X=$;if((C.chrome||C.gecko)&&wt(r,y).getBoundingClientRect().left==A.right&&(X=!$),F<=0)return{node:r,offset:y+(X?1:0)};s=y+(X?1:0),c=F}}}return{node:r,offset:s>-1?s:u>0?r.nodeValue.length:0}}function Sn(r,e,t,n=-1){var s,c;let u=r.contentDOM.getBoundingClientRect(),y=u.top+r.viewState.paddingTop,b,{docHeight:M}=r.viewState,{x:A,y:F}=e,$=F-y;if($<0)return 0;if($>M)return r.state.doc.length;for(let Ue=r.viewState.heightOracle.textHeight/2,at=!1;b=r.elementAtHeight($),b.type!=st.Text;)for(;$=n>0?b.bottom+Ue:b.top-Ue,!($>=0&&$<=M);){if(at)return t?null:0;at=!0,n=-n}F=y+$;let X=b.from;if(X<r.viewport.from)return r.viewport.from==0?0:t?null:xs(r,u,b,A,F);if(X>r.viewport.to)return r.viewport.to==r.state.doc.length?r.state.doc.length:t?null:xs(r,u,b,A,F);let _=r.dom.ownerDocument,le=r.root.elementFromPoint?r.root:_,se=le.elementFromPoint(A,F);se&&!r.contentDOM.contains(se)&&(se=null),se||(A=Math.max(u.left+1,Math.min(u.right-1,A)),se=le.elementFromPoint(A,F),se&&!r.contentDOM.contains(se)&&(se=null));let de,Je=-1;if(se&&((s=r.docView.nearest(se))===null||s===void 0?void 0:s.isEditable)!=!1){if(_.caretPositionFromPoint){let Ue=_.caretPositionFromPoint(A,F);Ue&&({offsetNode:de,offset:Je}=Ue)}else if(_.caretRangeFromPoint){let Ue=_.caretRangeFromPoint(A,F);Ue&&({startContainer:de,startOffset:Je}=Ue,(!r.contentDOM.contains(de)||C.safari&&rs(de,Je,A)||C.chrome&&un(de,Je,A))&&(de=void 0))}}if(!de||!r.docView.dom.contains(de)){let Ue=Ct.find(r.docView,X);if(!Ue)return $>b.top+b.height/2?b.to:b.from;({node:de,offset:Je}=Ht(Ue.dom,A,F))}let ht=r.docView.nearest(de);if(!ht)return null;if(ht.isWidget&&((c=ht.dom)===null||c===void 0?void 0:c.nodeType)==1){let Ue=ht.dom.getBoundingClientRect();return e.y<Ue.top||e.y<=Ue.bottom&&e.x<=(Ue.left+Ue.right)/2?ht.posAtStart:ht.posAtEnd}else return ht.localPosFromDOM(de,Je)+ht.posAtStart}function xs(r,e,t,n,s){let c=Math.round((n-e.left)*r.defaultCharacterWidth);if(r.lineWrapping&&t.height>r.defaultLineHeight*1.5){let y=r.viewState.heightOracle.textHeight,b=Math.floor((s-t.top-(r.defaultLineHeight-y)*.5)/y);c+=b*r.viewState.heightOracle.lineLength}let u=r.state.sliceDoc(t.from,t.to);return t.from+(0,p.Gz)(u,c,r.state.tabSize)}function rs(r,e,t){let n;if(r.nodeType!=3||e!=(n=r.nodeValue.length))return!1;for(let s=r.nextSibling;s;s=s.nextSibling)if(s.nodeType!=1||s.nodeName!="BR")return!1;return wt(r,n-1,n).getBoundingClientRect().left>t}function un(r,e,t){if(e!=0)return!1;for(let s=r;;){let c=s.parentNode;if(!c||c.nodeType!=1||c.firstChild!=s)return!1;if(c.classList.contains("cm-line"))break;s=c}let n=r.nodeType==1?r.getBoundingClientRect():wt(r,0,Math.max(r.nodeValue.length,1)).getBoundingClientRect();return t-n.left>5}function jn(r,e){let t=r.lineBlockAt(e);if(Array.isArray(t.type)){for(let n of t.type)if(n.to>e||n.to==e&&(n.to==t.to||n.type==st.Text))return n}return t}function Is(r,e,t,n){let s=jn(r,e.head),c=!n||s.type!=st.Text||!(r.lineWrapping||s.widgetLineBreaks)?null:r.coordsAtPos(e.assoc<0&&e.head>s.from?e.head-1:e.head);if(c){let u=r.dom.getBoundingClientRect(),y=r.textDirectionAt(s.from),b=r.posAtCoords({x:t==(y==j.LTR)?u.right-1:u.left+1,y:(c.top+c.bottom)/2});if(b!=null)return p.jT.cursor(b,t?-1:1)}return p.jT.cursor(t?s.to:s.from,t?-1:1)}function Zn(r,e,t,n){let s=r.state.doc.lineAt(e.head),c=r.bidiSpans(s),u=r.textDirectionAt(s.from);for(let y=e,b=null;;){let M=O(s,c,u,y,t),A=ss;if(!M){if(s.number==(t?r.state.doc.lines:1))return y;A=`
`,s=r.state.doc.line(s.number+(t?1:-1)),c=r.bidiSpans(s),M=p.jT.cursor(t?s.from:s.to)}if(b){if(!b(A))return y}else{if(!n)return M;b=n(A)}y=M}}function Kn(r,e,t){let n=r.state.charCategorizer(e),s=n(t);return c=>{let u=n(c);return s==p.D0.Space&&(s=u),s==u}}function Jn(r,e,t,n){let s=e.head,c=t?1:-1;if(s==(t?r.state.doc.length:0))return p.jT.cursor(s,e.assoc);let u=e.goalColumn,y,b=r.contentDOM.getBoundingClientRect(),M=r.coordsAtPos(s,e.assoc||-1),A=r.documentTop;if(M)u==null&&(u=M.left-b.left),y=c<0?M.top:M.bottom;else{let X=r.viewState.lineBlockAt(s);u==null&&(u=Math.min(b.right-b.left,r.defaultCharacterWidth*(s-X.from))),y=(c<0?X.top:X.bottom)+A}let F=b.left+u,$=n!=null?n:r.viewState.heightOracle.textHeight>>1;for(let X=0;;X+=10){let _=y+($+X)*c,le=Sn(r,{x:F,y:_},!1,c);if(_<b.top||_>b.bottom||(c<0?le<s:le>s)){let se=r.docView.coordsForChar(le),de=!se||_<se.top?-1:1;return p.jT.cursor(le,de,void 0,u)}}}function Rn(r,e,t){for(;;){let n=0;for(let s of r)s.between(e-1,e+1,(c,u,y)=>{if(e>c&&e<u){let b=n||t||(e-c<u-e?-1:1);e=b<0?c:u,n=b}});if(!n)return e}}function Mr(r,e,t){let n=Rn(r.state.facet(R).map(s=>s(r)),t.from,e.head>t.from?-1:1);return n==t.from?t:p.jT.cursor(n,n<t.from?1:-1)}class to{setSelectionOrigin(e){this.lastSelectionOrigin=e,this.lastSelectionTime=Date.now()}constructor(e){this.view=e,this.lastKeyCode=0,this.lastKeyTime=0,this.lastTouchTime=0,this.lastFocusTime=0,this.lastScrollTop=0,this.lastScrollLeft=0,this.pendingIOSKey=void 0,this.lastSelectionOrigin=null,this.lastSelectionTime=0,this.lastEscPress=0,this.lastContextMenu=0,this.scrollHandlers=[],this.handlers=Object.create(null),this.composing=-1,this.compositionFirstChange=null,this.compositionEndedAt=0,this.compositionPendingKey=!1,this.compositionPendingChange=!1,this.mouseSelection=null,this.draggedContent=null,this.handleEvent=this.handleEvent.bind(this),this.notifiedFocused=e.hasFocus,C.safari&&e.contentDOM.addEventListener("input",()=>null),C.gecko&&pe(e.contentDOM.ownerDocument)}handleEvent(e){!Or(this.view,e)||this.ignoreDuringComposition(e)||e.type=="keydown"&&this.keydown(e)||this.runHandlers(e.type,e)}runHandlers(e,t){let n=this.handlers[e];if(n){for(let s of n.observers)s(this.view,t);for(let s of n.handlers){if(t.defaultPrevented)break;if(s(this.view,t)){t.preventDefault();break}}}}ensureHandlers(e){let t=io(e),n=this.handlers,s=this.view.contentDOM;for(let c in t)if(c!="scroll"){let u=!t[c].handlers.length,y=n[c];y&&u!=!y.handlers.length&&(s.removeEventListener(c,this.handleEvent),y=null),y||s.addEventListener(c,this.handleEvent,{passive:u})}for(let c in n)c!="scroll"&&!t[c]&&s.removeEventListener(c,this.handleEvent);this.handlers=t}keydown(e){if(this.lastKeyCode=e.keyCode,this.lastKeyTime=Date.now(),e.keyCode==9&&Date.now()<this.lastEscPress+2e3)return!0;if(e.keyCode!=27&&fr.indexOf(e.keyCode)<0&&(this.view.inputState.lastEscPress=0),C.android&&C.chrome&&!e.synthetic&&(e.keyCode==13||e.keyCode==8))return this.view.observer.delayAndroidKey(e.key,e.keyCode),!0;let t;return C.ios&&!e.synthetic&&!e.altKey&&!e.metaKey&&((t=cr.find(n=>n.keyCode==e.keyCode))&&!e.ctrlKey||ii.indexOf(e.key)>-1&&e.ctrlKey&&!e.shiftKey)?(this.pendingIOSKey=t||e,setTimeout(()=>this.flushIOSKey(),250),!0):(e.keyCode!=229&&this.view.observer.forceFlush(),!1)}flushIOSKey(){let e=this.pendingIOSKey;return e?(this.pendingIOSKey=void 0,ai(this.view.contentDOM,e.key,e.keyCode)):!1}ignoreDuringComposition(e){return/^key/.test(e.type)?this.composing>0?!0:C.safari&&!C.ios&&this.compositionPendingKey&&Date.now()-this.compositionEndedAt<100?(this.compositionPendingKey=!1,!0):!1:!1}startMouseSelection(e){this.mouseSelection&&this.mouseSelection.destroy(),this.mouseSelection=e}update(e){this.mouseSelection&&this.mouseSelection.update(e),this.draggedContent&&e.docChanged&&(this.draggedContent=this.draggedContent.map(e.changes)),e.transactions.length&&(this.lastKeyCode=this.lastSelectionTime=0)}destroy(){this.mouseSelection&&this.mouseSelection.destroy()}}function Er(r,e){return(t,n)=>{try{return e.call(r,n,t)}catch(s){ri(t.state,s)}}}function io(r){let e=Object.create(null);function t(n){return e[n]||(e[n]={observers:[],handlers:[]})}for(let n of r){let s=n.spec;if(s&&s.domEventHandlers)for(let c in s.domEventHandlers){let u=s.domEventHandlers[c];u&&t(c).handlers.push(Er(n.value,u))}if(s&&s.domEventObservers)for(let c in s.domEventObservers){let u=s.domEventObservers[c];u&&t(c).observers.push(Er(n.value,u))}}for(let n in yn)t(n).handlers.push(yn[n]);for(let n in _i)t(n).observers.push(_i[n]);return e}const cr=[{key:"Backspace",keyCode:8,inputType:"deleteContentBackward"},{key:"Enter",keyCode:13,inputType:"insertParagraph"},{key:"Enter",keyCode:13,inputType:"insertLineBreak"},{key:"Delete",keyCode:46,inputType:"deleteContentForward"}],ii="dthko",fr=[16,17,18,20,91,92,224,225],Ns=6;function En(r){return Math.max(0,r)*.7+8}function ur(r,e){return Math.max(Math.abs(r.clientX-e.clientX),Math.abs(r.clientY-e.clientY))}class dr{constructor(e,t,n,s){this.view=e,this.startEvent=t,this.style=n,this.mustSelect=s,this.scrollSpeed={x:0,y:0},this.scrolling=-1,this.lastEvent=t,this.scrollParent=ui(e.contentDOM),this.atoms=e.state.facet(R).map(u=>u(e));let c=e.contentDOM.ownerDocument;c.addEventListener("mousemove",this.move=this.move.bind(this)),c.addEventListener("mouseup",this.up=this.up.bind(this)),this.extend=t.shiftKey,this.multiple=e.state.facet(p.yy.allowMultipleSelections)&&Dr(e,t),this.dragging=ws(e,t)&&Nr(t)==1?null:!1}start(e){this.dragging===!1&&this.select(e)}move(e){var t;if(e.buttons==0)return this.destroy();if(this.dragging||this.dragging==null&&ur(this.startEvent,e)<10)return;this.select(this.lastEvent=e);let n=0,s=0,c=((t=this.scrollParent)===null||t===void 0?void 0:t.getBoundingClientRect())||{left:0,top:0,right:this.view.win.innerWidth,bottom:this.view.win.innerHeight},u=w(this.view);e.clientX-u.left<=c.left+Ns?n=-En(c.left-e.clientX):e.clientX+u.right>=c.right-Ns&&(n=En(e.clientX-c.right)),e.clientY-u.top<=c.top+Ns?s=-En(c.top-e.clientY):e.clientY+u.bottom>=c.bottom-Ns&&(s=En(e.clientY-c.bottom)),this.setScrollSpeed(n,s)}up(e){this.dragging==null&&this.select(this.lastEvent),this.dragging||e.preventDefault(),this.destroy()}destroy(){this.setScrollSpeed(0,0);let e=this.view.contentDOM.ownerDocument;e.removeEventListener("mousemove",this.move),e.removeEventListener("mouseup",this.up),this.view.inputState.mouseSelection=this.view.inputState.draggedContent=null}setScrollSpeed(e,t){this.scrollSpeed={x:e,y:t},e||t?this.scrolling<0&&(this.scrolling=setInterval(()=>this.scroll(),50)):this.scrolling>-1&&(clearInterval(this.scrolling),this.scrolling=-1)}scroll(){this.scrollParent?(this.scrollParent.scrollLeft+=this.scrollSpeed.x,this.scrollParent.scrollTop+=this.scrollSpeed.y):this.view.win.scrollBy(this.scrollSpeed.x,this.scrollSpeed.y),this.dragging===!1&&this.select(this.lastEvent)}skipAtoms(e){let t=null;for(let n=0;n<e.ranges.length;n++){let s=e.ranges[n],c=null;if(s.empty){let u=Rn(this.atoms,s.from,0);u!=s.from&&(c=p.jT.cursor(u,-1))}else{let u=Rn(this.atoms,s.from,-1),y=Rn(this.atoms,s.to,1);(u!=s.from||y!=s.to)&&(c=p.jT.range(s.from==s.anchor?u:y,s.from==s.head?u:y))}c&&(t||(t=e.ranges.slice()),t[n]=c)}return t?p.jT.create(t,e.mainIndex):e}select(e){let{view:t}=this,n=this.skipAtoms(this.style.get(e,this.extend,this.multiple));(this.mustSelect||!n.eq(t.state.selection)||n.main.assoc!=t.state.selection.main.assoc&&this.dragging===!1)&&this.view.dispatch({selection:n,userEvent:"select.pointer"}),this.mustSelect=!1}update(e){this.style.update(e)&&setTimeout(()=>this.select(this.lastEvent),20)}}function Dr(r,e){let t=r.state.facet(gi);return t.length?t[0](e):C.mac?e.metaKey:e.ctrlKey}function Un(r,e){let t=r.state.facet(hi);return t.length?t[0](e):C.mac?!e.altKey:!e.ctrlKey}function ws(r,e){let{main:t}=r.state.selection;if(t.empty)return!1;let n=xt(r.root);if(!n||n.rangeCount==0)return!0;let s=n.getRangeAt(0).getClientRects();for(let c=0;c<s.length;c++){let u=s[c];if(u.left<=e.clientX&&u.right>=e.clientX&&u.top<=e.clientY&&u.bottom>=e.clientY)return!0}return!1}function Or(r,e){if(!e.bubbles)return!0;if(e.defaultPrevented)return!1;for(let t=e.target,n;t!=r.contentDOM;t=t.parentNode)if(!t||t.nodeType==11||(n=be.get(t))&&n.ignoreEvent(e))return!1;return!0}const yn=Object.create(null),_i=Object.create(null),_s=C.ie&&C.ie_version<15||C.ios&&C.webkit_version<604;function er(r){let e=r.dom.parentNode;if(!e)return;let t=e.appendChild(document.createElement("textarea"));t.style.cssText="position: fixed; left: -10000px; top: 10px",t.focus(),setTimeout(()=>{r.focus(),t.remove(),pr(r,t.value)},50)}function pr(r,e){let{state:t}=r,n,s=1,c=t.toText(e),u=c.lines==t.selection.ranges.length;if(V!=null&&t.selection.ranges.every(b=>b.empty)&&V==c.toString()){let b=-1;n=t.changeByRange(M=>{let A=t.doc.lineAt(M.from);if(A.from==b)return{range:M};b=A.from;let F=t.toText((u?c.line(s++).text:e)+t.lineBreak);return{changes:{from:A.from,insert:F},range:p.jT.cursor(M.from+F.length)}})}else u?n=t.changeByRange(b=>{let M=c.line(s++);return{changes:{from:b.from,to:b.to,insert:M.text},range:p.jT.cursor(b.from+M.length)}}):n=t.replaceSelection(c);r.dispatch(n,{userEvent:"input.paste",scrollIntoView:!0})}_i.scroll=r=>{r.inputState.lastScrollTop=r.scrollDOM.scrollTop,r.inputState.lastScrollLeft=r.scrollDOM.scrollLeft},yn.keydown=(r,e)=>(r.inputState.setSelectionOrigin("select"),e.keyCode==27&&(r.inputState.lastEscPress=Date.now()),!1),_i.touchstart=(r,e)=>{r.inputState.lastTouchTime=Date.now(),r.inputState.setSelectionOrigin("select.pointer")},_i.touchmove=r=>{r.inputState.setSelectionOrigin("select.pointer")},yn.mousedown=(r,e)=>{if(r.observer.flush(),r.inputState.lastTouchTime>Date.now()-2e3)return!1;let t=null;for(let n of r.state.facet(yi))if(t=n(r,e),t)break;if(!t&&e.button==0&&(t=so(r,e)),t){let n=!r.hasFocus;r.inputState.startMouseSelection(new dr(r,e,t,n)),n&&r.observer.ignore(()=>Ot(r.contentDOM));let s=r.inputState.mouseSelection;if(s)return s.start(e),s.dragging===!1}return!1};function tr(r,e,t,n){if(n==1)return p.jT.cursor(e,t);if(n==2)return Ui(r.state,e,t);{let s=Ct.find(r.docView,e),c=r.state.doc.lineAt(s?s.posAtEnd:e),u=s?s.posAtStart:c.from,y=s?s.posAtEnd:c.to;return y<r.state.doc.length&&y==c.to&&y++,p.jT.range(u,y)}}let Pr=(r,e)=>r>=e.top&&r<=e.bottom,Rr=(r,e,t)=>Pr(e,t)&&r>=t.left&&r<=t.right;function Br(r,e,t,n){let s=Ct.find(r.docView,e);if(!s)return 1;let c=e-s.posAtStart;if(c==0)return 1;if(c==s.length)return-1;let u=s.coordsAt(c,-1);if(u&&Rr(t,n,u))return-1;let y=s.coordsAt(c,1);return y&&Rr(t,n,y)?1:u&&Pr(n,u)?-1:1}function Lr(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1);return{pos:t,bias:Br(r,t,e.clientX,e.clientY)}}const no=C.ie&&C.ie_version<=11;let Ir=null,Fs=0,ir=0;function Nr(r){if(!no)return r.detail;let e=Ir,t=ir;return Ir=r,ir=Date.now(),Fs=!e||t>Date.now()-400&&Math.abs(e.clientX-r.clientX)<2&&Math.abs(e.clientY-r.clientY)<2?(Fs+1)%3:1}function so(r,e){let t=Lr(r,e),n=Nr(e),s=r.state.selection;return{update(c){c.docChanged&&(t.pos=c.changes.mapPos(t.pos),s=s.map(c.changes))},get(c,u,y){let b=Lr(r,c),M,A=tr(r,b.pos,b.bias,n);if(t.pos!=b.pos&&!u){let F=tr(r,t.pos,t.bias,n),$=Math.min(F.from,A.from),X=Math.max(F.to,A.to);A=$<A.from?p.jT.range($,X):p.jT.range(X,$)}return u?s.replaceRange(s.main.extend(A.from,A.to)):y&&n==1&&s.ranges.length>1&&(M=ro(s,b.pos))?M:y?s.addRange(A):p.jT.create([A])}}}function ro(r,e){for(let t=0;t<r.ranges.length;t++){let{from:n,to:s}=r.ranges[t];if(n<=e&&s>=e)return p.jT.create(r.ranges.slice(0,t).concat(r.ranges.slice(t+1)),r.mainIndex==t?0:r.mainIndex-(r.mainIndex>t?1:0))}return null}yn.dragstart=(r,e)=>{let{selection:{main:t}}=r.state;if(e.target.draggable){let s=r.docView.nearest(e.target);if(s&&s.isWidget){let c=s.posAtStart,u=c+s.length;(c>=t.to||u<=t.from)&&(t=p.jT.range(c,u))}}let{inputState:n}=r;return n.mouseSelection&&(n.mouseSelection.dragging=!0),n.draggedContent=t,e.dataTransfer&&(e.dataTransfer.setData("Text",r.state.sliceDoc(t.from,t.to)),e.dataTransfer.effectAllowed="copyMove"),!1},yn.dragend=r=>(r.inputState.draggedContent=null,!1);function Fr(r,e,t,n){if(!t)return;let s=r.posAtCoords({x:e.clientX,y:e.clientY},!1),{draggedContent:c}=r.inputState,u=n&&c&&Un(r,e)?{from:c.from,to:c.to}:null,y={from:s,insert:t},b=r.state.changes(u?[u,y]:y);r.focus(),r.dispatch({changes:b,selection:{anchor:b.mapPos(s,-1),head:b.mapPos(s,1)},userEvent:u?"move.drop":"input.drop"}),r.inputState.draggedContent=null}yn.drop=(r,e)=>{if(!e.dataTransfer)return!1;if(r.state.readOnly)return!0;let t=e.dataTransfer.files;if(t&&t.length){let n=Array(t.length),s=0,c=()=>{++s==t.length&&Fr(r,e,n.filter(u=>u!=null).join(r.state.lineBreak),!1)};for(let u=0;u<t.length;u++){let y=new FileReader;y.onerror=c,y.onload=()=>{/[\x00-\x08\x0e-\x1f]{2}/.test(y.result)||(n[u]=y.result),c()},y.readAsText(t[u])}return!0}else{let n=e.dataTransfer.getData("Text");if(n)return Fr(r,e,n,!0),!0}return!1},yn.paste=(r,e)=>{if(r.state.readOnly)return!0;r.observer.flush();let t=_s?null:e.clipboardData;return t?(pr(r,t.getData("text/plain")||t.getData("text/uri-text")),!0):(er(r),!1)};function oo(r,e){let t=r.dom.parentNode;if(!t)return;let n=t.appendChild(document.createElement("textarea"));n.style.cssText="position: fixed; left: -10000px; top: 10px",n.value=e,n.focus(),n.selectionEnd=e.length,n.selectionStart=0,setTimeout(()=>{n.remove(),r.focus()},50)}function os(r){let e=[],t=[],n=!1;for(let s of r.selection.ranges)s.empty||(e.push(r.sliceDoc(s.from,s.to)),t.push(s));if(!e.length){let s=-1;for(let{from:c}of r.selection.ranges){let u=r.doc.lineAt(c);u.number>s&&(e.push(u.text),t.push({from:u.from,to:Math.min(r.doc.length,u.to+1)})),s=u.number}n=!0}return{text:e.join(r.lineBreak),ranges:t,linewise:n}}let V=null;yn.copy=yn.cut=(r,e)=>{let{text:t,ranges:n,linewise:s}=os(r.state);if(!t&&!s)return!1;V=s?t:null,e.type=="cut"&&!r.state.readOnly&&r.dispatch({changes:n,scrollIntoView:!0,userEvent:"delete.cut"});let c=_s?null:e.clipboardData;return c?(c.clearData(),c.setData("text/plain",t),!0):(oo(r,t),!1)};const z=p.q6.define();function Q(r,e){let t=[];for(let n of r.facet(zi)){let s=n(r,e);s&&t.push(s)}return t?r.update({effects:t,annotations:z.of(!0)}):null}function ie(r){setTimeout(()=>{let e=r.hasFocus;if(e!=r.inputState.notifiedFocused){let t=Q(r.state,e);t?r.dispatch(t):r.update([])}},10)}_i.focus=r=>{r.inputState.lastFocusTime=Date.now(),!r.scrollDOM.scrollTop&&(r.inputState.lastScrollTop||r.inputState.lastScrollLeft)&&(r.scrollDOM.scrollTop=r.inputState.lastScrollTop,r.scrollDOM.scrollLeft=r.inputState.lastScrollLeft),ie(r)},_i.blur=r=>{r.observer.clearSelectionRange(),ie(r)},_i.compositionstart=_i.compositionupdate=r=>{r.inputState.compositionFirstChange==null&&(r.inputState.compositionFirstChange=!0),r.inputState.composing<0&&(r.inputState.composing=0)},_i.compositionend=r=>{r.inputState.composing=-1,r.inputState.compositionEndedAt=Date.now(),r.inputState.compositionPendingKey=!0,r.inputState.compositionPendingChange=r.observer.pendingRecords().length>0,r.inputState.compositionFirstChange=null,C.chrome&&C.android?r.observer.flushSoon():r.inputState.compositionPendingChange?Promise.resolve().then(()=>r.observer.flush()):setTimeout(()=>{r.inputState.composing<0&&r.docView.hasComposition&&r.update([])},50)},_i.contextmenu=r=>{r.inputState.lastContextMenu=Date.now()},yn.beforeinput=(r,e)=>{var t;let n;if(C.chrome&&C.android&&(n=cr.find(s=>s.inputType==e.inputType))&&(r.observer.delayAndroidKey(n.key,n.keyCode),n.key=="Backspace"||n.key=="Delete")){let s=((t=window.visualViewport)===null||t===void 0?void 0:t.height)||0;setTimeout(()=>{var c;(((c=window.visualViewport)===null||c===void 0?void 0:c.height)||0)>s+10&&r.hasFocus&&(r.contentDOM.blur(),r.focus())},100)}return!1};const ce=new Set;function pe(r){ce.has(r)||(ce.add(r),r.addEventListener("copy",()=>{}),r.addEventListener("cut",()=>{}))}const ve=["pre-wrap","normal","pre-line","break-spaces"];class $e{constructor(e){this.lineWrapping=e,this.doc=p.xv.empty,this.heightSamples={},this.lineHeight=14,this.charWidth=7,this.textHeight=14,this.lineLength=30,this.heightChanged=!1}heightForGap(e,t){let n=this.doc.lineAt(t).number-this.doc.lineAt(e).number+1;return this.lineWrapping&&(n+=Math.max(0,Math.ceil((t-e-n*this.lineLength*.5)/this.lineLength))),this.lineHeight*n}heightForLine(e){return this.lineWrapping?(1+Math.max(0,Math.ceil((e-this.lineLength)/(this.lineLength-5))))*this.lineHeight:this.lineHeight}setDoc(e){return this.doc=e,this}mustRefreshForWrapping(e){return ve.indexOf(e)>-1!=this.lineWrapping}mustRefreshForHeights(e){let t=!1;for(let n=0;n<e.length;n++){let s=e[n];s<0?n++:this.heightSamples[Math.floor(s*10)]||(t=!0,this.heightSamples[Math.floor(s*10)]=!0)}return t}refresh(e,t,n,s,c,u){let y=ve.indexOf(e)>-1,b=Math.round(t)!=Math.round(this.lineHeight)||this.lineWrapping!=y;if(this.lineWrapping=y,this.lineHeight=t,this.charWidth=n,this.textHeight=s,this.lineLength=c,b){this.heightSamples={};for(let M=0;M<u.length;M++){let A=u[M];A<0?M++:this.heightSamples[Math.floor(A*10)]=!0}}return b}}class Tt{constructor(e,t){this.from=e,this.heights=t,this.index=0}get more(){return this.index<this.heights.length}}class it{constructor(e,t,n,s,c){this.from=e,this.length=t,this.top=n,this.height=s,this._content=c}get type(){return typeof this._content=="number"?st.Text:Array.isArray(this._content)?this._content:this._content.type}get to(){return this.from+this.length}get bottom(){return this.top+this.height}get widget(){return this._content instanceof ot?this._content.widget:null}get widgetLineBreaks(){return typeof this._content=="number"?this._content:0}join(e){let t=(Array.isArray(this._content)?this._content:[this]).concat(Array.isArray(e._content)?e._content:[e]);return new it(this.from,this.length+e.length,this.top,this.height+e.height,t)}}var Ae=function(r){return r[r.ByPos=0]="ByPos",r[r.ByHeight=1]="ByHeight",r[r.ByPosNoHeight=2]="ByPosNoHeight",r}(Ae||(Ae={}));const Re=.001;class Me{constructor(e,t,n=2){this.length=e,this.height=t,this.flags=n}get outdated(){return(this.flags&2)>0}set outdated(e){this.flags=(e?2:0)|this.flags&-3}setHeight(e,t){this.height!=t&&(Math.abs(this.height-t)>Re&&(e.heightChanged=!0),this.height=t)}replace(e,t,n){return Me.of(n)}decomposeLeft(e,t){t.push(this)}decomposeRight(e,t){t.push(this)}applyChanges(e,t,n,s){let c=this,u=n.doc;for(let y=s.length-1;y>=0;y--){let{fromA:b,toA:M,fromB:A,toB:F}=s[y],$=c.lineAt(b,Ae.ByPosNoHeight,n.setDoc(t),0,0),X=$.to>=M?$:c.lineAt(M,Ae.ByPosNoHeight,n,0,0);for(F+=X.to-M,M=X.to;y>0&&$.from<=s[y-1].toA;)b=s[y-1].fromA,A=s[y-1].fromB,y--,b<$.from&&($=c.lineAt(b,Ae.ByPosNoHeight,n,0,0));A+=$.from-b,b=$.from;let _=Ai.build(n.setDoc(u),e,A,F);c=c.replace(b,M,_)}return c.updateHeight(n,0)}static empty(){return new qe(0,0)}static of(e){if(e.length==1)return e[0];let t=0,n=e.length,s=0,c=0;for(;;)if(t==n)if(s>c*2){let y=e[t-1];y.break?e.splice(--t,1,y.left,null,y.right):e.splice(--t,1,y.left,y.right),n+=1+y.break,s-=y.size}else if(c>s*2){let y=e[n];y.break?e.splice(n,1,y.left,null,y.right):e.splice(n,1,y.left,y.right),n+=2+y.break,c-=y.size}else break;else if(s<c){let y=e[t++];y&&(s+=y.size)}else{let y=e[--n];y&&(c+=y.size)}let u=0;return e[t-1]==null?(u=1,t--):e[t]==null&&(u=1,n++),new Ri(Me.of(e.slice(0,t)),u,Me.of(e.slice(n)))}}Me.prototype.size=1;class vt extends Me{constructor(e,t,n){super(e,t),this.deco=n}blockAt(e,t,n,s){return new it(s,this.length,n,this.height,this.deco||0)}lineAt(e,t,n,s,c){return this.blockAt(0,n,s,c)}forEachLine(e,t,n,s,c,u){e<=c+this.length&&t>=c&&u(this.blockAt(0,n,s,c))}updateHeight(e,t=0,n=!1,s){return s&&s.from<=t&&s.more&&this.setHeight(e,s.heights[s.index++]),this.outdated=!1,this}toString(){return`block(${this.length})`}}class qe extends vt{constructor(e,t){super(e,t,null),this.collapsed=0,this.widgetHeight=0,this.breaks=0}blockAt(e,t,n,s){return new it(s,this.length,n,this.height,this.breaks)}replace(e,t,n){let s=n[0];return n.length==1&&(s instanceof qe||s instanceof St&&s.flags&4)&&Math.abs(this.length-s.length)<10?(s instanceof St?s=new qe(s.length,this.height):s.height=this.height,this.outdated||(s.outdated=!1),s):Me.of(n)}updateHeight(e,t=0,n=!1,s){return s&&s.from<=t&&s.more?this.setHeight(e,s.heights[s.index++]):(n||this.outdated)&&this.setHeight(e,Math.max(this.widgetHeight,e.heightForLine(this.length-this.collapsed))+this.breaks*e.lineHeight),this.outdated=!1,this}toString(){return`line(${this.length}${this.collapsed?-this.collapsed:""}${this.widgetHeight?":"+this.widgetHeight:""})`}}class St extends Me{constructor(e){super(e,0)}heightMetrics(e,t){let n=e.doc.lineAt(t).number,s=e.doc.lineAt(t+this.length).number,c=s-n+1,u,y=0;if(e.lineWrapping){let b=Math.min(this.height,e.lineHeight*c);u=b/c,this.length>c+1&&(y=(this.height-b)/(this.length-c-1))}else u=this.height/c;return{firstLine:n,lastLine:s,perLine:u,perChar:y}}blockAt(e,t,n,s){let{firstLine:c,lastLine:u,perLine:y,perChar:b}=this.heightMetrics(t,s);if(t.lineWrapping){let M=s+Math.round(Math.max(0,Math.min(1,(e-n)/this.height))*this.length),A=t.doc.lineAt(M),F=y+A.length*b,$=Math.max(n,e-F/2);return new it(A.from,A.length,$,F,0)}else{let M=Math.max(0,Math.min(u-c,Math.floor((e-n)/y))),{from:A,length:F}=t.doc.line(c+M);return new it(A,F,n+y*M,y,0)}}lineAt(e,t,n,s,c){if(t==Ae.ByHeight)return this.blockAt(e,n,s,c);if(t==Ae.ByPosNoHeight){let{from:X,to:_}=n.doc.lineAt(e);return new it(X,_-X,0,0,0)}let{firstLine:u,perLine:y,perChar:b}=this.heightMetrics(n,c),M=n.doc.lineAt(e),A=y+M.length*b,F=M.number-u,$=s+y*F+b*(M.from-c-F);return new it(M.from,M.length,Math.max(s,Math.min($,s+this.height-A)),A,0)}forEachLine(e,t,n,s,c,u){e=Math.max(e,c),t=Math.min(t,c+this.length);let{firstLine:y,perLine:b,perChar:M}=this.heightMetrics(n,c);for(let A=e,F=s;A<=t;){let $=n.doc.lineAt(A);if(A==e){let _=$.number-y;F+=b*_+M*(e-c-_)}let X=b+M*$.length;u(new it($.from,$.length,F,X,0)),F+=X,A=$.to+1}}replace(e,t,n){let s=this.length-t;if(s>0){let c=n[n.length-1];c instanceof St?n[n.length-1]=new St(c.length+s):n.push(null,new St(s-1))}if(e>0){let c=n[0];c instanceof St?n[0]=new St(e+c.length):n.unshift(new St(e-1),null)}return Me.of(n)}decomposeLeft(e,t){t.push(new St(e-1),null)}decomposeRight(e,t){t.push(null,new St(this.length-e-1))}updateHeight(e,t=0,n=!1,s){let c=t+this.length;if(s&&s.from<=t+this.length&&s.more){let u=[],y=Math.max(t,s.from),b=-1;for(s.from>t&&u.push(new St(s.from-t-1).updateHeight(e,t));y<=c&&s.more;){let A=e.doc.lineAt(y).length;u.length&&u.push(null);let F=s.heights[s.index++];b==-1?b=F:Math.abs(F-b)>=Re&&(b=-2);let $=new qe(A,F);$.outdated=!1,u.push($),y+=A+1}y<=c&&u.push(null,new St(c-y).updateHeight(e,y));let M=Me.of(u);return(b<0||Math.abs(M.height-this.height)>=Re||Math.abs(b-this.heightMetrics(e,t).perLine)>=Re)&&(e.heightChanged=!0),M}else(n||this.outdated)&&(this.setHeight(e,e.heightForGap(t,t+this.length)),this.outdated=!1);return this}toString(){return`gap(${this.length})`}}class Ri extends Me{constructor(e,t,n){super(e.length+t+n.length,e.height+n.height,t|(e.outdated||n.outdated?2:0)),this.left=e,this.right=n,this.size=e.size+n.size}get break(){return this.flags&1}blockAt(e,t,n,s){let c=n+this.left.height;return e<c?this.left.blockAt(e,t,n,s):this.right.blockAt(e,t,c,s+this.left.length+this.break)}lineAt(e,t,n,s,c){let u=s+this.left.height,y=c+this.left.length+this.break,b=t==Ae.ByHeight?e<u:e<y,M=b?this.left.lineAt(e,t,n,s,c):this.right.lineAt(e,t,n,u,y);if(this.break||(b?M.to<y:M.from>y))return M;let A=t==Ae.ByPosNoHeight?Ae.ByPosNoHeight:Ae.ByPos;return b?M.join(this.right.lineAt(y,A,n,u,y)):this.left.lineAt(y,A,n,s,c).join(M)}forEachLine(e,t,n,s,c,u){let y=s+this.left.height,b=c+this.left.length+this.break;if(this.break)e<b&&this.left.forEachLine(e,t,n,s,c,u),t>=b&&this.right.forEachLine(e,t,n,y,b,u);else{let M=this.lineAt(b,Ae.ByPos,n,s,c);e<M.from&&this.left.forEachLine(e,M.from-1,n,s,c,u),M.to>=e&&M.from<=t&&u(M),t>M.to&&this.right.forEachLine(M.to+1,t,n,y,b,u)}}replace(e,t,n){let s=this.left.length+this.break;if(t<s)return this.balanced(this.left.replace(e,t,n),this.right);if(e>this.left.length)return this.balanced(this.left,this.right.replace(e-s,t-s,n));let c=[];e>0&&this.decomposeLeft(e,c);let u=c.length;for(let y of n)c.push(y);if(e>0&&Bi(c,u-1),t<this.length){let y=c.length;this.decomposeRight(t,c),Bi(c,y)}return Me.of(c)}decomposeLeft(e,t){let n=this.left.length;if(e<=n)return this.left.decomposeLeft(e,t);t.push(this.left),this.break&&(n++,e>=n&&t.push(null)),e>n&&this.right.decomposeLeft(e-n,t)}decomposeRight(e,t){let n=this.left.length,s=n+this.break;if(e>=s)return this.right.decomposeRight(e-s,t);e<n&&this.left.decomposeRight(e,t),this.break&&e<s&&t.push(null),t.push(this.right)}balanced(e,t){return e.size>2*t.size||t.size>2*e.size?Me.of(this.break?[e,null,t]:[e,t]):(this.left=e,this.right=t,this.height=e.height+t.height,this.outdated=e.outdated||t.outdated,this.size=e.size+t.size,this.length=e.length+this.break+t.length,this)}updateHeight(e,t=0,n=!1,s){let{left:c,right:u}=this,y=t+c.length+this.break,b=null;return s&&s.from<=t+c.length&&s.more?b=c=c.updateHeight(e,t,n,s):c.updateHeight(e,t,n),s&&s.from<=y+u.length&&s.more?b=u=u.updateHeight(e,y,n,s):u.updateHeight(e,y,n),b?this.balanced(c,u):(this.height=this.left.height+this.right.height,this.outdated=!1,this)}toString(){return this.left+(this.break?" ":"-")+this.right}}function Bi(r,e){let t,n;r[e]==null&&(t=r[e-1])instanceof St&&(n=r[e+1])instanceof St&&r.splice(e-1,3,new St(t.length+1+n.length))}const Gi=5;class Ai{constructor(e,t){this.pos=e,this.oracle=t,this.nodes=[],this.lineStart=-1,this.lineEnd=-1,this.covering=null,this.writtenTo=e}get isCovered(){return this.covering&&this.nodes[this.nodes.length-1]==this.covering}span(e,t){if(this.lineStart>-1){let n=Math.min(t,this.lineEnd),s=this.nodes[this.nodes.length-1];s instanceof qe?s.length+=n-this.pos:(n>this.pos||!this.isCovered)&&this.nodes.push(new qe(n-this.pos,-1)),this.writtenTo=n,t>n&&(this.nodes.push(null),this.writtenTo++,this.lineStart=-1)}this.pos=t}point(e,t,n){if(e<t||n.heightRelevant){let s=n.widget?n.widget.estimatedHeight:0,c=n.widget?n.widget.lineBreaks:0;s<0&&(s=this.oracle.lineHeight);let u=t-e;n.block?this.addBlock(new vt(u,s,n)):(u||c||s>=Gi)&&this.addLineDeco(s,c,u)}else t>e&&this.span(e,t);this.lineEnd>-1&&this.lineEnd<this.pos&&(this.lineEnd=this.oracle.doc.lineAt(this.pos).to)}enterLine(){if(this.lineStart>-1)return;let{from:e,to:t}=this.oracle.doc.lineAt(this.pos);this.lineStart=e,this.lineEnd=t,this.writtenTo<e&&((this.writtenTo<e-1||this.nodes[this.nodes.length-1]==null)&&this.nodes.push(this.blankContent(this.writtenTo,e-1)),this.nodes.push(null)),this.pos>e&&this.nodes.push(new qe(this.pos-e,-1)),this.writtenTo=this.pos}blankContent(e,t){let n=new St(t-e);return this.oracle.doc.lineAt(e).to==t&&(n.flags|=4),n}ensureLine(){this.enterLine();let e=this.nodes.length?this.nodes[this.nodes.length-1]:null;if(e instanceof qe)return e;let t=new qe(0,-1);return this.nodes.push(t),t}addBlock(e){this.enterLine();let t=e.deco;t&&t.startSide>0&&!this.isCovered&&this.ensureLine(),this.nodes.push(e),this.writtenTo=this.pos=this.pos+e.length,t&&t.endSide>0&&(this.covering=e)}addLineDeco(e,t,n){let s=this.ensureLine();s.length+=n,s.collapsed+=n,s.widgetHeight=Math.max(s.widgetHeight,e),s.breaks+=t,this.writtenTo=this.pos=this.pos+n}finish(e){let t=this.nodes.length==0?null:this.nodes[this.nodes.length-1];this.lineStart>-1&&!(t instanceof qe)&&!this.isCovered?this.nodes.push(new qe(0,-1)):(this.writtenTo<this.pos||t==null)&&this.nodes.push(this.blankContent(this.writtenTo,this.pos));let n=e;for(let s of this.nodes)s instanceof qe&&s.updateHeight(this.oracle,n),n+=s?s.length:1;return this.nodes}static build(e,t,n,s){let c=new Ai(n,e);return p.Xs.spans(t,n,s,c,0),c.finish(n)}}function Di(r,e,t){let n=new $i;return p.Xs.compare(r,e,t,n,0),n.changes}class $i{constructor(){this.changes=[]}compareRange(){}comparePoint(e,t,n,s){(e<t||n&&n.heightRelevant||s&&s.heightRelevant)&&lt(e,t,this.changes,5)}}function Vt(r,e){let t=r.getBoundingClientRect(),n=r.ownerDocument,s=n.defaultView||window,c=Math.max(0,t.left),u=Math.min(s.innerWidth,t.right),y=Math.max(0,t.top),b=Math.min(s.innerHeight,t.bottom);for(let M=r.parentNode;M&&M!=n.body;)if(M.nodeType==1){let A=M,F=window.getComputedStyle(A);if((A.scrollHeight>A.clientHeight||A.scrollWidth>A.clientWidth)&&F.overflow!="visible"){let $=A.getBoundingClientRect();c=Math.max(c,$.left),u=Math.min(u,$.right),y=Math.max(y,$.top),b=M==r.parentNode?$.bottom:Math.min(b,$.bottom)}M=F.position=="absolute"||F.position=="fixed"?A.offsetParent:A.parentNode}else if(M.nodeType==11)M=M.host;else break;return{left:c-t.left,right:Math.max(c,u)-t.left,top:y-(t.top+e),bottom:Math.max(y,b)-(t.top+e)}}function Gn(r,e){let t=r.getBoundingClientRect();return{left:0,right:t.right-t.left,top:e,bottom:t.bottom-(t.top+e)}}class oi{constructor(e,t,n){this.from=e,this.to=t,this.size=n}static same(e,t){if(e.length!=t.length)return!1;for(let n=0;n<e.length;n++){let s=e[n],c=t[n];if(s.from!=c.from||s.to!=c.to||s.size!=c.size)return!1}return!0}draw(e,t){return Ye.replace({widget:new Li(this.size*(t?e.scaleY:e.scaleX),t)}).range(this.from,this.to)}}class Li extends xi{constructor(e,t){super(),this.size=e,this.vertical=t}eq(e){return e.size==this.size&&e.vertical==this.vertical}toDOM(){let e=document.createElement("div");return this.vertical?e.style.height=this.size+"px":(e.style.width=this.size+"px",e.style.height="2px",e.style.display="inline-block"),e}get estimatedHeight(){return this.vertical?this.size:-1}}class Xi{constructor(e){this.state=e,this.pixelViewport={left:0,right:window.innerWidth,top:0,bottom:0},this.inView=!0,this.paddingTop=0,this.paddingBottom=0,this.contentDOMWidth=0,this.contentDOMHeight=0,this.editorHeight=0,this.editorWidth=0,this.scrollTop=0,this.scrolledToBottom=!0,this.scaleX=1,this.scaleY=1,this.scrollAnchorPos=0,this.scrollAnchorHeight=-1,this.scaler=Ws,this.scrollTarget=null,this.printing=!1,this.mustMeasureContent=!0,this.defaultTextDirection=j.LTR,this.visibleRanges=[],this.mustEnforceCursorAssoc=!1;let t=e.facet(ns).some(n=>typeof n!="function"&&n.class=="cm-lineWrapping");this.heightOracle=new $e(t),this.stateDeco=e.facet(On).filter(n=>typeof n!="function"),this.heightMap=Me.empty().applyChanges(this.stateDeco,p.xv.empty,this.heightOracle.setDoc(e.doc),[new D(0,0,0,e.doc.length)]),this.viewport=this.getViewport(0,null),this.updateViewportLines(),this.updateForViewport(),this.lineGaps=this.ensureLineGaps([]),this.lineGapDeco=Ye.set(this.lineGaps.map(n=>n.draw(this,!1))),this.computeVisibleRanges()}updateForViewport(){let e=[this.viewport],{main:t}=this.state.selection;for(let n=0;n<=1;n++){let s=n?t.head:t.anchor;if(!e.some(({from:c,to:u})=>s>=c&&s<=u)){let{from:c,to:u}=this.lineBlockAt(s);e.push(new en(c,u))}}this.viewports=e.sort((n,s)=>n.from-s.from),this.scaler=this.heightMap.height<=7e6?Ws:new nr(this.heightOracle,this.heightMap,this.viewports)}updateViewportLines(){this.viewportLines=[],this.heightMap.forEachLine(this.viewport.from,this.viewport.to,this.heightOracle.setDoc(this.state.doc),0,0,e=>{this.viewportLines.push(this.scaler.scale==1?e:an(e,this.scaler))})}update(e,t=null){this.state=e.state;let n=this.stateDeco;this.stateDeco=this.state.facet(On).filter(A=>typeof A!="function");let s=e.changedRanges,c=D.extendWithRanges(s,Di(n,this.stateDeco,e?e.changes:p.as.empty(this.state.doc.length))),u=this.heightMap.height,y=this.scrolledToBottom?null:this.scrollAnchorAt(this.scrollTop);this.heightMap=this.heightMap.applyChanges(this.stateDeco,e.startState.doc,this.heightOracle.setDoc(this.state.doc),c),this.heightMap.height!=u&&(e.flags|=2),y?(this.scrollAnchorPos=e.changes.mapPos(y.from,-1),this.scrollAnchorHeight=y.top):(this.scrollAnchorPos=-1,this.scrollAnchorHeight=this.heightMap.height);let b=c.length?this.mapViewport(this.viewport,e.changes):this.viewport;(t&&(t.range.head<b.from||t.range.head>b.to)||!this.viewportIsAppropriate(b))&&(b=this.getViewport(0,t));let M=!e.changes.empty||e.flags&2||b.from!=this.viewport.from||b.to!=this.viewport.to;this.viewport=b,this.updateForViewport(),M&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(this.mapLineGaps(this.lineGaps,e.changes))),e.flags|=this.computeVisibleRanges(),t&&(this.scrollTarget=t),!this.mustEnforceCursorAssoc&&e.selectionSet&&e.view.lineWrapping&&e.state.selection.main.empty&&e.state.selection.main.assoc&&!e.state.facet(qi)&&(this.mustEnforceCursorAssoc=!0)}measure(e){let t=e.contentDOM,n=window.getComputedStyle(t),s=this.heightOracle,c=n.whiteSpace;this.defaultTextDirection=n.direction=="rtl"?j.RTL:j.LTR;let u=this.heightOracle.mustRefreshForWrapping(c),y=t.getBoundingClientRect(),b=u||this.mustMeasureContent||this.contentDOMHeight!=y.height;this.contentDOMHeight=y.height,this.mustMeasureContent=!1;let M=0,A=0;if(y.width&&y.height){let{scaleX:Ue,scaleY:at}=fi(t,y);(this.scaleX!=Ue||this.scaleY!=at)&&(this.scaleX=Ue,this.scaleY=at,M|=8,u=b=!0)}let F=(parseInt(n.paddingTop)||0)*this.scaleY,$=(parseInt(n.paddingBottom)||0)*this.scaleY;(this.paddingTop!=F||this.paddingBottom!=$)&&(this.paddingTop=F,this.paddingBottom=$,M|=10),this.editorWidth!=e.scrollDOM.clientWidth&&(s.lineWrapping&&(b=!0),this.editorWidth=e.scrollDOM.clientWidth,M|=8);let X=e.scrollDOM.scrollTop*this.scaleY;this.scrollTop!=X&&(this.scrollAnchorHeight=-1,this.scrollTop=X),this.scrolledToBottom=Mi(e.scrollDOM);let _=(this.printing?Gn:Vt)(t,this.paddingTop),le=_.top-this.pixelViewport.top,se=_.bottom-this.pixelViewport.bottom;this.pixelViewport=_;let de=this.pixelViewport.bottom>this.pixelViewport.top&&this.pixelViewport.right>this.pixelViewport.left;if(de!=this.inView&&(this.inView=de,de&&(b=!0)),!this.inView&&!this.scrollTarget)return 0;let Je=y.width;if((this.contentDOMWidth!=Je||this.editorHeight!=e.scrollDOM.clientHeight)&&(this.contentDOMWidth=y.width,this.editorHeight=e.scrollDOM.clientHeight,M|=8),b){let Ue=e.docView.measureVisibleLineHeights(this.viewport);if(s.mustRefreshForHeights(Ue)&&(u=!0),u||s.lineWrapping&&Math.abs(Je-this.contentDOMWidth)>s.charWidth){let{lineHeight:at,charWidth:kt,textHeight:Vi}=e.docView.measureTextSize();u=at>0&&s.refresh(c,at,kt,Vi,Je/kt,Ue),u&&(e.docView.minWidth=0,M|=8)}le>0&&se>0?A=Math.max(le,se):le<0&&se<0&&(A=Math.min(le,se)),s.heightChanged=!1;for(let at of this.viewports){let kt=at.from==this.viewport.from?Ue:e.docView.measureVisibleLineHeights(at);this.heightMap=(u?Me.empty().applyChanges(this.stateDeco,p.xv.empty,this.heightOracle,[new D(0,0,0,e.state.doc.length)]):this.heightMap).updateHeight(s,0,u,new Tt(at.from,kt))}s.heightChanged&&(M|=2)}let ht=!this.viewportIsAppropriate(this.viewport,A)||this.scrollTarget&&(this.scrollTarget.range.head<this.viewport.from||this.scrollTarget.range.head>this.viewport.to);return ht&&(this.viewport=this.getViewport(A,this.scrollTarget)),this.updateForViewport(),(M&2||ht)&&this.updateViewportLines(),(this.lineGaps.length||this.viewport.to-this.viewport.from>2e3<<1)&&this.updateLineGaps(this.ensureLineGaps(u?[]:this.lineGaps,e)),M|=this.computeVisibleRanges(),this.mustEnforceCursorAssoc&&(this.mustEnforceCursorAssoc=!1,e.docView.enforceCursorAssoc()),M}get visibleTop(){return this.scaler.fromDOM(this.pixelViewport.top)}get visibleBottom(){return this.scaler.fromDOM(this.pixelViewport.bottom)}getViewport(e,t){let n=.5-Math.max(-.5,Math.min(.5,e/1e3/2)),s=this.heightMap,c=this.heightOracle,{visibleTop:u,visibleBottom:y}=this,b=new en(s.lineAt(u-n*1e3,Ae.ByHeight,c,0,0).from,s.lineAt(y+(1-n)*1e3,Ae.ByHeight,c,0,0).to);if(t){let{head:M}=t.range;if(M<b.from||M>b.to){let A=Math.min(this.editorHeight,this.pixelViewport.bottom-this.pixelViewport.top),F=s.lineAt(M,Ae.ByPos,c,0,0),$;t.y=="center"?$=(F.top+F.bottom)/2-A/2:t.y=="start"||t.y=="nearest"&&M<b.from?$=F.top:$=F.bottom-A,b=new en(s.lineAt($-1e3/2,Ae.ByHeight,c,0,0).from,s.lineAt($+A+1e3/2,Ae.ByHeight,c,0,0).to)}}return b}mapViewport(e,t){let n=t.mapPos(e.from,-1),s=t.mapPos(e.to,1);return new en(this.heightMap.lineAt(n,Ae.ByPos,this.heightOracle,0,0).from,this.heightMap.lineAt(s,Ae.ByPos,this.heightOracle,0,0).to)}viewportIsAppropriate({from:e,to:t},n=0){if(!this.inView)return!0;let{top:s}=this.heightMap.lineAt(e,Ae.ByPos,this.heightOracle,0,0),{bottom:c}=this.heightMap.lineAt(t,Ae.ByPos,this.heightOracle,0,0),{visibleTop:u,visibleBottom:y}=this;return(e==0||s<=u-Math.max(10,Math.min(-n,250)))&&(t==this.state.doc.length||c>=y+Math.max(10,Math.min(n,250)))&&s>u-2*1e3&&c<y+2*1e3}mapLineGaps(e,t){if(!e.length||t.empty)return e;let n=[];for(let s of e)t.touchesRange(s.from,s.to)||n.push(new oi(t.mapPos(s.from),t.mapPos(s.to),s.size));return n}ensureLineGaps(e,t){let n=this.heightOracle.lineWrapping,s=n?1e4:2e3,c=s>>1,u=s<<1;if(this.defaultTextDirection!=j.LTR&&!n)return[];let y=[],b=(M,A,F,$)=>{if(A-M<c)return;let X=this.state.selection.main,_=[X.from];X.empty||_.push(X.to);for(let se of _)if(se>M&&se<A){b(M,se-10,F,$),b(se+10,A,F,$);return}let le=ji(e,se=>se.from>=F.from&&se.to<=F.to&&Math.abs(se.from-M)<c&&Math.abs(se.to-A)<c&&!_.some(de=>se.from<de&&se.to>de));if(!le){if(A<F.to&&t&&n&&t.visibleRanges.some(se=>se.from<=A&&se.to>=A)){let se=t.moveToLineBoundary(p.jT.cursor(A),!1,!0).head;se>M&&(A=se)}le=new oi(M,A,this.gapSize(F,M,A,$))}y.push(le)};for(let M of this.viewportLines){if(M.length<u)continue;let A=Bn(M.from,M.to,this.stateDeco);if(A.total<u)continue;let F=this.scrollTarget?this.scrollTarget.range.head:null,$,X;if(n){let _=s/this.heightOracle.lineLength*this.heightOracle.lineHeight,le,se;if(F!=null){let de=ln(A,F),Je=((this.visibleBottom-this.visibleTop)/2+_)/M.height;le=de-Je,se=de+Je}else le=(this.visibleTop-M.top-_)/M.height,se=(this.visibleBottom-M.top+_)/M.height;$=li(A,le),X=li(A,se)}else{let _=A.total*this.heightOracle.charWidth,le=s*this.heightOracle.charWidth,se,de;if(F!=null){let Je=ln(A,F),ht=((this.pixelViewport.right-this.pixelViewport.left)/2+le)/_;se=Je-ht,de=Je+ht}else se=(this.pixelViewport.left-le)/_,de=(this.pixelViewport.right+le)/_;$=li(A,se),X=li(A,de)}$>M.from&&b(M.from,$,M,A),X<M.to&&b(X,M.to,M,A)}return y}gapSize(e,t,n,s){let c=ln(s,n)-ln(s,t);return this.heightOracle.lineWrapping?e.height*c:s.total*this.heightOracle.charWidth*c}updateLineGaps(e){oi.same(e,this.lineGaps)||(this.lineGaps=e,this.lineGapDeco=Ye.set(e.map(t=>t.draw(this,this.heightOracle.lineWrapping))))}computeVisibleRanges(){let e=this.stateDeco;this.lineGaps.length&&(e=e.concat(this.lineGapDeco));let t=[];p.Xs.spans(e,this.viewport.from,this.viewport.to,{span(s,c){t.push({from:s,to:c})},point(){}},20);let n=t.length!=this.visibleRanges.length||this.visibleRanges.some((s,c)=>s.from!=t[c].from||s.to!=t[c].to);return this.visibleRanges=t,n?4:0}lineBlockAt(e){return e>=this.viewport.from&&e<=this.viewport.to&&this.viewportLines.find(t=>t.from<=e&&t.to>=e)||an(this.heightMap.lineAt(e,Ae.ByPos,this.heightOracle,0,0),this.scaler)}lineBlockAtHeight(e){return an(this.heightMap.lineAt(this.scaler.fromDOM(e),Ae.ByHeight,this.heightOracle,0,0),this.scaler)}scrollAnchorAt(e){let t=this.lineBlockAtHeight(e+8);return t.from>=this.viewport.from||this.viewportLines[0].top-e>200?t:this.viewportLines[0]}elementAtHeight(e){return an(this.heightMap.blockAt(this.scaler.fromDOM(e),this.heightOracle,0,0),this.scaler)}get docHeight(){return this.scaler.toDOM(this.heightMap.height)}get contentHeight(){return this.docHeight+this.paddingTop+this.paddingBottom}}class en{constructor(e,t){this.from=e,this.to=t}}function Bn(r,e,t){let n=[],s=r,c=0;return p.Xs.spans(t,r,e,{span(){},point(u,y){u>s&&(n.push({from:s,to:u}),c+=u-s),s=y}},20),s<e&&(n.push({from:s,to:e}),c+=e-s),{total:c,ranges:n}}function li({total:r,ranges:e},t){if(t<=0)return e[0].from;if(t>=1)return e[e.length-1].to;let n=Math.floor(r*t);for(let s=0;;s++){let{from:c,to:u}=e[s],y=u-c;if(n<=y)return c+n;n-=y}}function ln(r,e){let t=0;for(let{from:n,to:s}of r.ranges){if(e<=s){t+=e-n;break}t+=s-n}return t/r.total}function ji(r,e){for(let t of r)if(e(t))return t}const Ws={toDOM(r){return r},fromDOM(r){return r},scale:1};class nr{constructor(e,t,n){let s=0,c=0,u=0;this.viewports=n.map(({from:y,to:b})=>{let M=t.lineAt(y,Ae.ByPos,e,0,0).top,A=t.lineAt(b,Ae.ByPos,e,0,0).bottom;return s+=A-M,{from:y,to:b,top:M,bottom:A,domTop:0,domBottom:0}}),this.scale=(7e6-s)/(t.height-s);for(let y of this.viewports)y.domTop=u+(y.top-c)*this.scale,u=y.domBottom=y.domTop+(y.bottom-y.top),c=y.bottom}toDOM(e){for(let t=0,n=0,s=0;;t++){let c=t<this.viewports.length?this.viewports[t]:null;if(!c||e<c.top)return s+(e-n)*this.scale;if(e<=c.bottom)return c.domTop+(e-c.top);n=c.bottom,s=c.domBottom}}fromDOM(e){for(let t=0,n=0,s=0;;t++){let c=t<this.viewports.length?this.viewports[t]:null;if(!c||e<c.domTop)return n+(e-s)/this.scale;if(e<=c.domBottom)return c.top+(e-c.domTop);n=c.bottom,s=c.domBottom}}}function an(r,e){if(e.scale==1)return r;let t=e.toDOM(r.top),n=e.toDOM(r.bottom);return new it(r.from,r.length,t,n-t,Array.isArray(r._content)?r._content.map(s=>an(s,e)):r._content)}const Ii=p.r$.define({combine:r=>r.join(" ")}),Xn=p.r$.define({combine:r=>r.indexOf(!0)>-1}),Ln=we.V.newName(),Fi=we.V.newName(),In=we.V.newName(),vn={"&light":"."+Fi,"&dark":"."+In};function ls(r,e,t){return new we.V(e,{finish(n){return/&/.test(n)?n.replace(/&\w*/,s=>{if(s=="&")return r;if(!t||!t[s])throw new RangeError(`Unsupported selector: ${s}`);return t[s]}):r+" "+n}})}const Hs=ls("."+Ln,{"&":{position:"relative !important",boxSizing:"border-box","&.cm-focused":{outline:"1px dotted #212121"},display:"flex !important",flexDirection:"column"},".cm-scroller":{display:"flex !important",alignItems:"flex-start !important",fontFamily:"monospace",lineHeight:1.4,height:"100%",overflowX:"auto",position:"relative",zIndex:0},".cm-content":{margin:0,flexGrow:2,flexShrink:0,display:"block",whiteSpace:"pre",wordWrap:"normal",boxSizing:"border-box",minHeight:"100%",padding:"4px 0",outline:"none","&[contenteditable=true]":{WebkitUserModify:"read-write-plaintext-only"}},".cm-lineWrapping":{whiteSpace_fallback:"pre-wrap",whiteSpace:"break-spaces",wordBreak:"break-word",overflowWrap:"anywhere",flexShrink:1},"&light .cm-content":{caretColor:"black"},"&dark .cm-content":{caretColor:"white"},".cm-line":{display:"block",padding:"0 2px 0 6px"},".cm-layer":{position:"absolute",left:0,top:0,contain:"size style","& > *":{position:"absolute"}},"&light .cm-selectionBackground":{background:"#d9d9d9"},"&dark .cm-selectionBackground":{background:"#222"},"&light.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#d7d4f0"},"&dark.cm-focused > .cm-scroller > .cm-selectionLayer .cm-selectionBackground":{background:"#233"},".cm-cursorLayer":{pointerEvents:"none"},"&.cm-focused > .cm-scroller > .cm-cursorLayer":{animation:"steps(1) cm-blink 1.2s infinite"},"@keyframes cm-blink":{"0%":{},"50%":{opacity:0},"100%":{}},"@keyframes cm-blink2":{"0%":{},"50%":{opacity:0},"100%":{}},".cm-cursor, .cm-dropCursor":{borderLeft:"1.2px solid black",marginLeft:"-0.6px",pointerEvents:"none"},".cm-cursor":{display:"none"},"&dark .cm-cursor":{borderLeftColor:"#444"},".cm-dropCursor":{position:"absolute"},"&.cm-focused > .cm-scroller > .cm-cursorLayer .cm-cursor":{display:"block"},".cm-announced":{position:"fixed",top:"-10000px"},"@media print":{".cm-announced":{display:"none"}},"&light .cm-activeLine":{backgroundColor:"#cceeff44"},"&dark .cm-activeLine":{backgroundColor:"#99eeff33"},"&light .cm-specialChar":{color:"red"},"&dark .cm-specialChar":{color:"#f78"},".cm-gutters":{flexShrink:0,display:"flex",height:"100%",boxSizing:"border-box",insetInlineStart:0,zIndex:200},"&light .cm-gutters":{backgroundColor:"#f5f5f5",color:"#6c6c6c",borderRight:"1px solid #ddd"},"&dark .cm-gutters":{backgroundColor:"#333338",color:"#ccc"},".cm-gutter":{display:"flex !important",flexDirection:"column",flexShrink:0,boxSizing:"border-box",minHeight:"100%",overflow:"hidden"},".cm-gutterElement":{boxSizing:"border-box"},".cm-lineNumbers .cm-gutterElement":{padding:"0 3px 0 5px",minWidth:"20px",textAlign:"right",whiteSpace:"nowrap"},"&light .cm-activeLineGutter":{backgroundColor:"#e2f2ff"},"&dark .cm-activeLineGutter":{backgroundColor:"#222227"},".cm-panels":{boxSizing:"border-box",position:"sticky",left:0,right:0},"&light .cm-panels":{backgroundColor:"#f5f5f5",color:"black"},"&light .cm-panels-top":{borderBottom:"1px solid #ddd"},"&light .cm-panels-bottom":{borderTop:"1px solid #ddd"},"&dark .cm-panels":{backgroundColor:"#333338",color:"white"},".cm-tab":{display:"inline-block",overflow:"hidden",verticalAlign:"bottom"},".cm-widgetBuffer":{verticalAlign:"text-top",height:"1em",width:0,display:"inline"},".cm-placeholder":{color:"#888",display:"inline-block",verticalAlign:"top"},".cm-highlightSpace:before":{content:"attr(data-display)",position:"absolute",pointerEvents:"none",color:"#888"},".cm-highlightTab":{backgroundImage:`url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" width="200" height="20"><path stroke="%23888" stroke-width="1" fill="none" d="M1 10H196L190 5M190 15L196 10M197 4L197 16"/></svg>')`,backgroundSize:"auto 100%",backgroundPosition:"right 90%",backgroundRepeat:"no-repeat"},".cm-trailingSpace":{backgroundColor:"#ff332255"},".cm-button":{verticalAlign:"middle",color:"inherit",fontSize:"70%",padding:".2em 1em",borderRadius:"1px"},"&light .cm-button":{backgroundImage:"linear-gradient(#eff1f5, #d9d9df)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#b4b4b4, #d0d3d6)"}},"&dark .cm-button":{backgroundImage:"linear-gradient(#393939, #111)",border:"1px solid #888","&:active":{backgroundImage:"linear-gradient(#111, #333)"}},".cm-textfield":{verticalAlign:"middle",color:"inherit",fontSize:"70%",border:"1px solid silver",padding:".2em .5em"},"&light .cm-textfield":{backgroundColor:"white"},"&dark .cm-textfield":{border:"1px solid #555",backgroundColor:"inherit"}},vn),tn="\uFFFF";class sr{constructor(e,t){this.points=e,this.text="",this.lineSeparator=t.facet(p.yy.lineSeparator)}append(e){this.text+=e}lineBreak(){this.text+=tn}readRange(e,t){if(!e)return this;let n=e.parentNode;for(let s=e;;){this.findPointBefore(n,s);let c=this.text.length;this.readNode(s);let u=s.nextSibling;if(u==t)break;let y=be.get(s),b=be.get(u);(y&&b?y.breakAfter:(y?y.breakAfter:as(s))||as(u)&&(s.nodeName!="BR"||s.cmIgnore)&&this.text.length>c)&&this.lineBreak(),s=u}return this.findPointBefore(n,t),this}readTextNode(e){let t=e.nodeValue;for(let n of this.points)n.node==e&&(n.pos=this.text.length+Math.min(n.offset,t.length));for(let n=0,s=this.lineSeparator?null:/\r\n?|\n/g;;){let c=-1,u=1,y;if(this.lineSeparator?(c=t.indexOf(this.lineSeparator,n),u=this.lineSeparator.length):(y=s.exec(t))&&(c=y.index,u=y[0].length),this.append(t.slice(n,c<0?t.length:c)),c<0)break;if(this.lineBreak(),u>1)for(let b of this.points)b.node==e&&b.pos>this.text.length&&(b.pos-=u-1);n=c+u}}readNode(e){if(e.cmIgnore)return;let t=be.get(e),n=t&&t.overrideDOMText;if(n!=null){this.findPointInside(e,n.length);for(let s=n.iter();!s.next().done;)s.lineBreak?this.lineBreak():this.append(s.value)}else e.nodeType==3?this.readTextNode(e):e.nodeName=="BR"?e.nextSibling&&this.lineBreak():e.nodeType==1&&this.readRange(e.firstChild,null)}findPointBefore(e,t){for(let n of this.points)n.node==e&&e.childNodes[n.offset]==t&&(n.pos=this.text.length)}findPointInside(e,t){for(let n of this.points)(e.nodeType==3?n.node==e:e.contains(n.node))&&(n.pos=this.text.length+(Vs(e,n.node,n.offset)?t:0))}}function Vs(r,e,t){for(;;){if(!e||t<ut(e))return!1;if(e==r)return!0;t=Xt(e)+1,e=e.parentNode}}function as(r){return r.nodeType==1&&/^(DIV|P|LI|UL|OL|BLOCKQUOTE|DD|DT|H\d|SECTION|PRE)$/.test(r.nodeName)}class Nn{constructor(e,t){this.node=e,this.offset=t,this.pos=-1}}class dn{constructor(e,t,n,s){this.typeOver=s,this.bounds=null,this.text="";let{impreciseHead:c,impreciseAnchor:u}=e.docView;if(e.state.readOnly&&t>-1)this.newSel=null;else if(t>-1&&(this.bounds=e.docView.domBoundsAround(t,n,0))){let y=c||u?[]:Yn(e),b=new sr(y,e.state);b.readRange(this.bounds.startDOM,this.bounds.endDOM),this.text=b.text,this.newSel=qn(y,this.bounds.from)}else{let y=e.observer.selectionRange,b=c&&c.node==y.focusNode&&c.offset==y.focusOffset||!Ze(e.contentDOM,y.focusNode)?e.state.selection.main.head:e.docView.posFromDOM(y.focusNode,y.focusOffset),M=u&&u.node==y.anchorNode&&u.offset==y.anchorOffset||!Ze(e.contentDOM,y.anchorNode)?e.state.selection.main.anchor:e.docView.posFromDOM(y.anchorNode,y.anchorOffset);this.newSel=p.jT.single(M,b)}}}function Ss(r,e){let t,{newSel:n}=e,s=r.state.selection.main,c=r.inputState.lastKeyTime>Date.now()-100?r.inputState.lastKeyCode:-1;if(e.bounds){let{from:u,to:y}=e.bounds,b=s.from,M=null;(c===8||C.android&&e.text.length<y-u)&&(b=s.to,M="end");let A=Wn(r.state.doc.sliceString(u,y,tn),e.text,b-u,M);A&&(C.chrome&&c==13&&A.toB==A.from+2&&e.text.slice(A.from,A.toB)==tn+tn&&A.toB--,t={from:u+A.from,to:u+A.toA,insert:p.xv.of(e.text.slice(A.from,A.toB).split(tn))})}else n&&(!r.hasFocus&&r.state.facet(Ji)||n.main.eq(s))&&(n=null);if(!t&&!n)return!1;if(!t&&e.typeOver&&!s.empty&&n&&n.main.empty?t={from:s.from,to:s.to,insert:r.state.doc.slice(s.from,s.to)}:t&&t.from>=s.from&&t.to<=s.to&&(t.from!=s.from||t.to!=s.to)&&s.to-s.from-(t.to-t.from)<=4?t={from:s.from,to:s.to,insert:r.state.doc.slice(s.from,t.from).append(t.insert).append(r.state.doc.slice(t.to,s.to))}:(C.mac||C.android)&&t&&t.from==t.to&&t.from==s.head-1&&/^\. ?$/.test(t.insert.toString())&&r.contentDOM.getAttribute("autocorrect")=="off"?(n&&t.insert.length==2&&(n=p.jT.single(n.main.anchor-1,n.main.head-1)),t={from:s.from,to:s.to,insert:p.xv.of([" "])}):C.chrome&&t&&t.from==t.to&&t.from==s.head&&t.insert.toString()==`
 `&&r.lineWrapping&&(n&&(n=p.jT.single(n.main.anchor-1,n.main.head-1)),t={from:s.from,to:s.to,insert:p.xv.of([" "])}),t){if(C.ios&&r.inputState.flushIOSKey()||C.android&&(t.from==s.from&&t.to==s.to&&t.insert.length==1&&t.insert.lines==2&&ai(r.contentDOM,"Enter",13)||(t.from==s.from-1&&t.to==s.to&&t.insert.length==0||c==8&&t.insert.length<t.to-t.from&&t.to>s.head)&&ai(r.contentDOM,"Backspace",8)||t.from==s.from&&t.to==s.to+1&&t.insert.length==0&&ai(r.contentDOM,"Delete",46)))return!0;let u=t.insert.toString();r.inputState.composing>=0&&r.inputState.composing++;let y,b=()=>y||(y=Fn(r,t,n));return r.state.facet(Lt).some(M=>M(r,t.from,t.to,u,b))||r.dispatch(b()),!0}else if(n&&!n.main.eq(s)){let u=!1,y="select";return r.inputState.lastSelectionTime>Date.now()-50&&(r.inputState.lastSelectionOrigin=="select"&&(u=!0),y=r.inputState.lastSelectionOrigin),r.dispatch({selection:n,scrollIntoView:u,userEvent:y}),!0}else return!1}function Fn(r,e,t){let n,s=r.state,c=s.selection.main;if(e.from>=c.from&&e.to<=c.to&&e.to-e.from>=(c.to-c.from)/3&&(!t||t.main.empty&&t.main.from==e.from+e.insert.length)&&r.inputState.composing<0){let y=c.from<e.from?s.sliceDoc(c.from,e.from):"",b=c.to>e.to?s.sliceDoc(e.to,c.to):"";n=s.replaceSelection(r.state.toText(y+e.insert.sliceString(0,void 0,r.state.lineBreak)+b))}else{let y=s.changes(e),b=t&&t.main.to<=y.newLength?t.main:void 0;if(s.selection.ranges.length>1&&r.inputState.composing>=0&&e.to<=c.to&&e.to>=c.to-10){let M=r.state.sliceDoc(e.from,e.to),A,F=t&&W(r,t.main.head);if(F){let _=e.insert.length-(e.to-e.from);A={from:F.from,to:F.to-_}}else A=r.state.doc.lineAt(c.head);let $=c.to-e.to,X=c.to-c.from;n=s.changeByRange(_=>{if(_.from==c.from&&_.to==c.to)return{changes:y,range:b||_.map(y)};let le=_.to-$,se=le-M.length;if(_.to-_.from!=X||r.state.sliceDoc(se,le)!=M||_.to>=A.from&&_.from<=A.to)return{range:_};let de=s.changes({from:se,to:le,insert:e.insert}),Je=_.to-c.to;return{changes:de,range:b?p.jT.range(Math.max(0,b.anchor+Je),Math.max(0,b.head+Je)):_.map(de)}})}else n={changes:y,selection:b&&s.selection.replaceRange(b)}}let u="input.type";return(r.composing||r.inputState.compositionPendingChange&&r.inputState.compositionEndedAt>Date.now()-50)&&(r.inputState.compositionPendingChange=!1,u+=".compose",r.inputState.compositionFirstChange&&(u+=".start",r.inputState.compositionFirstChange=!1)),s.update(n,{userEvent:u,scrollIntoView:!0})}function Wn(r,e,t,n){let s=Math.min(r.length,e.length),c=0;for(;c<s&&r.charCodeAt(c)==e.charCodeAt(c);)c++;if(c==s&&r.length==e.length)return null;let u=r.length,y=e.length;for(;u>0&&y>0&&r.charCodeAt(u-1)==e.charCodeAt(y-1);)u--,y--;if(n=="end"){let b=Math.max(0,c-Math.min(u,y));t-=u+b-c}if(u<c&&r.length<e.length){let b=t<=c&&t>=u?c-t:0;c-=b,y=c+(y-u),u=c}else if(y<c){let b=t<=c&&t>=y?c-t:0;c-=b,u=c+(u-y),y=c}return{from:c,toA:u,toB:y}}function Yn(r){let e=[];if(r.root.activeElement!=r.contentDOM)return e;let{anchorNode:t,anchorOffset:n,focusNode:s,focusOffset:c}=r.observer.selectionRange;return t&&(e.push(new Nn(t,n)),(s!=t||c!=n)&&e.push(new Nn(s,c))),e}function qn(r,e){if(r.length==0)return null;let t=r[0].pos,n=r.length==2?r[1].pos:t;return t>-1&&n>-1?p.jT.single(t+e,n+e):null}const Qn={childList:!0,characterData:!0,subtree:!0,attributes:!0,characterDataOldValue:!0},Hn=C.ie&&C.ie_version<=11;class zs{constructor(e){this.view=e,this.active=!1,this.selectionRange=new Oi,this.selectionChanged=!1,this.delayedFlush=-1,this.resizeTimeout=-1,this.queue=[],this.delayedAndroidKey=null,this.flushingAndroidKey=-1,this.lastChange=0,this.scrollTargets=[],this.intersection=null,this.resizeScroll=null,this.intersecting=!1,this.gapIntersection=null,this.gaps=[],this.parentCheck=-1,this.dom=e.contentDOM,this.observer=new MutationObserver(t=>{for(let n of t)this.queue.push(n);(C.ie&&C.ie_version<=11||C.ios&&e.composing)&&t.some(n=>n.type=="childList"&&n.removedNodes.length||n.type=="characterData"&&n.oldValue.length>n.target.nodeValue.length)?this.flushSoon():this.flush()}),Hn&&(this.onCharData=t=>{this.queue.push({target:t.target,type:"characterData",oldValue:t.prevValue}),this.flushSoon()}),this.onSelectionChange=this.onSelectionChange.bind(this),this.onResize=this.onResize.bind(this),this.onPrint=this.onPrint.bind(this),this.onScroll=this.onScroll.bind(this),typeof ResizeObserver=="function"&&(this.resizeScroll=new ResizeObserver(()=>{var t;((t=this.view.docView)===null||t===void 0?void 0:t.lastUpdate)<Date.now()-75&&this.onResize()}),this.resizeScroll.observe(e.scrollDOM)),this.addWindowListeners(this.win=e.win),this.start(),typeof IntersectionObserver=="function"&&(this.intersection=new IntersectionObserver(t=>{this.parentCheck<0&&(this.parentCheck=setTimeout(this.listenForScroll.bind(this),1e3)),t.length>0&&t[t.length-1].intersectionRatio>0!=this.intersecting&&(this.intersecting=!this.intersecting,this.intersecting!=this.view.inView&&this.onScrollChanged(document.createEvent("Event")))},{threshold:[0,.001]}),this.intersection.observe(this.dom),this.gapIntersection=new IntersectionObserver(t=>{t.length>0&&t[t.length-1].intersectionRatio>0&&this.onScrollChanged(document.createEvent("Event"))},{})),this.listenForScroll(),this.readSelectionRange()}onScrollChanged(e){this.view.inputState.runHandlers("scroll",e),this.intersecting&&this.view.measure()}onScroll(e){this.intersecting&&this.flush(!1),this.onScrollChanged(e)}onResize(){this.resizeTimeout<0&&(this.resizeTimeout=setTimeout(()=>{this.resizeTimeout=-1,this.view.requestMeasure()},50))}onPrint(){this.view.viewState.printing=!0,this.view.measure(),setTimeout(()=>{this.view.viewState.printing=!1,this.view.requestMeasure()},500)}updateGaps(e){if(this.gapIntersection&&(e.length!=this.gaps.length||this.gaps.some((t,n)=>t!=e[n]))){this.gapIntersection.disconnect();for(let t of e)this.gapIntersection.observe(t);this.gaps=e}}onSelectionChange(e){let t=this.selectionChanged;if(!this.readSelectionRange()||this.delayedAndroidKey)return;let{view:n}=this,s=this.selectionRange;if(n.state.facet(Ji)?n.root.activeElement!=this.dom:!_e(n.dom,s))return;let c=s.anchorNode&&n.docView.nearest(s.anchorNode);if(c&&c.ignoreEvent(e)){t||(this.selectionChanged=!1);return}(C.ie&&C.ie_version<=11||C.android&&C.chrome)&&!n.state.selection.main.empty&&s.focusNode&&mi(s.focusNode,s.focusOffset,s.anchorNode,s.anchorOffset)?this.flushSoon():this.flush(!1)}readSelectionRange(){let{view:e}=this,t=C.safari&&e.root.nodeType==11&&nt(this.dom.ownerDocument)==this.dom&&bn(this.view)||xt(e.root);if(!t||this.selectionRange.eq(t))return!1;let n=_e(this.dom,t);return n&&!this.selectionChanged&&e.inputState.lastFocusTime>Date.now()-200&&e.inputState.lastTouchTime<Date.now()-300&&Ge(this.dom,t)?(this.view.inputState.lastFocusTime=0,e.docView.updateSelection(),!1):(this.selectionRange.setRange(t),n&&(this.selectionChanged=!0),!0)}setSelectionRange(e,t){this.selectionRange.set(e.node,e.offset,t.node,t.offset),this.selectionChanged=!1}clearSelectionRange(){this.selectionRange.set(null,0,null,0)}listenForScroll(){this.parentCheck=-1;let e=0,t=null;for(let n=this.dom;n;)if(n.nodeType==1)!t&&e<this.scrollTargets.length&&this.scrollTargets[e]==n?e++:t||(t=this.scrollTargets.slice(0,e)),t&&t.push(n),n=n.assignedSlot||n.parentNode;else if(n.nodeType==11)n=n.host;else break;if(e<this.scrollTargets.length&&!t&&(t=this.scrollTargets.slice(0,e)),t){for(let n of this.scrollTargets)n.removeEventListener("scroll",this.onScroll);for(let n of this.scrollTargets=t)n.addEventListener("scroll",this.onScroll)}}ignore(e){if(!this.active)return e();try{return this.stop(),e()}finally{this.start(),this.clear()}}start(){this.active||(this.observer.observe(this.dom,Qn),Hn&&this.dom.addEventListener("DOMCharacterDataModified",this.onCharData),this.active=!0)}stop(){this.active&&(this.active=!1,this.observer.disconnect(),Hn&&this.dom.removeEventListener("DOMCharacterDataModified",this.onCharData))}clear(){this.processRecords(),this.queue.length=0,this.selectionChanged=!1}delayAndroidKey(e,t){var n;if(!this.delayedAndroidKey){let s=()=>{let c=this.delayedAndroidKey;c&&(this.clearDelayedAndroidKey(),this.view.inputState.lastKeyCode=c.keyCode,this.view.inputState.lastKeyTime=Date.now(),!this.flush()&&c.force&&ai(this.dom,c.key,c.keyCode))};this.flushingAndroidKey=this.view.win.requestAnimationFrame(s)}(!this.delayedAndroidKey||e=="Enter")&&(this.delayedAndroidKey={key:e,keyCode:t,force:this.lastChange<Date.now()-50||!!(!((n=this.delayedAndroidKey)===null||n===void 0)&&n.force)})}clearDelayedAndroidKey(){this.win.cancelAnimationFrame(this.flushingAndroidKey),this.delayedAndroidKey=null,this.flushingAndroidKey=-1}flushSoon(){this.delayedFlush<0&&(this.delayedFlush=this.view.win.requestAnimationFrame(()=>{this.delayedFlush=-1,this.flush()}))}forceFlush(){this.delayedFlush>=0&&(this.view.win.cancelAnimationFrame(this.delayedFlush),this.delayedFlush=-1),this.flush()}pendingRecords(){for(let e of this.observer.takeRecords())this.queue.push(e);return this.queue}processRecords(){let e=this.pendingRecords();e.length&&(this.queue=[]);let t=-1,n=-1,s=!1;for(let c of e){let u=this.readMutation(c);u&&(u.typeOver&&(s=!0),t==-1?{from:t,to:n}=u:(t=Math.min(u.from,t),n=Math.max(u.to,n)))}return{from:t,to:n,typeOver:s}}readChange(){let{from:e,to:t,typeOver:n}=this.processRecords(),s=this.selectionChanged&&_e(this.dom,this.selectionRange);if(e<0&&!s)return null;e>-1&&(this.lastChange=Date.now()),this.view.inputState.lastFocusTime=0,this.selectionChanged=!1;let c=new dn(this.view,e,t,n);return this.view.docView.domChanged={newSel:c.newSel?c.newSel.main:null},c}flush(e=!0){if(this.delayedFlush>=0||this.delayedAndroidKey)return!1;e&&this.readSelectionRange();let t=this.readChange();if(!t)return this.view.requestMeasure(),!1;let n=this.view.state,s=Ss(this.view,t);return this.view.state==n&&this.view.update([]),s}readMutation(e){let t=this.view.docView.nearest(e.target);if(!t||t.ignoreMutation(e))return null;if(t.markDirty(e.type=="attributes"),e.type=="attributes"&&(t.flags|=4),e.type=="childList"){let n=wi(t,e.previousSibling||e.target.previousSibling,-1),s=wi(t,e.nextSibling||e.target.nextSibling,1);return{from:n?t.posAfter(n):t.posAtStart,to:s?t.posBefore(s):t.posAtEnd,typeOver:!1}}else return e.type=="characterData"?{from:t.posAtStart,to:t.posAtEnd,typeOver:e.target.nodeValue==e.oldValue}:null}setWindow(e){e!=this.win&&(this.removeWindowListeners(this.win),this.win=e,this.addWindowListeners(this.win))}addWindowListeners(e){e.addEventListener("resize",this.onResize),e.addEventListener("beforeprint",this.onPrint),e.addEventListener("scroll",this.onScroll),e.document.addEventListener("selectionchange",this.onSelectionChange)}removeWindowListeners(e){e.removeEventListener("scroll",this.onScroll),e.removeEventListener("resize",this.onResize),e.removeEventListener("beforeprint",this.onPrint),e.document.removeEventListener("selectionchange",this.onSelectionChange)}destroy(){var e,t,n;this.stop(),(e=this.intersection)===null||e===void 0||e.disconnect(),(t=this.gapIntersection)===null||t===void 0||t.disconnect(),(n=this.resizeScroll)===null||n===void 0||n.disconnect();for(let s of this.scrollTargets)s.removeEventListener("scroll",this.onScroll);this.removeWindowListeners(this.win),clearTimeout(this.parentCheck),clearTimeout(this.resizeTimeout),this.win.cancelAnimationFrame(this.delayedFlush),this.win.cancelAnimationFrame(this.flushingAndroidKey)}}function wi(r,e,t){for(;e;){let n=be.get(e);if(n&&n.parent==r)return n;let s=e.parentNode;e=s!=r.dom?s:t>0?e.nextSibling:e.previousSibling}return null}function bn(r){let e=null;function t(b){b.preventDefault(),b.stopImmediatePropagation(),e=b.getTargetRanges()[0]}if(r.contentDOM.addEventListener("beforeinput",t,!0),r.dom.ownerDocument.execCommand("indent"),r.contentDOM.removeEventListener("beforeinput",t,!0),!e)return null;let n=e.startContainer,s=e.startOffset,c=e.endContainer,u=e.endOffset,y=r.docView.domAtPos(r.state.selection.main.anchor);return mi(y.node,y.offset,c,u)&&([n,s,c,u]=[c,u,n,s]),{anchorNode:n,anchorOffset:s,focusNode:c,focusOffset:u}}class Mt{get state(){return this.viewState.state}get viewport(){return this.viewState.viewport}get visibleRanges(){return this.viewState.visibleRanges}get inView(){return this.viewState.inView}get composing(){return this.inputState.composing>0}get compositionStarted(){return this.inputState.composing>=0}get root(){return this._root}get win(){return this.dom.ownerDocument.defaultView||window}constructor(e={}){this.plugins=[],this.pluginMap=new Map,this.editorAttrs={},this.contentAttrs={},this.bidiCache=[],this.destroyed=!1,this.updateState=2,this.measureScheduled=-1,this.measureRequests=[],this.contentDOM=document.createElement("div"),this.scrollDOM=document.createElement("div"),this.scrollDOM.tabIndex=-1,this.scrollDOM.className="cm-scroller",this.scrollDOM.appendChild(this.contentDOM),this.announceDOM=document.createElement("div"),this.announceDOM.className="cm-announced",this.announceDOM.setAttribute("aria-live","polite"),this.dom=document.createElement("div"),this.dom.appendChild(this.announceDOM),this.dom.appendChild(this.scrollDOM),e.parent&&e.parent.appendChild(this.dom);let{dispatch:t}=e;this.dispatchTransactions=e.dispatchTransactions||t&&(n=>n.forEach(s=>t(s,this)))||(n=>this.update(n)),this.dispatch=this.dispatch.bind(this),this._root=e.root||_t(e.parent)||document,this.viewState=new Xi(e.state||p.yy.create(e)),e.scrollTo&&e.scrollTo.is(Qi)&&(this.viewState.scrollTarget=e.scrollTo.value.clip(this.viewState.state)),this.plugins=this.state.facet(fn).map(n=>new kn(n));for(let n of this.plugins)n.update(this);this.observer=new zs(this),this.inputState=new to(this),this.inputState.ensureHandlers(this.plugins),this.docView=new g(this),this.mountStyles(),this.updateAttrs(),this.updateState=0,this.requestMeasure()}dispatch(...e){let t=e.length==1&&e[0]instanceof p.YW?e:e.length==1&&Array.isArray(e[0])?e[0]:[this.state.update(...e)];this.dispatchTransactions(t,this)}update(e){if(this.updateState!=0)throw new Error("Calls to EditorView.update are not allowed while an update is in progress");let t=!1,n=!1,s,c=this.state;for(let $ of e){if($.startState!=c)throw new RangeError("Trying to update state with a transaction that doesn't start from the previous state.");c=$.state}if(this.destroyed){this.viewState.state=c;return}let u=this.hasFocus,y=0,b=null;e.some($=>$.annotation(z))?(this.inputState.notifiedFocused=u,y=1):u!=this.inputState.notifiedFocused&&(this.inputState.notifiedFocused=u,b=Q(c,u),b||(y=1));let M=this.observer.delayedAndroidKey,A=null;if(M?(this.observer.clearDelayedAndroidKey(),A=this.observer.readChange(),(A&&!this.state.doc.eq(c.doc)||!this.state.selection.eq(c.selection))&&(A=null)):this.observer.clear(),c.facet(p.yy.phrases)!=this.state.facet(p.yy.phrases))return this.setState(c);s=H.create(this,c,e),s.flags|=y;let F=this.viewState.scrollTarget;try{this.updateState=2;for(let $ of e){if(F&&(F=F.map($.changes)),$.scrollIntoView){let{main:X}=$.state.selection;F=new Ki(X.empty?X:p.jT.cursor(X.head,X.head>X.anchor?-1:1))}for(let X of $.effects)X.is(Qi)&&(F=X.value.clip(this.state))}this.viewState.update(s,F),this.bidiCache=cs.update(this.bidiCache,s.changes),s.empty||(this.updatePlugins(s),this.inputState.update(s)),t=this.docView.update(s),this.state.facet(E)!=this.styleModules&&this.mountStyles(),n=this.updateAttrs(),this.showAnnouncements(e),this.docView.updateSelection(t,e.some($=>$.isUserEvent("select.pointer")))}finally{this.updateState=0}if(s.startState.facet(Ii)!=s.state.facet(Ii)&&(this.viewState.mustMeasureContent=!0),(t||n||F||this.viewState.mustEnforceCursorAssoc||this.viewState.mustMeasureContent)&&this.requestMeasure(),!s.empty)for(let $ of this.state.facet(Ci))try{$(s)}catch(X){ri(this.state,X,"update listener")}(b||A)&&Promise.resolve().then(()=>{b&&this.state==b.startState&&this.dispatch(b),A&&!Ss(this,A)&&M.force&&ai(this.contentDOM,M.key,M.keyCode)})}setState(e){if(this.updateState!=0)throw new Error("Calls to EditorView.setState are not allowed while an update is in progress");if(this.destroyed){this.viewState.state=e;return}this.updateState=2;let t=this.hasFocus;try{for(let n of this.plugins)n.destroy(this);this.viewState=new Xi(e),this.plugins=e.facet(fn).map(n=>new kn(n)),this.pluginMap.clear();for(let n of this.plugins)n.update(this);this.docView.destroy(),this.docView=new g(this),this.inputState.ensureHandlers(this.plugins),this.mountStyles(),this.updateAttrs(),this.bidiCache=[]}finally{this.updateState=0}t&&this.focus(),this.requestMeasure()}updatePlugins(e){let t=e.startState.facet(fn),n=e.state.facet(fn);if(t!=n){let s=[];for(let c of n){let u=t.indexOf(c);if(u<0)s.push(new kn(c));else{let y=this.plugins[u];y.mustUpdate=e,s.push(y)}}for(let c of this.plugins)c.mustUpdate!=e&&c.destroy(this);this.plugins=s,this.pluginMap.clear()}else for(let s of this.plugins)s.mustUpdate=e;for(let s=0;s<this.plugins.length;s++)this.plugins[s].update(this);t!=n&&this.inputState.ensureHandlers(this.plugins)}measure(e=!0){if(this.destroyed)return;if(this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.observer.delayedAndroidKey){this.measureScheduled=-1,this.requestMeasure();return}this.measureScheduled=0,e&&this.observer.forceFlush();let t=null,n=this.scrollDOM,s=n.scrollTop*this.scaleY,{scrollAnchorPos:c,scrollAnchorHeight:u}=this.viewState;Math.abs(s-this.viewState.scrollTop)>1&&(u=-1),this.viewState.scrollAnchorHeight=-1;try{for(let y=0;;y++){if(u<0)if(Mi(n))c=-1,u=this.viewState.heightMap.height;else{let X=this.viewState.scrollAnchorAt(s);c=X.from,u=X.top}this.updateState=1;let b=this.viewState.measure(this);if(!b&&!this.measureRequests.length&&this.viewState.scrollTarget==null)break;if(y>5){console.warn(this.measureRequests.length?"Measure loop restarted more than 5 times":"Viewport failed to stabilize");break}let M=[];b&4||([this.measureRequests,M]=[M,this.measureRequests]);let A=M.map(X=>{try{return X.read(this)}catch(_){return ri(this.state,_),hs}}),F=H.create(this,this.state,[]),$=!1;F.flags|=b,t?t.flags|=b:t=F,this.updateState=2,F.empty||(this.updatePlugins(F),this.inputState.update(F),this.updateAttrs(),$=this.docView.update(F));for(let X=0;X<M.length;X++)if(A[X]!=hs)try{let _=M[X];_.write&&_.write(A[X],this)}catch(_){ri(this.state,_)}if($&&this.docView.updateSelection(!0),!F.viewportChanged&&this.measureRequests.length==0){if(this.viewState.editorHeight)if(this.viewState.scrollTarget){this.docView.scrollIntoView(this.viewState.scrollTarget),this.viewState.scrollTarget=null,u=-1;continue}else{let _=(c<0?this.viewState.heightMap.height:this.viewState.lineBlockAt(c).top)-u;if(_>1||_<-1){s=s+_,n.scrollTop=s/this.scaleY,u=-1;continue}}break}}}finally{this.updateState=0,this.measureScheduled=-1}if(t&&!t.empty)for(let y of this.state.facet(Ci))y(t)}get themeClasses(){return Ln+" "+(this.state.facet(Xn)?In:Fi)+" "+this.state.facet(Ii)}updateAttrs(){let e=rr(this,Cn,{class:"cm-editor"+(this.hasFocus?" cm-focused ":" ")+this.themeClasses}),t={spellcheck:"false",autocorrect:"off",autocapitalize:"off",translate:"no",contenteditable:this.state.facet(Ji)?"true":"false",class:"cm-content",style:`${C.tabSize}: ${this.state.tabSize}`,role:"textbox","aria-multiline":"true"};this.state.readOnly&&(t["aria-readonly"]="true"),rr(this,ns,t);let n=this.observer.ignore(()=>{let s=$t(this.contentDOM,this.contentAttrs,t),c=$t(this.dom,this.editorAttrs,e);return s||c});return this.editorAttrs=e,this.contentAttrs=t,n}showAnnouncements(e){let t=!0;for(let n of e)for(let s of n.effects)if(s.is(Mt.announce)){t&&(this.announceDOM.textContent=""),t=!1;let c=this.announceDOM.appendChild(document.createElement("div"));c.textContent=s.value}}mountStyles(){this.styleModules=this.state.facet(E);let e=this.state.facet(Mt.cspNonce);we.V.mount(this.root,this.styleModules.concat(Hs).reverse(),e?{nonce:e}:void 0)}readMeasured(){if(this.updateState==2)throw new Error("Reading the editor layout isn't allowed during an update");this.updateState==0&&this.measureScheduled>-1&&this.measure(!1)}requestMeasure(e){if(this.measureScheduled<0&&(this.measureScheduled=this.win.requestAnimationFrame(()=>this.measure())),e){if(this.measureRequests.indexOf(e)>-1)return;if(e.key!=null){for(let t=0;t<this.measureRequests.length;t++)if(this.measureRequests[t].key===e.key){this.measureRequests[t]=e;return}}this.measureRequests.push(e)}}plugin(e){let t=this.pluginMap.get(e);return(t===void 0||t&&t.spec!=e)&&this.pluginMap.set(e,t=this.plugins.find(n=>n.spec==e)||null),t&&t.update(this).value}get documentTop(){return this.contentDOM.getBoundingClientRect().top+this.viewState.paddingTop}get documentPadding(){return{top:this.viewState.paddingTop,bottom:this.viewState.paddingBottom}}get scaleX(){return this.viewState.scaleX}get scaleY(){return this.viewState.scaleY}elementAtHeight(e){return this.readMeasured(),this.viewState.elementAtHeight(e)}lineBlockAtHeight(e){return this.readMeasured(),this.viewState.lineBlockAtHeight(e)}get viewportLineBlocks(){return this.viewState.viewportLines}lineBlockAt(e){return this.viewState.lineBlockAt(e)}get contentHeight(){return this.viewState.contentHeight}moveByChar(e,t,n){return Mr(this,e,Zn(this,e,t,n))}moveByGroup(e,t){return Mr(this,e,Zn(this,e,t,n=>Kn(this,e.head,n)))}moveToLineBoundary(e,t,n=!0){return Is(this,e,t,n)}moveVertically(e,t,n){return Mr(this,e,Jn(this,e,t,n))}domAtPos(e){return this.docView.domAtPos(e)}posAtDOM(e,t=0){return this.docView.posFromDOM(e,t)}posAtCoords(e,t=!0){return this.readMeasured(),Sn(this,e,t)}coordsAtPos(e,t=1){this.readMeasured();let n=this.docView.coordsAt(e,t);if(!n||n.left==n.right)return n;let s=this.state.doc.lineAt(e),c=this.bidiSpans(s),u=c[mn.find(c,e-s.from,-1,t)];return Kt(n,u.dir==j.LTR==t>0)}coordsForChar(e){return this.readMeasured(),this.docView.coordsForChar(e)}get defaultCharacterWidth(){return this.viewState.heightOracle.charWidth}get defaultLineHeight(){return this.viewState.heightOracle.lineHeight}get textDirection(){return this.viewState.defaultTextDirection}textDirectionAt(e){return!this.state.facet(Ni)||e<this.viewport.from||e>this.viewport.to?this.textDirection:(this.readMeasured(),this.docView.textDirectionAt(e))}get lineWrapping(){return this.viewState.heightOracle.lineWrapping}bidiSpans(e){if(e.length>xn)return An(e.length);let t=this.textDirectionAt(e.from),n;for(let c of this.bidiCache)if(c.from==e.from&&c.dir==t&&(c.fresh||Pn(c.isolates,n=d(this,e.from,e.to))))return c.order;n||(n=d(this,e.from,e.to));let s=bs(e.text,t,n);return this.bidiCache.push(new cs(e.from,e.to,t,n,!0,s)),s}get hasFocus(){var e;return(this.dom.ownerDocument.hasFocus()||C.safari&&((e=this.inputState)===null||e===void 0?void 0:e.lastContextMenu)>Date.now()-3e4)&&this.root.activeElement==this.contentDOM}focus(){this.observer.ignore(()=>{Ot(this.contentDOM),this.docView.updateSelection()})}setRoot(e){this._root!=e&&(this._root=e,this.observer.setWindow((e.nodeType==9?e:e.ownerDocument).defaultView||window),this.mountStyles())}destroy(){for(let e of this.plugins)e.destroy(this);this.plugins=[],this.inputState.destroy(),this.docView.destroy(),this.dom.remove(),this.observer.destroy(),this.measureScheduled>-1&&this.win.cancelAnimationFrame(this.measureScheduled),this.destroyed=!0}static scrollIntoView(e,t={}){return Qi.of(new Ki(typeof e=="number"?p.jT.cursor(e):e,t.y,t.x,t.yMargin,t.xMargin))}scrollSnapshot(){let{scrollTop:e,scrollLeft:t}=this.scrollDOM,n=this.viewState.scrollAnchorAt(e);return Qi.of(new Ki(p.jT.cursor(n.from),"start","start",n.top-e,t,!0))}static domEventHandlers(e){return vi.define(()=>({}),{eventHandlers:e})}static domEventObservers(e){return vi.define(()=>({}),{eventObservers:e})}static theme(e,t){let n=we.V.newName(),s=[Ii.of(n),E.of(ls(`.${n}`,e))];return t&&t.dark&&s.push(Xn.of(!0)),s}static baseTheme(e){return p.Wl.lowest(E.of(ls("."+Ln,e,vn)))}static findFromDOM(e){var t;let n=e.querySelector(".cm-content"),s=n&&be.get(n)||be.get(e);return((t=s==null?void 0:s.rootView)===null||t===void 0?void 0:t.view)||null}}Mt.styleModule=E,Mt.inputHandler=Lt,Mt.focusChangeEffect=zi,Mt.perLineTextDirection=Ni,Mt.exceptionSink=on,Mt.updateListener=Ci,Mt.editable=Ji,Mt.mouseSelectionStyle=yi,Mt.dragMovesSelection=hi,Mt.clickAddsSelectionRange=gi,Mt.decorations=On,Mt.atomicRanges=R,Mt.bidiIsolatedRanges=a,Mt.scrollMargins=v,Mt.darkTheme=Xn,Mt.cspNonce=p.r$.define({combine:r=>r.length?r[0]:""}),Mt.contentAttributes=ns,Mt.editorAttributes=Cn,Mt.lineWrapping=Mt.contentAttributes.of({class:"cm-lineWrapping"}),Mt.announce=p.Py.define();const xn=4096,hs={};class cs{constructor(e,t,n,s,c,u){this.from=e,this.to=t,this.dir=n,this.isolates=s,this.fresh=c,this.order=u}static update(e,t){if(t.empty&&!e.some(c=>c.fresh))return e;let n=[],s=e.length?e[e.length-1].dir:j.LTR;for(let c=Math.max(0,e.length-10);c<e.length;c++){let u=e[c];u.dir==s&&!t.touchesRange(u.from,u.to)&&n.push(new cs(t.mapPos(u.from,1),t.mapPos(u.to,-1),u.dir,u.isolates,!1,u.order))}return n}}function rr(r,e,t){for(let n=r.state.facet(e),s=n.length-1;s>=0;s--){let c=n[s],u=typeof c=="function"?c(r):c;u&&dt(u,t)}return t}const mr=C.mac?"mac":C.windows?"win":C.linux?"linux":"key";function ks(r,e){const t=r.split(/-(?!$)/);let n=t[t.length-1];n=="Space"&&(n=" ");let s,c,u,y;for(let b=0;b<t.length-1;++b){const M=t[b];if(/^(cmd|meta|m)$/i.test(M))y=!0;else if(/^a(lt)?$/i.test(M))s=!0;else if(/^(c|ctrl|control)$/i.test(M))c=!0;else if(/^s(hift)?$/i.test(M))u=!0;else if(/^mod$/i.test(M))e=="mac"?y=!0:c=!0;else throw new Error("Unrecognized modifier name: "+M)}return s&&(n="Alt-"+n),c&&(n="Ctrl-"+n),y&&(n="Meta-"+n),u&&(n="Shift-"+n),n}function Wi(r,e,t){return e.altKey&&(r="Alt-"+r),e.ctrlKey&&(r="Ctrl-"+r),e.metaKey&&(r="Meta-"+r),t!==!1&&e.shiftKey&&(r="Shift-"+r),r}const Oe=p.Wl.default(Mt.domEventHandlers({keydown(r,e){return us(fs(e.state),r,e,"editor")}})),ni=p.r$.define({enables:Oe}),_n=new WeakMap;function fs(r){let e=r.facet(ni),t=_n.get(e);return t||_n.set(e,t=nn(e.reduce((n,s)=>n.concat(s),[]))),t}function Wr(r,e,t){return us(fs(r.state),e,r,t)}let es=null;const $s=4e3;function nn(r,e=mr){let t=Object.create(null),n=Object.create(null),s=(u,y)=>{let b=n[u];if(b==null)n[u]=y;else if(b!=y)throw new Error("Key binding "+u+" is used both as a regular binding and as a multi-stroke prefix")},c=(u,y,b,M,A)=>{var F,$;let X=t[u]||(t[u]=Object.create(null)),_=y.split(/ (?!$)/).map(de=>ks(de,e));for(let de=1;de<_.length;de++){let Je=_.slice(0,de).join(" ");s(Je,!0),X[Je]||(X[Je]={preventDefault:!0,stopPropagation:!1,run:[ht=>{let Ue=es={view:ht,prefix:Je,scope:u};return setTimeout(()=>{es==Ue&&(es=null)},$s),!0}]})}let le=_.join(" ");s(le,!1);let se=X[le]||(X[le]={preventDefault:!1,stopPropagation:!1,run:(($=(F=X._any)===null||F===void 0?void 0:F.run)===null||$===void 0?void 0:$.slice())||[]});b&&se.run.push(b),M&&(se.preventDefault=!0),A&&(se.stopPropagation=!0)};for(let u of r){let y=u.scope?u.scope.split(" "):["editor"];if(u.any)for(let M of y){let A=t[M]||(t[M]=Object.create(null));A._any||(A._any={preventDefault:!1,stopPropagation:!1,run:[]});for(let F in A)A[F].run.push(u.any)}let b=u[e]||u.key;if(b)for(let M of y)c(M,b,u.run,u.preventDefault,u.stopPropagation),u.shift&&c(M,"Shift-"+b,u.shift,u.preventDefault,u.stopPropagation)}return t}function us(r,e,t,n){let s=ft(e),c=(0,p.gm)(s,0),u=(0,p.nZ)(c)==s.length&&s!=" ",y="",b=!1,M=!1,A=!1;es&&es.view==t&&es.scope==n&&(y=es.prefix+" ",fr.indexOf(e.keyCode)<0&&(M=!0,es=null));let F=new Set,$=se=>{if(se){for(let de of se.run)if(!F.has(de)&&(F.add(de),de(t,e)))return se.stopPropagation&&(A=!0),!0;se.preventDefault&&(se.stopPropagation&&(A=!0),M=!0)}return!1},X=r[n],_,le;return X&&($(X[y+Wi(s,e,!u)])?b=!0:u&&(e.altKey||e.metaKey||e.ctrlKey)&&!(C.windows&&e.ctrlKey&&e.altKey)&&(_=ue[e.keyCode])&&_!=s?($(X[y+Wi(_,e,!0)])||e.shiftKey&&(le=L[e.keyCode])!=s&&le!=_&&$(X[y+Wi(le,e,!1)]))&&(b=!0):u&&e.shiftKey&&$(X[y+Wi(s,e,!0)])&&(b=!0),!b&&$(X._any)&&(b=!0)),M&&(b=!0),b&&A&&e.stopPropagation(),b}class js{constructor(e,t,n,s,c){this.className=e,this.left=t,this.top=n,this.width=s,this.height=c}draw(){let e=document.createElement("div");return e.className=this.className,this.adjust(e),e}update(e,t){return t.className!=this.className?!1:(this.adjust(e),!0)}adjust(e){e.style.left=this.left+"px",e.style.top=this.top+"px",this.width!=null&&(e.style.width=this.width+"px"),e.style.height=this.height+"px"}eq(e){return this.left==e.left&&this.top==e.top&&this.width==e.width&&this.height==e.height&&this.className==e.className}static forRange(e,t,n){if(n.empty){let s=e.coordsAtPos(n.head,n.assoc||1);if(!s)return[];let c=or(e);return[new js(t,s.left-c.left,s.top-c.top,null,s.bottom-s.top)]}else return Hi(e,t,n)}}function or(r){let e=r.scrollDOM.getBoundingClientRect();return{left:(r.textDirection==j.LTR?e.left:e.right-r.scrollDOM.clientWidth*r.scaleX)-r.scrollDOM.scrollLeft*r.scaleX,top:e.top-r.scrollDOM.scrollTop*r.scaleY}}function Zs(r,e,t){let n=p.jT.cursor(e);return{from:Math.max(t.from,r.moveToLineBoundary(n,!1,!0).from),to:Math.min(t.to,r.moveToLineBoundary(n,!0,!0).from),type:st.Text}}function Hi(r,e,t){if(t.to<=r.viewport.from||t.from>=r.viewport.to)return[];let n=Math.max(t.from,r.viewport.from),s=Math.min(t.to,r.viewport.to),c=r.textDirection==j.LTR,u=r.contentDOM,y=u.getBoundingClientRect(),b=or(r),M=u.querySelector(".cm-line"),A=M&&window.getComputedStyle(M),F=y.left+(A?parseInt(A.paddingLeft)+Math.min(0,parseInt(A.textIndent)):0),$=y.right-(A?parseInt(A.paddingRight):0),X=jn(r,n),_=jn(r,s),le=X.type==st.Text?X:null,se=_.type==st.Text?_:null;if(le&&(r.lineWrapping||X.widgetLineBreaks)&&(le=Zs(r,n,le)),se&&(r.lineWrapping||_.widgetLineBreaks)&&(se=Zs(r,s,se)),le&&se&&le.from==se.from)return Je(ht(t.from,t.to,le));{let at=le?ht(t.from,null,le):Ue(X,!1),kt=se?ht(null,t.to,se):Ue(_,!0),Vi=[];return(le||X).to<(se||_).from-(le&&se?1:0)||X.widgetLineBreaks>1&&at.bottom+r.defaultLineHeight/2<kt.top?Vi.push(de(F,at.bottom,$,kt.top)):at.bottom<kt.top&&r.elementAtHeight((at.bottom+kt.top)/2).type==st.Text&&(at.bottom=kt.top=(at.bottom+kt.top)/2),Je(at).concat(Vi).concat(Je(kt))}function de(at,kt,Vi,sn){return new js(e,at-b.left,kt-b.top-.01,Vi-at,sn-kt+.01)}function Je({top:at,bottom:kt,horizontal:Vi}){let sn=[];for(let Ts=0;Ts<Vi.length;Ts+=2)sn.push(de(Vi[Ts],at,Vi[Ts+1],kt));return sn}function ht(at,kt,Vi){let sn=1e9,Ts=-1e9,Yr=[];function Ko(Ms,Es,hr,Xs,Tr){let ts=r.coordsAtPos(Ms,Ms==Vi.to?-2:2),ms=r.coordsAtPos(hr,hr==Vi.from?2:-2);!ts||!ms||(sn=Math.min(ts.top,ms.top,sn),Ts=Math.max(ts.bottom,ms.bottom,Ts),Tr==j.LTR?Yr.push(c&&Es?F:ts.left,c&&Xs?$:ms.right):Yr.push(!c&&Xs?F:ms.left,!c&&Es?$:ts.right))}let qr=at!=null?at:Vi.from,Qr=kt!=null?kt:Vi.to;for(let Ms of r.visibleRanges)if(Ms.to>qr&&Ms.from<Qr)for(let Es=Math.max(Ms.from,qr),hr=Math.min(Ms.to,Qr);;){let Xs=r.state.doc.lineAt(Es);for(let Tr of r.bidiSpans(Xs)){let ts=Tr.from+Xs.from,ms=Tr.to+Xs.from;if(ts>=hr)break;ms>Es&&Ko(Math.max(ts,Es),at==null&&ts<=qr,Math.min(ms,hr),kt==null&&ms>=Qr,Tr.dir)}if(Es=Xs.to+1,Es>=hr)break}return Yr.length==0&&Ko(qr,at==null,Qr,kt==null,r.textDirection),{top:sn,bottom:Ts,horizontal:Yr}}function Ue(at,kt){let Vi=y.top+(kt?at.top:at.bottom);return{top:Vi,bottom:Vi,horizontal:[]}}}function Hr(r,e){return r.constructor==e.constructor&&r.eq(e)}class ds{constructor(e,t){this.view=e,this.layer=t,this.drawn=[],this.scaleX=1,this.scaleY=1,this.measureReq={read:this.measure.bind(this),write:this.draw.bind(this)},this.dom=e.scrollDOM.appendChild(document.createElement("div")),this.dom.classList.add("cm-layer"),t.above&&this.dom.classList.add("cm-layer-above"),t.class&&this.dom.classList.add(t.class),this.scale(),this.dom.setAttribute("aria-hidden","true"),this.setOrder(e.state),e.requestMeasure(this.measureReq),t.mount&&t.mount(this.dom,e)}update(e){e.startState.facet(Ke)!=e.state.facet(Ke)&&this.setOrder(e.state),(this.layer.update(e,this.dom)||e.geometryChanged)&&(this.scale(),e.view.requestMeasure(this.measureReq))}setOrder(e){let t=0,n=e.facet(Ke);for(;t<n.length&&n[t]!=this.layer;)t++;this.dom.style.zIndex=String((this.layer.above?150:-1)-t)}measure(){return this.layer.markers(this.view)}scale(){let{scaleX:e,scaleY:t}=this.view;(e!=this.scaleX||t!=this.scaleY)&&(this.scaleX=e,this.scaleY=t,this.dom.style.transform=`scale(${1/e}, ${1/t})`)}draw(e){if(e.length!=this.drawn.length||e.some((t,n)=>!Hr(t,this.drawn[n]))){let t=this.dom.firstChild,n=0;for(let s of e)s.update&&t&&s.constructor&&this.drawn[n].constructor&&s.update(t,this.drawn[n])?(t=t.nextSibling,n++):this.dom.insertBefore(s.draw(),t);for(;t;){let s=t.nextSibling;t.remove(),t=s}this.drawn=e}}destroy(){this.layer.destroy&&this.layer.destroy(this.dom,this.view),this.dom.remove()}}const Ke=p.r$.define();function Te(r){return[vi.define(e=>new ds(e,r)),Ke.of(r)]}const Ce=!C.ios,We=p.r$.define({combine(r){return(0,p.BO)(r,{cursorBlinkRate:1200,drawRangeCursor:!0},{cursorBlinkRate:(e,t)=>Math.min(e,t),drawRangeCursor:(e,t)=>e||t})}});function At(r={}){return[We.of(r),Si,gr,yr,qi.of(!0)]}function It(r){return r.facet(We)}function ci(r){return r.startState.facet(We)!=r.state.facet(We)}const Si=Te({above:!0,markers(r){let{state:e}=r,t=e.facet(We),n=[];for(let s of e.selection.ranges){let c=s==e.selection.main;if(s.empty?!c||Ce:t.drawRangeCursor){let u=c?"cm-cursor cm-cursor-primary":"cm-cursor cm-cursor-secondary",y=s.empty?s:p.jT.cursor(s.head,s.head>s.anchor?-1:1);for(let b of js.forRange(r,u,y))n.push(b)}}return n},update(r,e){r.transactions.some(n=>n.selection)&&(e.style.animationName=e.style.animationName=="cm-blink"?"cm-blink2":"cm-blink");let t=ci(r);return t&&pn(r.state,e),r.docChanged||r.selectionSet||t},mount(r,e){pn(e.state,r)},class:"cm-cursorLayer"});function pn(r,e){e.style.animationDuration=r.facet(We).cursorBlinkRate+"ms"}const gr=Te({above:!1,markers(r){return r.state.selection.ranges.map(e=>e.empty?[]:js.forRange(r,"cm-selectionBackground",e)).reduce((e,t)=>e.concat(t))},update(r,e){return r.docChanged||r.selectionSet||r.viewportChanged||ci(r)},class:"cm-selectionLayer"}),Cs={".cm-line":{"& ::selection":{backgroundColor:"transparent !important"},"&::selection":{backgroundColor:"transparent !important"}}};Ce&&(Cs[".cm-line"].caretColor="transparent !important",Cs[".cm-content"]={caretColor:"transparent !important"});const yr=p.Wl.highest(Mt.theme(Cs)),So=p.Py.define({map(r,e){return r==null?null:e.mapPos(r)}}),vr=p.QQ.define({create(){return null},update(r,e){return r!=null&&(r=e.changes.mapPos(r)),e.effects.reduce((t,n)=>n.is(So)?n.value:t,r)}}),lr=vi.fromClass(class{constructor(r){this.view=r,this.cursor=null,this.measureReq={read:this.readPos.bind(this),write:this.drawCursor.bind(this)}}update(r){var e;let t=r.state.field(vr);t==null?this.cursor!=null&&((e=this.cursor)===null||e===void 0||e.remove(),this.cursor=null):(this.cursor||(this.cursor=this.view.scrollDOM.appendChild(document.createElement("div")),this.cursor.className="cm-dropCursor"),(r.startState.field(vr)!=t||r.docChanged||r.geometryChanged)&&this.view.requestMeasure(this.measureReq))}readPos(){let{view:r}=this,e=r.state.field(vr),t=e!=null&&r.coordsAtPos(e);if(!t)return null;let n=r.scrollDOM.getBoundingClientRect();return{left:t.left-n.left+r.scrollDOM.scrollLeft*r.scaleX,top:t.top-n.top+r.scrollDOM.scrollTop*r.scaleY,height:t.bottom-t.top}}drawCursor(r){if(this.cursor){let{scaleX:e,scaleY:t}=this.view;r?(this.cursor.style.left=r.left/e+"px",this.cursor.style.top=r.top/t+"px",this.cursor.style.height=r.height/t+"px"):this.cursor.style.left="-100000px"}}destroy(){this.cursor&&this.cursor.remove()}setDropPos(r){this.view.state.field(vr)!=r&&this.view.dispatch({effects:So.of(r)})}},{eventObservers:{dragover(r){this.setDropPos(this.view.posAtCoords({x:r.clientX,y:r.clientY}))},dragleave(r){(r.target==this.view.contentDOM||!this.view.contentDOM.contains(r.relatedTarget))&&this.setDropPos(null)},dragend(){this.setDropPos(null)},drop(){this.setDropPos(null)}}});function br(){return[vr,lr]}function ko(r,e,t,n,s){e.lastIndex=0;for(let c=r.iterRange(t,n),u=t,y;!c.next().done;u+=c.value.length)if(!c.lineBreak)for(;y=e.exec(c.value);)s(u+y.index,y)}function Ks(r,e){let t=r.visibleRanges;if(t.length==1&&t[0].from==r.viewport.from&&t[0].to==r.viewport.to)return t;let n=[];for(let{from:s,to:c}of t)s=Math.max(r.state.doc.lineAt(s).from,s-e),c=Math.min(r.state.doc.lineAt(c).to,c+e),n.length&&n[n.length-1].to>=s?n[n.length-1].to=c:n.push({from:s,to:c});return n}class xr{constructor(e){const{regexp:t,decoration:n,decorate:s,boundary:c,maxLength:u=1e3}=e;if(!t.global)throw new RangeError("The regular expression given to MatchDecorator should have its 'g' flag set");if(this.regexp=t,s)this.addMatch=(y,b,M,A)=>s(A,M,M+y[0].length,y,b);else if(typeof n=="function")this.addMatch=(y,b,M,A)=>{let F=n(y,b,M);F&&A(M,M+y[0].length,F)};else if(n)this.addMatch=(y,b,M,A)=>A(M,M+y[0].length,n);else throw new RangeError("Either 'decorate' or 'decoration' should be provided to MatchDecorator");this.boundary=c,this.maxLength=u}createDeco(e){let t=new p.f_,n=t.add.bind(t);for(let{from:s,to:c}of Ks(e,this.maxLength))ko(e.state.doc,this.regexp,s,c,(u,y)=>this.addMatch(y,e,u,n));return t.finish()}updateDeco(e,t){let n=1e9,s=-1;return e.docChanged&&e.changes.iterChanges((c,u,y,b)=>{b>e.view.viewport.from&&y<e.view.viewport.to&&(n=Math.min(y,n),s=Math.max(b,s))}),e.viewportChanged||s-n>1e3?this.createDeco(e.view):s>-1?this.updateRange(e.view,t.map(e.changes),n,s):t}updateRange(e,t,n,s){for(let c of e.visibleRanges){let u=Math.max(c.from,n),y=Math.min(c.to,s);if(y>u){let b=e.state.doc.lineAt(u),M=b.to<y?e.state.doc.lineAt(y):b,A=Math.max(c.from,b.from),F=Math.min(c.to,M.to);if(this.boundary){for(;u>b.from;u--)if(this.boundary.test(b.text[u-1-b.from])){A=u;break}for(;y<M.to;y++)if(this.boundary.test(M.text[y-M.from])){F=y;break}}let $=[],X,_=(le,se,de)=>$.push(de.range(le,se));if(b==M)for(this.regexp.lastIndex=A-b.from;(X=this.regexp.exec(b.text))&&X.index<F-b.from;)this.addMatch(X,e,X.index+b.from,_);else ko(e.state.doc,this.regexp,A,F,(le,se)=>this.addMatch(se,e,le,_));t=t.update({filterFrom:A,filterTo:F,filter:(le,se)=>le<A||se>F,add:$})}}return t}}const lo=/x/.unicode!=null?"gu":"g",Co=new RegExp(`[\0-\b
-\x7F-\x9F\xAD\u061C\u200B\u200E\u200F\u2028\u2029\u202D\u202E\u2066\u2067\u2069\uFEFF\uFFF9-\uFFFC]`,lo),Go={0:"null",7:"bell",8:"backspace",10:"newline",11:"vertical tab",13:"carriage return",27:"escape",8203:"zero width space",8204:"zero width non-joiner",8205:"zero width joiner",8206:"left-to-right mark",8207:"right-to-left mark",8232:"line separator",8237:"left-to-right override",8238:"right-to-left override",8294:"left-to-right isolate",8295:"right-to-left isolate",8297:"pop directional isolate",8233:"paragraph separator",65279:"zero width no-break space",65532:"object replacement"};let ao=null;function Xo(){var r;if(ao==null&&typeof document!="undefined"&&document.body){let e=document.body.style;ao=((r=e.tabSize)!==null&&r!==void 0?r:e.MozTabSize)!=null}return ao||!1}const ho=p.r$.define({combine(r){let e=(0,p.BO)(r,{render:null,specialChars:Co,addSpecialChars:null});return(e.replaceTabs=!Xo())&&(e.specialChars=new RegExp("	|"+e.specialChars.source,lo)),e.addSpecialChars&&(e.specialChars=new RegExp(e.specialChars.source+"|"+e.addSpecialChars.source,lo)),e}});function xl(r={}){return[ho.of(r),To()]}let Ao=null;function To(){return Ao||(Ao=vi.fromClass(class{constructor(r){this.view=r,this.decorations=Ye.none,this.decorationCache=Object.create(null),this.decorator=this.makeDecorator(r.state.facet(ho)),this.decorations=this.decorator.createDeco(r)}makeDecorator(r){return new xr({regexp:r.specialChars,decoration:(e,t,n)=>{let{doc:s}=t.state,c=(0,p.gm)(e[0],0);if(c==9){let u=s.lineAt(n),y=t.state.tabSize,b=(0,p.IS)(u.text,y,n-u.from);return Ye.replace({widget:new Qo((y-b%y)*this.view.defaultCharacterWidth/this.view.scaleX)})}return this.decorationCache[c]||(this.decorationCache[c]=Ye.replace({widget:new qo(r,c)}))},boundary:r.replaceTabs?void 0:/[^]/})}update(r){let e=r.state.facet(ho);r.startState.facet(ho)!=e?(this.decorator=this.makeDecorator(e),this.decorations=this.decorator.createDeco(r.view)):this.decorations=this.decorator.updateDeco(r,this.decorations)}},{decorations:r=>r.decorations}))}const Yo="\u2022";function wl(r){return r>=32?Yo:r==10?"\u2424":String.fromCharCode(9216+r)}class qo extends xi{constructor(e,t){super(),this.options=e,this.code=t}eq(e){return e.code==this.code}toDOM(e){let t=wl(this.code),n=e.state.phrase("Control character")+" "+(Go[this.code]||"0x"+this.code.toString(16)),s=this.options.render&&this.options.render(this.code,n,t);if(s)return s;let c=document.createElement("span");return c.textContent=t,c.title=n,c.setAttribute("aria-label",n),c.className="cm-specialChar",c}ignoreEvent(){return!1}}class Qo extends xi{constructor(e){super(),this.width=e}eq(e){return e.width==this.width}toDOM(){let e=document.createElement("span");return e.textContent="	",e.className="cm-tab",e.style.width=this.width+"px",e}ignoreEvent(){return!1}}const co=null;function _o(){return[co,ns.of(r=>{var e;return((e=r.plugin(co))===null||e===void 0?void 0:e.attrs)||null})]}function el(){return Eo}const Mo=Ye.line({class:"cm-activeLine"}),Eo=vi.fromClass(class{constructor(r){this.decorations=this.getDeco(r)}update(r){(r.docChanged||r.selectionSet)&&(this.decorations=this.getDeco(r.view))}getDeco(r){let e=-1,t=[];for(let n of r.state.selection.ranges){let s=r.lineBlockAt(n.head);s.from>e&&(t.push(Mo.range(s.from)),e=s.from)}return Ye.set(t)}},{decorations:r=>r.decorations});class Sl extends xi{constructor(e){super(),this.content=e}toDOM(){let e=document.createElement("span");return e.className="cm-placeholder",e.style.pointerEvents="none",e.appendChild(typeof this.content=="string"?document.createTextNode(this.content):this.content),typeof this.content=="string"?e.setAttribute("aria-label","placeholder "+this.content):e.setAttribute("aria-hidden","true"),e}coordsAt(e){let t=e.firstChild?mt(e.firstChild):[];if(!t.length)return null;let n=window.getComputedStyle(e.parentNode),s=Kt(t[0],n.direction!="rtl"),c=parseInt(n.lineHeight);return s.bottom-s.top>c*1.5?{left:s.left,right:s.right,top:s.top,bottom:s.top+c}:s}ignoreEvent(){return!1}}function wr(r){return vi.fromClass(class{constructor(e){this.view=e,this.placeholder=r?Ye.set([Ye.widget({widget:new Sl(r),side:1}).range(0)]):Ye.none}get decorations(){return this.view.state.doc.length?Ye.none:this.placeholder}},{decorations:e=>e.decorations})}const ps=2e3;function fo(r,e,t){let n=Math.min(e.line,t.line),s=Math.max(e.line,t.line),c=[];if(e.off>ps||t.off>ps||e.col<0||t.col<0){let u=Math.min(e.off,t.off),y=Math.max(e.off,t.off);for(let b=n;b<=s;b++){let M=r.doc.line(b);M.length<=y&&c.push(p.jT.range(M.from+u,M.to+y))}}else{let u=Math.min(e.col,t.col),y=Math.max(e.col,t.col);for(let b=n;b<=s;b++){let M=r.doc.line(b),A=(0,p.Gz)(M.text,u,r.tabSize,!0);if(A<0)c.push(p.jT.cursor(M.to));else{let F=(0,p.Gz)(M.text,y,r.tabSize);c.push(p.jT.range(M.from+A,M.from+F))}}}return c}function Do(r,e){let t=r.coordsAtPos(r.viewport.from);return t?Math.round(Math.abs((t.left-e)/r.defaultCharacterWidth)):-1}function Oo(r,e){let t=r.posAtCoords({x:e.clientX,y:e.clientY},!1),n=r.state.doc.lineAt(t),s=t-n.from,c=s>ps?-1:s==n.length?Do(r,e.clientX):(0,p.IS)(n.text,r.state.tabSize,t-n.from);return{line:n.number,col:c,off:s}}function uo(r,e){let t=Oo(r,e),n=r.state.selection;return t?{update(s){if(s.docChanged){let c=s.changes.mapPos(s.startState.doc.line(t.line).from),u=s.state.doc.lineAt(c);t={line:u.number,col:t.col,off:Math.min(t.off,u.length)},n=n.map(s.changes)}},get(s,c,u){let y=Oo(r,s);if(!y)return n;let b=fo(r.state,t,y);return b.length?u?p.jT.create(b.concat(n.ranges)):p.jT.create(b):n}}:null}function Po(r){let e=(r==null?void 0:r.eventFilter)||(t=>t.altKey&&t.button==0);return Mt.mouseSelectionStyle.of((t,n)=>e(n)?uo(t,n):null)}const Ro={Alt:[18,r=>!!r.altKey],Control:[17,r=>!!r.ctrlKey],Shift:[16,r=>!!r.shiftKey],Meta:[91,r=>!!r.metaKey]},tl={style:"cursor: crosshair"};function il(r={}){let[e,t]=Ro[r.key||"Alt"],n=vi.fromClass(class{constructor(s){this.view=s,this.isDown=!1}set(s){this.isDown!=s&&(this.isDown=s,this.view.update([]))}},{eventObservers:{keydown(s){this.set(s.keyCode==e||t(s))},keyup(s){(s.keyCode==e||!t(s))&&this.set(!1)},mousemove(s){this.set(t(s))}}});return[n,Mt.contentAttributes.of(s=>{var c;return!((c=s.plugin(n))===null||c===void 0)&&c.isDown?tl:null})]}const Vr="-10000px";class Bo{constructor(e,t,n){this.facet=t,this.createTooltipView=n,this.input=e.state.facet(t),this.tooltips=this.input.filter(s=>s),this.tooltipViews=this.tooltips.map(n)}update(e,t){var n;let s=e.state.facet(this.facet),c=s.filter(b=>b);if(s===this.input){for(let b of this.tooltipViews)b.update&&b.update(e);return!1}let u=[],y=t?[]:null;for(let b=0;b<c.length;b++){let M=c[b],A=-1;if(M){for(let F=0;F<this.tooltips.length;F++){let $=this.tooltips[F];$&&$.create==M.create&&(A=F)}if(A<0)u[b]=this.createTooltipView(M),y&&(y[b]=!!M.above);else{let F=u[b]=this.tooltipViews[A];y&&(y[b]=t[A]),F.update&&F.update(e)}}}for(let b of this.tooltipViews)u.indexOf(b)<0&&(b.dom.remove(),(n=b.destroy)===null||n===void 0||n.call(b));return t&&(y.forEach((b,M)=>t[M]=b),t.length=y.length),this.input=s,this.tooltips=c,this.tooltipViews=u,!0}}function kl(r={}){return Js.of(r)}function Lo(r){let{win:e}=r;return{top:0,left:0,bottom:e.innerHeight,right:e.innerWidth}}const Js=p.r$.define({combine:r=>{var e,t,n;return{position:C.ios?"absolute":((e=r.find(s=>s.position))===null||e===void 0?void 0:e.position)||"fixed",parent:((t=r.find(s=>s.parent))===null||t===void 0?void 0:t.parent)||null,tooltipSpace:((n=r.find(s=>s.tooltipSpace))===null||n===void 0?void 0:n.tooltipSpace)||Lo}}}),Io=new WeakMap,zr=vi.fromClass(class{constructor(r){this.view=r,this.above=[],this.inView=!0,this.madeAbsolute=!1,this.lastTransaction=0,this.measureTimeout=-1;let e=r.state.facet(Js);this.position=e.position,this.parent=e.parent,this.classes=r.themeClasses,this.createContainer(),this.measureReq={read:this.readMeasure.bind(this),write:this.writeMeasure.bind(this),key:this},this.manager=new Bo(r,$r,t=>this.createTooltip(t)),this.intersectionObserver=typeof IntersectionObserver=="function"?new IntersectionObserver(t=>{Date.now()>this.lastTransaction-50&&t.length>0&&t[t.length-1].intersectionRatio<1&&this.measureSoon()},{threshold:[1]}):null,this.observeIntersection(),r.win.addEventListener("resize",this.measureSoon=this.measureSoon.bind(this)),this.maybeMeasure()}createContainer(){this.parent?(this.container=document.createElement("div"),this.container.style.position="relative",this.container.className=this.view.themeClasses,this.parent.appendChild(this.container)):this.container=this.view.dom}observeIntersection(){if(this.intersectionObserver){this.intersectionObserver.disconnect();for(let r of this.manager.tooltipViews)this.intersectionObserver.observe(r.dom)}}measureSoon(){this.measureTimeout<0&&(this.measureTimeout=setTimeout(()=>{this.measureTimeout=-1,this.maybeMeasure()},50))}update(r){r.transactions.length&&(this.lastTransaction=Date.now());let e=this.manager.update(r,this.above);e&&this.observeIntersection();let t=e||r.geometryChanged,n=r.state.facet(Js);if(n.position!=this.position&&!this.madeAbsolute){this.position=n.position;for(let s of this.manager.tooltipViews)s.dom.style.position=this.position;t=!0}if(n.parent!=this.parent){this.parent&&this.container.remove(),this.parent=n.parent,this.createContainer();for(let s of this.manager.tooltipViews)this.container.appendChild(s.dom);t=!0}else this.parent&&this.view.themeClasses!=this.classes&&(this.classes=this.container.className=this.view.themeClasses);t&&this.maybeMeasure()}createTooltip(r){let e=r.create(this.view);if(e.dom.classList.add("cm-tooltip"),r.arrow&&!e.dom.querySelector(".cm-tooltip > .cm-tooltip-arrow")){let t=document.createElement("div");t.className="cm-tooltip-arrow",e.dom.appendChild(t)}return e.dom.style.position=this.position,e.dom.style.top=Vr,e.dom.style.left="0px",this.container.appendChild(e.dom),e.mount&&e.mount(this.view),e}destroy(){var r,e;this.view.win.removeEventListener("resize",this.measureSoon);for(let t of this.manager.tooltipViews)t.dom.remove(),(r=t.destroy)===null||r===void 0||r.call(t);this.parent&&this.container.remove(),(e=this.intersectionObserver)===null||e===void 0||e.disconnect(),clearTimeout(this.measureTimeout)}readMeasure(){let r=this.view.dom.getBoundingClientRect(),e=1,t=1,n=!1;if(this.position=="fixed"&&this.manager.tooltipViews.length){let{dom:s}=this.manager.tooltipViews[0];if(C.gecko)n=s.offsetParent!=this.container.ownerDocument.body;else if(s.style.top==Vr&&s.style.left=="0px"){let c=s.getBoundingClientRect();n=Math.abs(c.top+1e4)>1||Math.abs(c.left)>1}}if(n||this.position=="absolute")if(this.parent){let s=this.parent.getBoundingClientRect();s.width&&s.height&&(e=s.width/this.parent.offsetWidth,t=s.height/this.parent.offsetHeight)}else({scaleX:e,scaleY:t}=this.view.viewState);return{editor:r,parent:this.parent?this.container.getBoundingClientRect():r,pos:this.manager.tooltips.map((s,c)=>{let u=this.manager.tooltipViews[c];return u.getCoords?u.getCoords(s.pos):this.view.coordsAtPos(s.pos)}),size:this.manager.tooltipViews.map(({dom:s})=>s.getBoundingClientRect()),space:this.view.state.facet(Js).tooltipSpace(this.view),scaleX:e,scaleY:t,makeAbsolute:n}}writeMeasure(r){var e;if(r.makeAbsolute){this.madeAbsolute=!0,this.position="absolute";for(let y of this.manager.tooltipViews)y.dom.style.position="absolute"}let{editor:t,space:n,scaleX:s,scaleY:c}=r,u=[];for(let y=0;y<this.manager.tooltips.length;y++){let b=this.manager.tooltips[y],M=this.manager.tooltipViews[y],{dom:A}=M,F=r.pos[y],$=r.size[y];if(!F||F.bottom<=Math.max(t.top,n.top)||F.top>=Math.min(t.bottom,n.bottom)||F.right<Math.max(t.left,n.left)-.1||F.left>Math.min(t.right,n.right)+.1){A.style.top=Vr;continue}let X=b.arrow?M.dom.querySelector(".cm-tooltip-arrow"):null,_=X?7:0,le=$.right-$.left,se=(e=Io.get(M))!==null&&e!==void 0?e:$.bottom-$.top,de=M.offset||sl,Je=this.view.textDirection==j.LTR,ht=$.width>n.right-n.left?Je?n.left:n.right-$.width:Je?Math.min(F.left-(X?14:0)+de.x,n.right-le):Math.max(n.left,F.left-le+(X?14:0)-de.x),Ue=this.above[y];!b.strictSide&&(Ue?F.top-($.bottom-$.top)-de.y<n.top:F.bottom+($.bottom-$.top)+de.y>n.bottom)&&Ue==n.bottom-F.bottom>F.top-n.top&&(Ue=this.above[y]=!Ue);let at=(Ue?F.top-n.top:n.bottom-F.bottom)-_;if(at<se&&M.resize!==!1){if(at<this.view.defaultLineHeight){A.style.top=Vr;continue}Io.set(M,se),A.style.height=(se=at)/c+"px"}else A.style.height&&(A.style.height="");let kt=Ue?F.top-se-_-de.y:F.bottom+_+de.y,Vi=ht+le;if(M.overlap!==!0)for(let sn of u)sn.left<Vi&&sn.right>ht&&sn.top<kt+se&&sn.bottom>kt&&(kt=Ue?sn.top-se-2-_:sn.bottom+_+2);if(this.position=="absolute"?(A.style.top=(kt-r.parent.top)/c+"px",A.style.left=(ht-r.parent.left)/s+"px"):(A.style.top=kt/c+"px",A.style.left=ht/s+"px"),X){let sn=F.left+(Je?de.x:-de.x)-(ht+14-7);X.style.left=sn/s+"px"}M.overlap!==!0&&u.push({left:ht,top:kt,right:Vi,bottom:kt+se}),A.classList.toggle("cm-tooltip-above",Ue),A.classList.toggle("cm-tooltip-below",!Ue),M.positioned&&M.positioned(r.space)}}maybeMeasure(){if(this.manager.tooltips.length&&(this.view.inView&&this.view.requestMeasure(this.measureReq),this.inView!=this.view.inView&&(this.inView=this.view.inView,!this.inView)))for(let r of this.manager.tooltipViews)r.dom.style.top=Vr}},{eventObservers:{scroll(){this.maybeMeasure()}}}),nl=Mt.baseTheme({".cm-tooltip":{zIndex:100,boxSizing:"border-box"},"&light .cm-tooltip":{border:"1px solid #bbb",backgroundColor:"#f5f5f5"},"&light .cm-tooltip-section:not(:first-child)":{borderTop:"1px solid #bbb"},"&dark .cm-tooltip":{backgroundColor:"#333338",color:"white"},".cm-tooltip-arrow":{height:`${7}px`,width:`${7*2}px`,position:"absolute",zIndex:-1,overflow:"hidden","&:before, &:after":{content:"''",position:"absolute",width:0,height:0,borderLeft:`${7}px solid transparent`,borderRight:`${7}px solid transparent`},".cm-tooltip-above &":{bottom:`-${7}px`,"&:before":{borderTop:`${7}px solid #bbb`},"&:after":{borderTop:`${7}px solid #f5f5f5`,bottom:"1px"}},".cm-tooltip-below &":{top:`-${7}px`,"&:before":{borderBottom:`${7}px solid #bbb`},"&:after":{borderBottom:`${7}px solid #f5f5f5`,top:"1px"}}},"&dark .cm-tooltip .cm-tooltip-arrow":{"&:before":{borderTopColor:"#333338",borderBottomColor:"#333338"},"&:after":{borderTopColor:"transparent",borderBottomColor:"transparent"}}}),sl={x:0,y:0},$r=p.r$.define({enables:[zr,nl]}),Sr=p.r$.define();class kr{static create(e){return new kr(e)}constructor(e){this.view=e,this.mounted=!1,this.dom=document.createElement("div"),this.dom.classList.add("cm-tooltip-hover"),this.manager=new Bo(e,Sr,t=>this.createHostedView(t))}createHostedView(e){let t=e.create(this.view);return t.dom.classList.add("cm-tooltip-section"),this.dom.appendChild(t.dom),this.mounted&&t.mount&&t.mount(this.view),t}mount(e){for(let t of this.manager.tooltipViews)t.mount&&t.mount(e);this.mounted=!0}positioned(e){for(let t of this.manager.tooltipViews)t.positioned&&t.positioned(e)}update(e){this.manager.update(e)}destroy(){var e;for(let t of this.manager.tooltipViews)(e=t.destroy)===null||e===void 0||e.call(t)}passProp(e){let t;for(let n of this.manager.tooltipViews){let s=n[e];if(s!==void 0){if(t===void 0)t=s;else if(t!==s)return}}return t}get offset(){return this.passProp("offset")}get getCoords(){return this.passProp("getCoords")}get overlap(){return this.passProp("overlap")}get resize(){return this.passProp("resize")}}const rl=$r.compute([Sr],r=>{let e=r.facet(Sr).filter(t=>t);return e.length===0?null:{pos:Math.min(...e.map(t=>t.pos)),end:Math.max(...e.map(t=>{var n;return(n=t.end)!==null&&n!==void 0?n:t.pos})),create:kr.create,above:e[0].above,arrow:e.some(t=>t.arrow)}});class No{constructor(e,t,n,s,c){this.view=e,this.source=t,this.field=n,this.setHover=s,this.hoverTime=c,this.hoverTimeout=-1,this.restartTimeout=-1,this.pending=null,this.lastMove={x:0,y:0,target:e.dom,time:0},this.checkHover=this.checkHover.bind(this),e.dom.addEventListener("mouseleave",this.mouseleave=this.mouseleave.bind(this)),e.dom.addEventListener("mousemove",this.mousemove=this.mousemove.bind(this))}update(){this.pending&&(this.pending=null,clearTimeout(this.restartTimeout),this.restartTimeout=setTimeout(()=>this.startHover(),20))}get active(){return this.view.state.field(this.field)}checkHover(){if(this.hoverTimeout=-1,this.active)return;let e=Date.now()-this.lastMove.time;e<this.hoverTime?this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime-e):this.startHover()}startHover(){clearTimeout(this.restartTimeout);let{view:e,lastMove:t}=this,n=e.docView.nearest(t.target);if(!n)return;let s,c=1;if(n instanceof re)s=n.posAtStart;else{if(s=e.posAtCoords(t),s==null)return;let y=e.coordsAtPos(s);if(!y||t.y<y.top||t.y>y.bottom||t.x<y.left-e.defaultCharacterWidth||t.x>y.right+e.defaultCharacterWidth)return;let b=e.bidiSpans(e.state.doc.lineAt(s)).find(A=>A.from<=s&&A.to>=s),M=b&&b.dir==j.RTL?-1:1;c=t.x<y.left?-M:M}let u=this.source(e,s,c);if(u!=null&&u.then){let y=this.pending={pos:s};u.then(b=>{this.pending==y&&(this.pending=null,b&&e.dispatch({effects:this.setHover.of(b)}))},b=>ri(e.state,b,"hover tooltip"))}else u&&e.dispatch({effects:this.setHover.of(u)})}get tooltip(){let e=this.view.plugin(zr),t=e?e.manager.tooltips.findIndex(n=>n.create==kr.create):-1;return t>-1?e.manager.tooltipViews[t]:null}mousemove(e){var t;this.lastMove={x:e.clientX,y:e.clientY,target:e.target,time:Date.now()},this.hoverTimeout<0&&(this.hoverTimeout=setTimeout(this.checkHover,this.hoverTime));let{active:n,tooltip:s}=this;if(n&&s&&!Cl(s.dom,e)||this.pending){let{pos:c}=n||this.pending,u=(t=n==null?void 0:n.end)!==null&&t!==void 0?t:c;(c==u?this.view.posAtCoords(this.lastMove)!=c:!Fo(this.view,c,u,e.clientX,e.clientY))&&(this.view.dispatch({effects:this.setHover.of(null)}),this.pending=null)}}mouseleave(e){clearTimeout(this.hoverTimeout),this.hoverTimeout=-1;let{active:t}=this;if(t){let{tooltip:n}=this;n&&n.dom.contains(e.relatedTarget)?this.watchTooltipLeave(n.dom):this.view.dispatch({effects:this.setHover.of(null)})}}watchTooltipLeave(e){let t=n=>{e.removeEventListener("mouseleave",t),this.active&&!this.view.dom.contains(n.relatedTarget)&&this.view.dispatch({effects:this.setHover.of(null)})};e.addEventListener("mouseleave",t)}destroy(){clearTimeout(this.hoverTimeout),this.view.dom.removeEventListener("mouseleave",this.mouseleave),this.view.dom.removeEventListener("mousemove",this.mousemove)}}const jr=4;function Cl(r,e){let t=r.getBoundingClientRect();return e.clientX>=t.left-jr&&e.clientX<=t.right+jr&&e.clientY>=t.top-jr&&e.clientY<=t.bottom+jr}function Fo(r,e,t,n,s,c){let u=r.scrollDOM.getBoundingClientRect(),y=r.documentTop+r.documentPadding.top+r.contentHeight;if(u.left>n||u.right<n||u.top>s||Math.min(u.bottom,y)<s)return!1;let b=r.posAtCoords({x:n,y:s},!1);return b>=e&&b<=t}function Al(r,e={}){let t=p.Py.define(),n=p.QQ.define({create(){return null},update(s,c){if(s&&(e.hideOnChange&&(c.docChanged||c.selection)||e.hideOn&&e.hideOn(c,s)))return null;if(s&&c.docChanged){let u=c.changes.mapPos(s.pos,-1,p.gc.TrackDel);if(u==null)return null;let y=Object.assign(Object.create(null),s);y.pos=u,s.end!=null&&(y.end=c.changes.mapPos(s.end)),s=y}for(let u of c.effects)u.is(t)&&(s=u.value),u.is(Ml)&&(s=null);return s},provide:s=>Sr.from(s)});return[n,vi.define(s=>new No(s,r,n,t,e.hoverTime||300)),rl]}function Tl(r,e){let t=r.plugin(zr);if(!t)return null;let n=t.manager.tooltips.indexOf(e);return n<0?null:t.manager.tooltipViews[n]}function Pl(r){return r.facet(Sr).some(e=>e)}const Ml=p.Py.define(),El=null;function ar(r){let e=r.plugin(zr);e&&e.maybeMeasure()}const As=p.r$.define({combine(r){let e,t;for(let n of r)e=e||n.topContainer,t=t||n.bottomContainer;return{topContainer:e,bottomContainer:t}}});function ol(r){return r?[As.of(r)]:[]}function Wo(r,e){let t=r.plugin(ll),n=t?t.specs.indexOf(e):-1;return n>-1?t.panels[n]:null}const ll=vi.fromClass(class{constructor(r){this.input=r.state.facet(Kr),this.specs=this.input.filter(t=>t),this.panels=this.specs.map(t=>t(r));let e=r.state.facet(As);this.top=new Us(r,!0,e.topContainer),this.bottom=new Us(r,!1,e.bottomContainer),this.top.sync(this.panels.filter(t=>t.top)),this.bottom.sync(this.panels.filter(t=>!t.top));for(let t of this.panels)t.dom.classList.add("cm-panel"),t.mount&&t.mount()}update(r){let e=r.state.facet(As);this.top.container!=e.topContainer&&(this.top.sync([]),this.top=new Us(r.view,!0,e.topContainer)),this.bottom.container!=e.bottomContainer&&(this.bottom.sync([]),this.bottom=new Us(r.view,!1,e.bottomContainer)),this.top.syncClasses(),this.bottom.syncClasses();let t=r.state.facet(Kr);if(t!=this.input){let n=t.filter(b=>b),s=[],c=[],u=[],y=[];for(let b of n){let M=this.specs.indexOf(b),A;M<0?(A=b(r.view),y.push(A)):(A=this.panels[M],A.update&&A.update(r)),s.push(A),(A.top?c:u).push(A)}this.specs=n,this.panels=s,this.top.sync(c),this.bottom.sync(u);for(let b of y)b.dom.classList.add("cm-panel"),b.mount&&b.mount()}else for(let n of this.panels)n.update&&n.update(r)}destroy(){this.top.sync([]),this.bottom.sync([])}},{provide:r=>Mt.scrollMargins.of(e=>{let t=e.plugin(r);return t&&{top:t.top.scrollMargin(),bottom:t.bottom.scrollMargin()}})});class Us{constructor(e,t,n){this.view=e,this.top=t,this.container=n,this.dom=void 0,this.classes="",this.panels=[],this.syncClasses()}sync(e){for(let t of this.panels)t.destroy&&e.indexOf(t)<0&&t.destroy();this.panels=e,this.syncDOM()}syncDOM(){if(this.panels.length==0){this.dom&&(this.dom.remove(),this.dom=void 0);return}if(!this.dom){this.dom=document.createElement("div"),this.dom.className=this.top?"cm-panels cm-panels-top":"cm-panels cm-panels-bottom",this.dom.style[this.top?"top":"bottom"]="0";let t=this.container||this.view.dom;t.insertBefore(this.dom,this.top?t.firstChild:null)}let e=this.dom.firstChild;for(let t of this.panels)if(t.dom.parentNode==this.dom){for(;e!=t.dom;)e=Zr(e);e=e.nextSibling}else this.dom.insertBefore(t.dom,e);for(;e;)e=Zr(e)}scrollMargin(){return!this.dom||this.container?0:Math.max(0,this.top?this.dom.getBoundingClientRect().bottom-Math.max(0,this.view.scrollDOM.getBoundingClientRect().top):Math.min(innerHeight,this.view.scrollDOM.getBoundingClientRect().bottom)-this.dom.getBoundingClientRect().top)}syncClasses(){if(!(!this.container||this.classes==this.view.themeClasses)){for(let e of this.classes.split(" "))e&&this.container.classList.remove(e);for(let e of(this.classes=this.view.themeClasses).split(" "))e&&this.container.classList.add(e)}}}function Zr(r){let e=r.nextSibling;return r.remove(),e}const Kr=p.r$.define({enables:ll});class ki extends p.uU{compare(e){return this==e||this.constructor==e.constructor&&this.eq(e)}eq(e){return!1}destroy(e){}}ki.prototype.elementClass="",ki.prototype.toDOM=void 0,ki.prototype.mapMode=p.gc.TrackBefore,ki.prototype.startSide=ki.prototype.endSide=-1,ki.prototype.point=!0;const po=p.r$.define(),al={class:"",renderEmptyElements:!1,elementStyle:"",markers:()=>p.Xs.empty,lineMarker:()=>null,widgetMarker:()=>null,lineMarkerChange:null,initialSpacer:null,updateSpacer:null,domEventHandlers:{}},Cr=p.r$.define();function Ho(r){return[go(),Cr.of(Object.assign(Object.assign({},al),r))]}const mo=p.r$.define({combine:r=>r.some(e=>e)});function go(r){let e=[hl];return r&&r.fixed===!1&&e.push(mo.of(!0)),e}const hl=vi.fromClass(class{constructor(r){this.view=r,this.prevViewport=r.viewport,this.dom=document.createElement("div"),this.dom.className="cm-gutters",this.dom.setAttribute("aria-hidden","true"),this.dom.style.minHeight=this.view.contentHeight/this.view.scaleY+"px",this.gutters=r.state.facet(Cr).map(e=>new Jr(r,e));for(let e of this.gutters)this.dom.appendChild(e.dom);this.fixed=!r.state.facet(mo),this.fixed&&(this.dom.style.position="sticky"),this.syncGutters(!1),r.scrollDOM.insertBefore(this.dom,r.contentDOM)}update(r){if(this.updateGutters(r)){let e=this.prevViewport,t=r.view.viewport,n=Math.min(e.to,t.to)-Math.max(e.from,t.from);this.syncGutters(n<(t.to-t.from)*.8)}r.geometryChanged&&(this.dom.style.minHeight=this.view.contentHeight+"px"),this.view.state.facet(mo)!=!this.fixed&&(this.fixed=!this.fixed,this.dom.style.position=this.fixed?"sticky":""),this.prevViewport=r.view.viewport}syncGutters(r){let e=this.dom.nextSibling;r&&this.dom.remove();let t=p.Xs.iter(this.view.state.facet(po),this.view.viewport.from),n=[],s=this.gutters.map(c=>new Vo(c,this.view.viewport,-this.view.documentPadding.top));for(let c of this.view.viewportLineBlocks)if(n.length&&(n=[]),Array.isArray(c.type)){let u=!0;for(let y of c.type)if(y.type==st.Text&&u){yo(t,n,y.from);for(let b of s)b.line(this.view,y,n);u=!1}else if(y.widget)for(let b of s)b.widget(this.view,y)}else if(c.type==st.Text){yo(t,n,c.from);for(let u of s)u.line(this.view,c,n)}else if(c.widget)for(let u of s)u.widget(this.view,c);for(let c of s)c.finish();r&&this.view.scrollDOM.insertBefore(this.dom,e)}updateGutters(r){let e=r.startState.facet(Cr),t=r.state.facet(Cr),n=r.docChanged||r.heightChanged||r.viewportChanged||!p.Xs.eq(r.startState.facet(po),r.state.facet(po),r.view.viewport.from,r.view.viewport.to);if(e==t)for(let s of this.gutters)s.update(r)&&(n=!0);else{n=!0;let s=[];for(let c of t){let u=e.indexOf(c);u<0?s.push(new Jr(this.view,c)):(this.gutters[u].update(r),s.push(this.gutters[u]))}for(let c of this.gutters)c.dom.remove(),s.indexOf(c)<0&&c.destroy();for(let c of s)this.dom.appendChild(c.dom);this.gutters=s}return n}destroy(){for(let r of this.gutters)r.destroy();this.dom.remove()}},{provide:r=>Mt.scrollMargins.of(e=>{let t=e.plugin(r);return!t||t.gutters.length==0||!t.fixed?null:e.textDirection==j.LTR?{left:t.dom.offsetWidth*e.scaleX}:{right:t.dom.offsetWidth*e.scaleX}})});function cl(r){return Array.isArray(r)?r:[r]}function yo(r,e,t){for(;r.value&&r.from<=t;)r.from==t&&e.push(r.value),r.next()}class Vo{constructor(e,t,n){this.gutter=e,this.height=n,this.i=0,this.cursor=p.Xs.iter(e.markers,t.from)}addElement(e,t,n){let{gutter:s}=this,c=(t.top-this.height)/e.scaleY,u=t.height/e.scaleY;if(this.i==s.elements.length){let y=new fl(e,u,c,n);s.elements.push(y),s.dom.appendChild(y.dom)}else s.elements[this.i].update(e,u,c,n);this.height=t.bottom,this.i++}line(e,t,n){let s=[];yo(this.cursor,s,t.from),n.length&&(s=s.concat(n));let c=this.gutter.config.lineMarker(e,t,s);c&&s.unshift(c);let u=this.gutter;s.length==0&&!u.config.renderEmptyElements||this.addElement(e,t,s)}widget(e,t){let n=this.gutter.config.widgetMarker(e,t.widget,t);n&&this.addElement(e,t,[n])}finish(){let e=this.gutter;for(;e.elements.length>this.i;){let t=e.elements.pop();e.dom.removeChild(t.dom),t.destroy()}}}class Jr{constructor(e,t){this.view=e,this.config=t,this.elements=[],this.spacer=null,this.dom=document.createElement("div"),this.dom.className="cm-gutter"+(this.config.class?" "+this.config.class:"");for(let n in t.domEventHandlers)this.dom.addEventListener(n,s=>{let c=s.target,u;if(c!=this.dom&&this.dom.contains(c)){for(;c.parentNode!=this.dom;)c=c.parentNode;let b=c.getBoundingClientRect();u=(b.top+b.bottom)/2}else u=s.clientY;let y=e.lineBlockAtHeight(u-e.documentTop);t.domEventHandlers[n](e,y,s)&&s.preventDefault()});this.markers=cl(t.markers(e)),t.initialSpacer&&(this.spacer=new fl(e,0,0,[t.initialSpacer(e)]),this.dom.appendChild(this.spacer.dom),this.spacer.dom.style.cssText+="visibility: hidden; pointer-events: none")}update(e){let t=this.markers;if(this.markers=cl(this.config.markers(e.view)),this.spacer&&this.config.updateSpacer){let s=this.config.updateSpacer(this.spacer.markers[0],e);s!=this.spacer.markers[0]&&this.spacer.update(e.view,0,0,[s])}let n=e.view.viewport;return!p.Xs.eq(this.markers,t,n.from,n.to)||(this.config.lineMarkerChange?this.config.lineMarkerChange(e):!1)}destroy(){for(let e of this.elements)e.destroy()}}class fl{constructor(e,t,n,s){this.height=-1,this.above=0,this.markers=[],this.dom=document.createElement("div"),this.dom.className="cm-gutterElement",this.update(e,t,n,s)}update(e,t,n,s){this.height!=t&&(this.height=t,this.dom.style.height=t+"px"),this.above!=n&&(this.dom.style.marginTop=(this.above=n)?n+"px":""),Dl(this.markers,s)||this.setMarkers(e,s)}setMarkers(e,t){let n="cm-gutterElement",s=this.dom.firstChild;for(let c=0,u=0;;){let y=u,b=c<t.length?t[c++]:null,M=!1;if(b){let A=b.elementClass;A&&(n+=" "+A);for(let F=u;F<this.markers.length;F++)if(this.markers[F].compare(b)){y=F,M=!0;break}}else y=this.markers.length;for(;u<y;){let A=this.markers[u++];if(A.toDOM){A.destroy(s);let F=s.nextSibling;s.remove(),s=F}}if(!b)break;b.toDOM&&(M?s=s.nextSibling:this.dom.insertBefore(b.toDOM(e),s)),M&&u++}this.dom.className=n,this.markers=t}destroy(){this.setMarkers(null,[])}}function Dl(r,e){if(r.length!=e.length)return!1;for(let t=0;t<r.length;t++)if(!r[t].compare(e[t]))return!1;return!0}const zo=p.r$.define(),Gs=p.r$.define({combine(r){return(0,p.BO)(r,{formatNumber:String,domEventHandlers:{}},{domEventHandlers(e,t){let n=Object.assign({},e);for(let s in t){let c=n[s],u=t[s];n[s]=c?(y,b,M)=>c(y,b,M)||u(y,b,M):u}return n}})}});class vo extends ki{constructor(e){super(),this.number=e}eq(e){return this.number==e.number}toDOM(){return document.createTextNode(this.number)}}function Ur(r,e){return r.state.facet(Gs).formatNumber(e,r.state)}const Gr=Cr.compute([Gs],r=>({class:"cm-lineNumbers",renderEmptyElements:!1,markers(e){return e.state.facet(zo)},lineMarker(e,t,n){return n.some(s=>s.toDOM)?null:new vo(Ur(e,e.state.doc.lineAt(t.from).number))},widgetMarker:()=>null,lineMarkerChange:e=>e.startState.facet(Gs)!=e.state.facet(Gs),initialSpacer(e){return new vo(Ur(e,Ar(e.state.doc.lines)))},updateSpacer(e,t){let n=Ur(t.view,Ar(t.view.state.doc.lines));return n==e.number?e:new vo(n)},domEventHandlers:r.facet(Gs).domEventHandlers}));function Xr(r={}){return[Gs.of(r),go(),Gr]}function Ar(r){let e=9;for(;e<r;)e=e*10+9;return e}const ul=new class extends ki{constructor(){super(...arguments),this.elementClass="cm-activeLineGutter"}},$o=po.compute(["selection"],r=>{let e=[],t=-1;for(let n of r.selection.ranges){let s=r.doc.lineAt(n.head).from;s>t&&(t=s,e.push(ul.range(s)))}return p.Xs.of(e)});function dl(){return $o}const jo=new Map;function pl(r){let e=jo.get(r);return e||jo.set(r,e=Ye.mark({attributes:r==="	"?{class:"cm-highlightTab"}:{class:"cm-highlightSpace","data-display":r.replace(/ /g,"\xB7")}})),e}function Zo(r){return vi.define(e=>({decorations:r.createDeco(e),update(t){this.decorations=r.updateDeco(t,this.decorations)}}),{decorations:e=>e.decorations})}const ml=Zo(new xr({regexp:/\t| +/g,decoration:r=>pl(r[0]),boundary:/\S/}));function gl(){return ml}const bo=Zo(new xr({regexp:/\s+$/g,decoration:Ye.mark({class:"cm-trailingSpace"}),boundary:/\S/}));function yl(){return bo}const Ol={HeightMap:Me,HeightOracle:$e,MeasuredHeights:Tt,QueryType:Ae,ChangedRange:D,computeOrder:bs,moveVisually:O}},21649:(wn,Nt,q)=>{q.d(Nt,{Jq:()=>Fe,Lj:()=>bt,_b:()=>Xe,i9:()=>Mi,md:()=>L,mp:()=>nt,vj:()=>Ze});const p=1024;let we=0;class ue{constructor(x,C){this.from=x,this.to=C}}class L{constructor(x={}){this.id=we++,this.perNode=!!x.perNode,this.deserialize=x.deserialize||(()=>{throw new Error("This node type doesn't define a deserialize function")})}add(x){if(this.perNode)throw new RangeError("Can't add per-node props to node types");return typeof x!="function"&&(x=Fe.match(x)),C=>{let I=x(C);return I===void 0?null:[this,I]}}}L.closedBy=new L({deserialize:te=>te.split(" ")}),L.openedBy=new L({deserialize:te=>te.split(" ")}),L.group=new L({deserialize:te=>te.split(" ")}),L.contextHash=new L({perNode:!0}),L.lookAhead=new L({perNode:!0}),L.mounted=new L({perNode:!0});class G{constructor(x,C,I){this.tree=x,this.overlay=C,this.parser=I}static get(x){return x&&x.props&&x.props[L.mounted.id]}}const Se=Object.create(null);class Fe{constructor(x,C,I,N=0){this.name=x,this.props=C,this.id=I,this.flags=N}static define(x){let C=x.props&&x.props.length?Object.create(null):Se,I=(x.top?1:0)|(x.skipped?2:0)|(x.error?4:0)|(x.name==null?8:0),N=new Fe(x.name||"",C,x.id,I);if(x.props){for(let Z of x.props)if(Array.isArray(Z)||(Z=Z(N)),Z){if(Z[0].perNode)throw new RangeError("Can't store a per-node prop on a node type");C[Z[0].id]=Z[1]}}return N}prop(x){return this.props[x.id]}get isTop(){return(this.flags&1)>0}get isSkipped(){return(this.flags&2)>0}get isError(){return(this.flags&4)>0}get isAnonymous(){return(this.flags&8)>0}is(x){if(typeof x=="string"){if(this.name==x)return!0;let C=this.prop(L.group);return C?C.indexOf(x)>-1:!1}return this.id==x}static match(x){let C=Object.create(null);for(let I in x)for(let N of I.split(" "))C[N]=x[I];return I=>{for(let N=I.prop(L.group),Z=-1;Z<(N?N.length:0);Z++){let ee=C[Z<0?I.name:N[Z]];if(ee)return ee}}}}Fe.none=new Fe("",Object.create(null),0,8);class bt{constructor(x){this.types=x;for(let C=0;C<x.length;C++)if(x[C].id!=C)throw new RangeError("Node type ids should correspond to array positions when creating a node set")}extend(...x){let C=[];for(let I of this.types){let N=null;for(let Z of x){let ee=Z(I);ee&&(N||(N=Object.assign({},I.props)),N[ee[0].id]=ee[1])}C.push(N?new Fe(I.name,N,I.id,I.flags):I)}return new bt(C)}}const ft=new WeakMap,xt=new WeakMap;var Ze;(function(te){te[te.ExcludeBuffers=1]="ExcludeBuffers",te[te.IncludeAnonymous=2]="IncludeAnonymous",te[te.IgnoreMounts=4]="IgnoreMounts",te[te.IgnoreOverlays=8]="IgnoreOverlays"})(Ze||(Ze={}));class nt{constructor(x,C,I,N,Z){if(this.type=x,this.children=C,this.positions=I,this.length=N,this.props=null,Z&&Z.length){this.props=Object.create(null);for(let[ee,re]of Z)this.props[typeof ee=="number"?ee:ee.id]=re}}toString(){let x=G.get(this);if(x&&!x.overlay)return x.tree.toString();let C="";for(let I of this.children){let N=I.toString();N&&(C&&(C+=","),C+=N)}return this.type.name?(/\W/.test(this.type.name)&&!this.type.isError?JSON.stringify(this.type.name):this.type.name)+(C.length?"("+C+")":""):C}cursor(x=0){return new Ot(this.topNode,x)}cursorAt(x,C=0,I=0){let N=ft.get(this)||this.topNode,Z=new Ot(N);return Z.moveTo(x,C),ft.set(this,Z._tree),Z}get topNode(){return new ut(this,0,0,null)}resolve(x,C=0){let I=Xt(ft.get(this)||this.topNode,x,C,!1);return ft.set(this,I),I}resolveInner(x,C=0){let I=Xt(xt.get(this)||this.topNode,x,C,!0);return xt.set(this,I),I}resolveStack(x,C=0){return Pt(this,x,C)}iterate(x){let{enter:C,leave:I,from:N=0,to:Z=this.length}=x,ee=x.mode||0,re=(ee&Ze.IncludeAnonymous)>0;for(let xe=this.cursor(ee|Ze.IncludeAnonymous);;){let He=!1;if(xe.from<=Z&&xe.to>=N&&(!re&&xe.type.isAnonymous||C(xe)!==!1)){if(xe.firstChild())continue;He=!0}for(;He&&I&&(re||!xe.type.isAnonymous)&&I(xe),!xe.nextSibling();){if(!xe.parent())return;He=!0}}}prop(x){return x.perNode?this.props?this.props[x.id]:void 0:this.type.prop(x)}get propValues(){let x=[];if(this.props)for(let C in this.props)x.push([+C,this.props[C]]);return x}balance(x={}){return this.children.length<=8?this:ei(Fe.none,this.children,this.positions,0,this.children.length,0,this.length,(C,I,N)=>new nt(this.type,C,I,N,this.propValues),x.makeTree||((C,I,N)=>new nt(Fe.none,C,I,N)))}static build(x){return wt(x)}}nt.empty=new nt(Fe.none,[],[],0);class _e{constructor(x,C){this.buffer=x,this.index=C}get id(){return this.buffer[this.index-4]}get start(){return this.buffer[this.index-3]}get end(){return this.buffer[this.index-2]}get size(){return this.buffer[this.index-1]}get pos(){return this.index}next(){this.index-=4}fork(){return new _e(this.buffer,this.index)}}class mt{constructor(x,C,I){this.buffer=x,this.length=C,this.set=I}get type(){return Fe.none}toString(){let x=[];for(let C=0;C<this.buffer.length;)x.push(this.childString(C)),C=this.buffer[C+3];return x.join(",")}childString(x){let C=this.buffer[x],I=this.buffer[x+3],N=this.set.types[C],Z=N.name;if(/\W/.test(Z)&&!N.isError&&(Z=JSON.stringify(Z)),x+=4,I==x)return Z;let ee=[];for(;x<I;)ee.push(this.childString(x)),x=this.buffer[x+3];return Z+"("+ee.join(",")+")"}findChild(x,C,I,N,Z){let{buffer:ee}=this,re=-1;for(let xe=x;xe!=C&&!(mi(Z,N,ee[xe+1],ee[xe+2])&&(re=xe,I>0));xe=ee[xe+3]);return re}slice(x,C,I){let N=this.buffer,Z=new Uint16Array(C-x),ee=0;for(let re=x,xe=0;re<C;){Z[xe++]=N[re++],Z[xe++]=N[re++]-I;let He=Z[xe++]=N[re++]-I;Z[xe++]=N[re++]-x,ee=Math.max(ee,He)}return new mt(Z,ee,this.set)}}function mi(te,x,C,I){switch(te){case-2:return C<x;case-1:return I>=x&&C<x;case 0:return C<x&&I>x;case 1:return C<=x&&I>x;case 2:return I>x;case 4:return!0}}function Xt(te,x,C,I){for(var N;te.from==te.to||(C<1?te.from>=x:te.from>x)||(C>-1?te.to<=x:te.to<x);){let ee=!I&&te instanceof ut&&te.index<0?null:te.parent;if(!ee)return te;te=ee}let Z=I?0:Ze.IgnoreOverlays;if(I)for(let ee=te,re=ee.parent;re;ee=re,re=ee.parent)ee instanceof ut&&ee.index<0&&((N=re.enter(x,C,Z))===null||N===void 0?void 0:N.from)!=ee.from&&(te=re);for(;;){let ee=te.enter(x,C,Z);if(!ee)return te;te=ee}}class me{cursor(x=0){return new Ot(this,x)}getChild(x,C=null,I=null){let N=Kt(this,x,C,I);return N.length?N[0]:null}getChildren(x,C=null,I=null){return Kt(this,x,C,I)}resolve(x,C=0){return Xt(this,x,C,!1)}resolveInner(x,C=0){return Xt(this,x,C,!0)}matchContext(x){return bi(this,x)}enterUnfinishedNodesBefore(x){let C=this.childBefore(x),I=this;for(;C;){let N=C.lastChild;if(!N||N.to!=C.to)break;N.type.isError&&N.from==N.to?(I=C,C=N.prevSibling):C=N}return I}get node(){return this}get next(){return this.parent}}class ut extends me{constructor(x,C,I,N){super(),this._tree=x,this.from=C,this.index=I,this._parent=N}get type(){return this._tree.type}get name(){return this._tree.type.name}get to(){return this.from+this._tree.length}nextChild(x,C,I,N,Z=0){for(let ee=this;;){for(let{children:re,positions:xe}=ee._tree,He=C>0?re.length:-1;x!=He;x+=C){let Pe=re[x],Qe=xe[x]+ee.from;if(mi(N,I,Qe,Qe+Pe.length)){if(Pe instanceof mt){if(Z&Ze.ExcludeBuffers)continue;let tt=Pe.findChild(0,Pe.buffer.length,C,I-Qe,N);if(tt>-1)return new Et(new fi(ee,Pe,x,Qe),null,tt)}else if(Z&Ze.IncludeAnonymous||!Pe.type.isAnonymous||Dt(Pe)){let tt;if(!(Z&Ze.IgnoreMounts)&&(tt=G.get(Pe))&&!tt.overlay)return new ut(tt.tree,Qe,x,ee);let dt=new ut(Pe,Qe,x,ee);return Z&Ze.IncludeAnonymous||!dt.type.isAnonymous?dt:dt.nextChild(C<0?Pe.children.length-1:0,C,I,N)}}}if(Z&Ze.IncludeAnonymous||!ee.type.isAnonymous||(ee.index>=0?x=ee.index+C:x=C<0?-1:ee._parent._tree.children.length,ee=ee._parent,!ee))return null}}get firstChild(){return this.nextChild(0,1,0,4)}get lastChild(){return this.nextChild(this._tree.children.length-1,-1,0,4)}childAfter(x){return this.nextChild(0,1,x,2)}childBefore(x){return this.nextChild(this._tree.children.length-1,-1,x,-2)}enter(x,C,I=0){let N;if(!(I&Ze.IgnoreOverlays)&&(N=G.get(this._tree))&&N.overlay){let Z=x-this.from;for(let{from:ee,to:re}of N.overlay)if((C>0?ee<=Z:ee<Z)&&(C<0?re>=Z:re>Z))return new ut(N.tree,N.overlay[0].from+this.from,-1,this)}return this.nextChild(0,1,x,C,I)}nextSignificantParent(){let x=this;for(;x.type.isAnonymous&&x._parent;)x=x._parent;return x}get parent(){return this._parent?this._parent.nextSignificantParent():null}get nextSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index+1,1,0,4):null}get prevSibling(){return this._parent&&this.index>=0?this._parent.nextChild(this.index-1,-1,0,4):null}get tree(){return this._tree}toTree(){return this._tree}toString(){return this._tree.toString()}}function Kt(te,x,C,I){let N=te.cursor(),Z=[];if(!N.firstChild())return Z;if(C!=null){for(;!N.type.is(C);)if(!N.nextSibling())return Z}for(;;){if(I!=null&&N.type.is(I))return Z;if(N.type.is(x)&&Z.push(N.node),!N.nextSibling())return I==null?Z:[]}}function bi(te,x,C=x.length-1){for(let I=te.parent;C>=0;I=I.parent){if(!I)return!1;if(!I.type.isAnonymous){if(x[C]&&x[C]!=I.name)return!1;C--}}return!0}class fi{constructor(x,C,I,N){this.parent=x,this.buffer=C,this.index=I,this.start=N}}class Et extends me{get name(){return this.type.name}get from(){return this.context.start+this.context.buffer.buffer[this.index+1]}get to(){return this.context.start+this.context.buffer.buffer[this.index+2]}constructor(x,C,I){super(),this.context=x,this._parent=C,this.index=I,this.type=x.buffer.set.types[x.buffer.buffer[I]]}child(x,C,I){let{buffer:N}=this.context,Z=N.findChild(this.index+4,N.buffer[this.index+3],x,C-this.context.start,I);return Z<0?null:new Et(this.context,this,Z)}get firstChild(){return this.child(1,0,4)}get lastChild(){return this.child(-1,0,4)}childAfter(x){return this.child(1,x,2)}childBefore(x){return this.child(-1,x,-2)}enter(x,C,I=0){if(I&Ze.ExcludeBuffers)return null;let{buffer:N}=this.context,Z=N.findChild(this.index+4,N.buffer[this.index+3],C>0?1:-1,x-this.context.start,C);return Z<0?null:new Et(this.context,this,Z)}get parent(){return this._parent||this.context.parent.nextSignificantParent()}externalSibling(x){return this._parent?null:this.context.parent.nextChild(this.context.index+x,x,0,4)}get nextSibling(){let{buffer:x}=this.context,C=x.buffer[this.index+3];return C<(this._parent?x.buffer[this._parent.index+3]:x.buffer.length)?new Et(this.context,this._parent,C):this.externalSibling(1)}get prevSibling(){let{buffer:x}=this.context,C=this._parent?this._parent.index+4:0;return this.index==C?this.externalSibling(-1):new Et(this.context,this._parent,x.findChild(C,this.index,-1,0,4))}get tree(){return null}toTree(){let x=[],C=[],{buffer:I}=this.context,N=this.index+4,Z=I.buffer[this.index+3];if(Z>N){let ee=I.buffer[this.index+1];x.push(I.slice(N,Z,ee)),C.push(0)}return new nt(this.type,x,C,this.to-this.from)}toString(){return this.context.buffer.childString(this.index)}}function ui(te){if(!te.length)return null;let x=0,C=te[0];for(let Z=1;Z<te.length;Z++){let ee=te[Z];(ee.from>C.from||ee.to<C.to)&&(C=ee,x=Z)}let I=C instanceof ut&&C.index<0?null:C.parent,N=te.slice();return I?N[x]=I:N.splice(x,1),new Oi(N,C)}class Oi{constructor(x,C){this.heads=x,this.node=C}get next(){return ui(this.heads)}}function Pt(te,x,C){let I=te.resolveInner(x,C),N=null;for(let Z=I instanceof ut?I:I.context.parent;Z;Z=Z.parent)if(Z.index<0){let ee=Z.parent;(N||(N=[I])).push(ee.resolve(x,C)),Z=ee}else{let ee=G.get(Z.tree);if(ee&&ee.overlay&&ee.overlay[0].from<=x&&ee.overlay[ee.overlay.length-1].to>=x){let re=new ut(ee.tree,ee.overlay[0].from+Z.from,-1,Z);(N||(N=[I])).push(Xt(re,x,C,!1))}}return N?ui(N):I}class Ot{get name(){return this.type.name}constructor(x,C=0){if(this.mode=C,this.buffer=null,this.stack=[],this.index=0,this.bufferNode=null,x instanceof ut)this.yieldNode(x);else{this._tree=x.context.parent,this.buffer=x.context;for(let I=x._parent;I;I=I._parent)this.stack.unshift(I.index);this.bufferNode=x,this.yieldBuf(x.index)}}yieldNode(x){return x?(this._tree=x,this.type=x.type,this.from=x.from,this.to=x.to,!0):!1}yieldBuf(x,C){this.index=x;let{start:I,buffer:N}=this.buffer;return this.type=C||N.set.types[N.buffer[x]],this.from=I+N.buffer[x+1],this.to=I+N.buffer[x+2],!0}yield(x){return x?x instanceof ut?(this.buffer=null,this.yieldNode(x)):(this.buffer=x.context,this.yieldBuf(x.index,x.type)):!1}toString(){return this.buffer?this.buffer.buffer.childString(this.index):this._tree.toString()}enterChild(x,C,I){if(!this.buffer)return this.yield(this._tree.nextChild(x<0?this._tree._tree.children.length-1:0,x,C,I,this.mode));let{buffer:N}=this.buffer,Z=N.findChild(this.index+4,N.buffer[this.index+3],x,C-this.buffer.start,I);return Z<0?!1:(this.stack.push(this.index),this.yieldBuf(Z))}firstChild(){return this.enterChild(1,0,4)}lastChild(){return this.enterChild(-1,0,4)}childAfter(x){return this.enterChild(1,x,2)}childBefore(x){return this.enterChild(-1,x,-2)}enter(x,C,I=this.mode){return this.buffer?I&Ze.ExcludeBuffers?!1:this.enterChild(1,x,C):this.yield(this._tree.enter(x,C,I))}parent(){if(!this.buffer)return this.yieldNode(this.mode&Ze.IncludeAnonymous?this._tree._parent:this._tree.parent);if(this.stack.length)return this.yieldBuf(this.stack.pop());let x=this.mode&Ze.IncludeAnonymous?this.buffer.parent:this.buffer.parent.nextSignificantParent();return this.buffer=null,this.yieldNode(x)}sibling(x){if(!this.buffer)return this._tree._parent?this.yield(this._tree.index<0?null:this._tree._parent.nextChild(this._tree.index+x,x,0,4,this.mode)):!1;let{buffer:C}=this.buffer,I=this.stack.length-1;if(x<0){let N=I<0?0:this.stack[I]+4;if(this.index!=N)return this.yieldBuf(C.findChild(N,this.index,-1,0,4))}else{let N=C.buffer[this.index+3];if(N<(I<0?C.buffer.length:C.buffer[this.stack[I]+3]))return this.yieldBuf(N)}return I<0?this.yield(this.buffer.parent.nextChild(this.buffer.index+x,x,0,4,this.mode)):!1}nextSibling(){return this.sibling(1)}prevSibling(){return this.sibling(-1)}atLastNode(x){let C,I,{buffer:N}=this;if(N){if(x>0){if(this.index<N.buffer.buffer.length)return!1}else for(let Z=0;Z<this.index;Z++)if(N.buffer.buffer[Z+3]<this.index)return!1;({index:C,parent:I}=N)}else({index:C,_parent:I}=this._tree);for(;I;{index:C,_parent:I}=I)if(C>-1)for(let Z=C+x,ee=x<0?-1:I._tree.children.length;Z!=ee;Z+=x){let re=I._tree.children[Z];if(this.mode&Ze.IncludeAnonymous||re instanceof mt||!re.type.isAnonymous||Dt(re))return!1}return!0}move(x,C){if(C&&this.enterChild(x,0,4))return!0;for(;;){if(this.sibling(x))return!0;if(this.atLastNode(x)||!this.parent())return!1}}next(x=!0){return this.move(1,x)}prev(x=!0){return this.move(-1,x)}moveTo(x,C=0){for(;(this.from==this.to||(C<1?this.from>=x:this.from>x)||(C>-1?this.to<=x:this.to<x))&&this.parent(););for(;this.enterChild(1,x,C););return this}get node(){if(!this.buffer)return this._tree;let x=this.bufferNode,C=null,I=0;if(x&&x.context==this.buffer){e:for(let N=this.index,Z=this.stack.length;Z>=0;){for(let ee=x;ee;ee=ee._parent)if(ee.index==N){if(N==this.index)return ee;C=ee,I=Z+1;break e}N=this.stack[--Z]}}for(let N=I;N<this.stack.length;N++)C=new Et(this.buffer,C,this.stack[N]);return this.bufferNode=new Et(this.buffer,C,this.index)}get tree(){return this.buffer?null:this._tree._tree}iterate(x,C){for(let I=0;;){let N=!1;if(this.type.isAnonymous||x(this)!==!1){if(this.firstChild()){I++;continue}this.type.isAnonymous||(N=!0)}for(;N&&C&&C(this),N=this.type.isAnonymous,!this.nextSibling();){if(!I)return;this.parent(),I--,N=!0}}}matchContext(x){if(!this.buffer)return bi(this.node,x);let{buffer:C}=this.buffer,{types:I}=C.set;for(let N=x.length-1,Z=this.stack.length-1;N>=0;Z--){if(Z<0)return bi(this.node,x,N);let ee=I[C.buffer[this.stack[Z]]];if(!ee.isAnonymous){if(x[N]&&x[N]!=ee.name)return!1;N--}}return!0}}function Dt(te){return te.children.some(x=>x instanceof mt||!x.type.isAnonymous||Dt(x))}function wt(te){var x;let{buffer:C,nodeSet:I,maxBufferLength:N=p,reused:Z=[],minRepeatType:ee=I.types.length}=te,re=Array.isArray(C)?new _e(C,C.length):C,xe=I.types,He=0,Pe=0;function Qe(st,Ye,Ve,Jt,ot,rt){let{id:yt,start:lt,end:Zt,size:Bt}=re,pt=Pe;for(;Bt<0;)if(re.next(),Bt==-1){let Ci=Z[yt];Ve.push(Ci),Jt.push(lt-st);return}else if(Bt==-3){He=yt;return}else if(Bt==-4){Pe=yt;return}else throw new RangeError(`Unrecognized record size: ${Bt}`);let gi=xe[yt],hi,yi,on=lt-st;if(Zt-lt<=N&&(yi=$t(re.pos-Ye,ot))){let Ci=new Uint16Array(yi.size-yi.skip),Lt=re.pos-yi.size,zi=Ci.length;for(;re.pos>Lt;)zi=jt(yi.start,Ci,zi);hi=new mt(Ci,Zt-yi.start,I),on=yi.start-st}else{let Ci=re.pos-Bt;re.next();let Lt=[],zi=[],Ni=yt>=ee?yt:-1,qi=0,Ki=Zt;for(;re.pos>Ci;)Ni>=0&&re.id==Ni&&re.size>=0?(re.end<=Ki-N&&(ti(Lt,zi,lt,qi,re.end,Ki,Ni,pt),qi=Lt.length,Ki=re.end),re.next()):rt>2500?tt(lt,Ci,Lt,zi):Qe(lt,Ci,Lt,zi,Ni,rt+1);if(Ni>=0&&qi>0&&qi<Lt.length&&ti(Lt,zi,lt,qi,lt,Ki,Ni,pt),Lt.reverse(),zi.reverse(),Ni>-1&&qi>0){let Qi=dt(gi);hi=ei(gi,Lt,zi,0,Lt.length,0,Zt-lt,Qi,Qi)}else hi=qt(gi,Lt,zi,Zt-lt,pt-Zt)}Ve.push(hi),Jt.push(on)}function tt(st,Ye,Ve,Jt){let ot=[],rt=0,yt=-1;for(;re.pos>Ye;){let{id:lt,start:Zt,end:Bt,size:pt}=re;if(pt>4)re.next();else{if(yt>-1&&Zt<yt)break;yt<0&&(yt=Bt-N),ot.push(lt,Zt,Bt),rt++,re.next()}}if(rt){let lt=new Uint16Array(rt*4),Zt=ot[ot.length-2];for(let Bt=ot.length-3,pt=0;Bt>=0;Bt-=3)lt[pt++]=ot[Bt],lt[pt++]=ot[Bt+1]-Zt,lt[pt++]=ot[Bt+2]-Zt,lt[pt++]=pt;Ve.push(new mt(lt,ot[2]-Zt,I)),Jt.push(Zt-st)}}function dt(st){return(Ye,Ve,Jt)=>{let ot=0,rt=Ye.length-1,yt,lt;if(rt>=0&&(yt=Ye[rt])instanceof nt){if(!rt&&yt.type==st&&yt.length==Jt)return yt;(lt=yt.prop(L.lookAhead))&&(ot=Ve[rt]+yt.length+lt)}return qt(st,Ye,Ve,Jt,ot)}}function ti(st,Ye,Ve,Jt,ot,rt,yt,lt){let Zt=[],Bt=[];for(;st.length>Jt;)Zt.push(st.pop()),Bt.push(Ye.pop()+Ve-ot);st.push(qt(I.types[yt],Zt,Bt,rt-ot,lt-rt)),Ye.push(ot-Ve)}function qt(st,Ye,Ve,Jt,ot=0,rt){if(He){let yt=[L.contextHash,He];rt=rt?[yt].concat(rt):[yt]}if(ot>25){let yt=[L.lookAhead,ot];rt=rt?[yt].concat(rt):[yt]}return new nt(st,Ye,Ve,Jt,rt)}function $t(st,Ye){let Ve=re.fork(),Jt=0,ot=0,rt=0,yt=Ve.end-N,lt={size:0,start:0,skip:0};e:for(let Zt=Ve.pos-st;Ve.pos>Zt;){let Bt=Ve.size;if(Ve.id==Ye&&Bt>=0){lt.size=Jt,lt.start=ot,lt.skip=rt,rt+=4,Jt+=4,Ve.next();continue}let pt=Ve.pos-Bt;if(Bt<0||pt<Zt||Ve.start<yt)break;let gi=Ve.id>=ee?4:0,hi=Ve.start;for(Ve.next();Ve.pos>pt;){if(Ve.size<0)if(Ve.size==-3)gi+=4;else break e;else Ve.id>=ee&&(gi+=4);Ve.next()}ot=hi,Jt+=Bt,rt+=gi}return(Ye<0||Jt==st)&&(lt.size=Jt,lt.start=ot,lt.skip=rt),lt.size>4?lt:void 0}function jt(st,Ye,Ve){let{id:Jt,start:ot,end:rt,size:yt}=re;if(re.next(),yt>=0&&Jt<ee){let lt=Ve;if(yt>4){let Zt=re.pos-(yt-4);for(;re.pos>Zt;)Ve=jt(st,Ye,Ve)}Ye[--Ve]=lt,Ye[--Ve]=rt-st,Ye[--Ve]=ot-st,Ye[--Ve]=Jt}else yt==-3?He=Jt:yt==-4&&(Pe=Jt);return Ve}let Ct=[],Rt=[];for(;re.pos>0;)Qe(te.start||0,te.bufferStart||0,Ct,Rt,-1,0);let xi=(x=te.length)!==null&&x!==void 0?x:Ct.length?Rt[0]+Ct[0].length:0;return new nt(xe[te.topID],Ct.reverse(),Rt.reverse(),xi)}const ai=new WeakMap;function _t(te,x){if(!te.isAnonymous||x instanceof mt||x.type!=te)return 1;let C=ai.get(x);if(C==null){C=1;for(let I of x.children){if(I.type!=te||!(I instanceof nt)){C=1;break}C+=_t(te,I)}ai.set(x,C)}return C}function ei(te,x,C,I,N,Z,ee,re,xe){let He=0;for(let ti=I;ti<N;ti++)He+=_t(te,x[ti]);let Pe=Math.ceil(He*1.5/8),Qe=[],tt=[];function dt(ti,qt,$t,jt,Ct){for(let Rt=$t;Rt<jt;){let xi=Rt,st=qt[Rt],Ye=_t(te,ti[Rt]);for(Rt++;Rt<jt;Rt++){let Ve=_t(te,ti[Rt]);if(Ye+Ve>=Pe)break;Ye+=Ve}if(Rt==xi+1){if(Ye>Pe){let Ve=ti[xi];dt(Ve.children,Ve.positions,0,Ve.children.length,qt[xi]+Ct);continue}Qe.push(ti[xi])}else{let Ve=qt[Rt-1]+ti[Rt-1].length-st;Qe.push(ei(te,ti,qt,xi,Rt,st,Ve,null,xe))}tt.push(st+Ct-Z)}}return dt(x,C,I,N,0),(re||xe)(Qe,tt,ee)}class Ge{constructor(){this.map=new WeakMap}setBuffer(x,C,I){let N=this.map.get(x);N||this.map.set(x,N=new Map),N.set(C,I)}getBuffer(x,C){let I=this.map.get(x);return I&&I.get(C)}set(x,C){x instanceof Et?this.setBuffer(x.context.buffer,x.index,C):x instanceof ut&&this.map.set(x.tree,C)}get(x){return x instanceof Et?this.getBuffer(x.context.buffer,x.index):x instanceof ut?this.map.get(x.tree):void 0}cursorSet(x,C){x.buffer?this.setBuffer(x.buffer.buffer,x.index,C):this.map.set(x.tree,C)}cursorGet(x){return x.buffer?this.getBuffer(x.buffer.buffer,x.index):this.map.get(x.tree)}}class Mi{constructor(x,C,I,N,Z=!1,ee=!1){this.from=x,this.to=C,this.tree=I,this.offset=N,this.open=(Z?1:0)|(ee?2:0)}get openStart(){return(this.open&1)>0}get openEnd(){return(this.open&2)>0}static addTree(x,C=[],I=!1){let N=[new Mi(0,x.length,x,0,!1,I)];for(let Z of C)Z.to>x.length&&N.push(Z);return N}static applyChanges(x,C,I=128){if(!C.length)return x;let N=[],Z=1,ee=x.length?x[0]:null;for(let re=0,xe=0,He=0;;re++){let Pe=re<C.length?C[re]:null,Qe=Pe?Pe.fromA:1e9;if(Qe-xe>=I)for(;ee&&ee.from<Qe;){let tt=ee;if(xe>=tt.from||Qe<=tt.to||He){let dt=Math.max(tt.from,xe)-He,ti=Math.min(tt.to,Qe)-He;tt=dt>=ti?null:new Mi(dt,ti,tt.tree,tt.offset+He,re>0,!!Pe)}if(tt&&N.push(tt),ee.to>Qe)break;ee=Z<x.length?x[Z++]:null}if(!Pe)break;xe=Pe.toA,He=Pe.toA-Pe.toB}return N}}class Xe{startParse(x,C,I){return typeof x=="string"&&(x=new ae(x)),I=I?I.length?I.map(N=>new ue(N.from,N.to)):[new ue(0,0)]:[new ue(0,x.length)],this.createParse(x,C||[],I)}parse(x,C,I){let N=this.startParse(x,C,I);for(;;){let Z=N.advance();if(Z)return Z}}}class ae{constructor(x){this.string=x}get length(){return this.string.length}chunk(x){return this.string.slice(x)}get lineChunks(){return!1}read(x,C){return this.string.slice(x,C)}}function be(te){return(x,C,I,N)=>new Le(x,te,C,I,N)}class ze{constructor(x,C,I,N,Z){this.parser=x,this.parse=C,this.overlay=I,this.target=N,this.from=Z}}function ke(te){if(!te.length||te.some(x=>x.from>=x.to))throw new RangeError("Invalid inner parse ranges given: "+JSON.stringify(te))}class Ee{constructor(x,C,I,N,Z,ee,re){this.parser=x,this.predicate=C,this.mounts=I,this.index=N,this.start=Z,this.target=ee,this.prev=re,this.depth=0,this.ranges=[]}}const zt=new L({perNode:!0});class Le{constructor(x,C,I,N,Z){this.nest=C,this.input=I,this.fragments=N,this.ranges=Z,this.inner=[],this.innerDone=0,this.baseTree=null,this.stoppedAt=null,this.baseParse=x}advance(){if(this.baseParse){let I=this.baseParse.advance();if(!I)return null;if(this.baseParse=null,this.baseTree=I,this.startInner(),this.stoppedAt!=null)for(let N of this.inner)N.parse.stopAt(this.stoppedAt)}if(this.innerDone==this.inner.length){let I=this.baseTree;return this.stoppedAt!=null&&(I=new nt(I.type,I.children,I.positions,I.length,I.propValues.concat([[zt,this.stoppedAt]]))),I}let x=this.inner[this.innerDone],C=x.parse.advance();if(C){this.innerDone++;let I=Object.assign(Object.create(null),x.target.props);I[L.mounted.id]=new G(C,x.overlay,x.parser),x.target.props=I}return null}get parsedPos(){if(this.baseParse)return 0;let x=this.input.length;for(let C=this.innerDone;C<this.inner.length;C++)this.inner[C].from<x&&(x=Math.min(x,this.inner[C].parse.parsedPos));return x}stopAt(x){if(this.stoppedAt=x,this.baseParse)this.baseParse.stopAt(x);else for(let C=this.innerDone;C<this.inner.length;C++)this.inner[C].parse.stopAt(x)}startInner(){let x=new gt(this.fragments),C=null,I=null,N=new Ot(new ut(this.baseTree,this.ranges[0].from,0,null),Ze.IncludeAnonymous|Ze.IgnoreMounts);e:for(let Z,ee;;){let re=!0,xe;if(this.stoppedAt!=null&&N.from>=this.stoppedAt)re=!1;else if(x.hasNode(N)){if(C){let He=C.mounts.find(Pe=>Pe.frag.from<=N.from&&Pe.frag.to>=N.to&&Pe.mount.overlay);if(He)for(let Pe of He.mount.overlay){let Qe=Pe.from+He.pos,tt=Pe.to+He.pos;Qe>=N.from&&tt<=N.to&&!C.ranges.some(dt=>dt.from<tt&&dt.to>Qe)&&C.ranges.push({from:Qe,to:tt})}}re=!1}else if(I&&(ee=Yt(I.ranges,N.from,N.to)))re=ee!=2;else if(!N.type.isAnonymous&&(Z=this.nest(N,this.input))&&(N.from<N.to||!Z.overlay)){N.tree||Pi(N);let He=x.findMounts(N.from,Z.parser);if(typeof Z.overlay=="function")C=new Ee(Z.parser,Z.overlay,He,this.inner.length,N.from,N.tree,C);else{let Pe=si(this.ranges,Z.overlay||(N.from<N.to?[new ue(N.from,N.to)]:[]));Pe.length&&ke(Pe),(Pe.length||!Z.overlay)&&this.inner.push(new ze(Z.parser,Pe.length?Z.parser.startParse(this.input,Zi(He,Pe),Pe):Z.parser.startParse(""),Z.overlay?Z.overlay.map(Qe=>new ue(Qe.from-N.from,Qe.to-N.from)):null,N.tree,Pe.length?Pe[0].from:N.from)),Z.overlay?Pe.length&&(I={ranges:Pe,depth:0,prev:I}):re=!1}}else C&&(xe=C.predicate(N))&&(xe===!0&&(xe=new ue(N.from,N.to)),xe.from<xe.to&&C.ranges.push(xe));if(re&&N.firstChild())C&&C.depth++,I&&I.depth++;else for(;!N.nextSibling();){if(!N.parent())break e;if(C&&!--C.depth){let He=si(this.ranges,C.ranges);He.length&&(ke(He),this.inner.splice(C.index,0,new ze(C.parser,C.parser.startParse(this.input,Zi(C.mounts,He),He),C.ranges.map(Pe=>new ue(Pe.from-C.start,Pe.to-C.start)),C.target,He[0].from))),C=C.prev}I&&!--I.depth&&(I=I.prev)}}}}function Yt(te,x,C){for(let I of te){if(I.from>=C)break;if(I.to>x)return I.from<=x&&I.to>=C?2:1}return 0}function et(te,x,C,I,N,Z){if(x<C){let ee=te.buffer[x+1];I.push(te.slice(x,C,ee)),N.push(ee-Z)}}function Pi(te){let{node:x}=te,C=[],I=x.context.buffer;do C.push(te.index),te.parent();while(!te.tree);let N=te.tree,Z=N.children.indexOf(I),ee=N.children[Z],re=ee.buffer,xe=[Z];function He(Pe,Qe,tt,dt,ti,qt){let $t=C[qt],jt=[],Ct=[];et(ee,Pe,$t,jt,Ct,dt);let Rt=re[$t+1],xi=re[$t+2];xe.push(jt.length);let st=qt?He($t+4,re[$t+3],ee.set.types[re[$t]],Rt,xi-Rt,qt-1):x.toTree();return jt.push(st),Ct.push(Rt-dt),et(ee,re[$t+3],Qe,jt,Ct,dt),new nt(tt,jt,Ct,ti)}N.children[Z]=He(0,re.length,Fe.none,0,ee.length,C.length-1);for(let Pe of xe){let Qe=te.tree.children[Pe],tt=te.tree.positions[Pe];te.yield(new ut(Qe,tt+te.from,Pe,te._tree))}}class Ft{constructor(x,C){this.offset=C,this.done=!1,this.cursor=x.cursor(Ze.IncludeAnonymous|Ze.IgnoreMounts)}moveTo(x){let{cursor:C}=this,I=x-this.offset;for(;!this.done&&C.from<I;)C.to>=x&&C.enter(I,1,Ze.IgnoreOverlays|Ze.ExcludeBuffers)||C.next(!1)||(this.done=!0)}hasNode(x){if(this.moveTo(x.from),!this.done&&this.cursor.from+this.offset==x.from&&this.cursor.tree)for(let C=this.cursor.tree;;){if(C==x.tree)return!0;if(C.children.length&&C.positions[0]==0&&C.children[0]instanceof nt)C=C.children[0];else break}return!1}}class gt{constructor(x){var C;if(this.fragments=x,this.curTo=0,this.fragI=0,x.length){let I=this.curFrag=x[0];this.curTo=(C=I.tree.prop(zt))!==null&&C!==void 0?C:I.to,this.inner=new Ft(I.tree,-I.offset)}else this.curFrag=this.inner=null}hasNode(x){for(;this.curFrag&&x.from>=this.curTo;)this.nextFrag();return this.curFrag&&this.curFrag.from<=x.from&&this.curTo>=x.to&&this.inner.hasNode(x)}nextFrag(){var x;if(this.fragI++,this.fragI==this.fragments.length)this.curFrag=this.inner=null;else{let C=this.curFrag=this.fragments[this.fragI];this.curTo=(x=C.tree.prop(zt))!==null&&x!==void 0?x:C.to,this.inner=new Ft(C.tree,-C.offset)}}findMounts(x,C){var I;let N=[];if(this.inner){this.inner.cursor.moveTo(x,1);for(let Z=this.inner.cursor.node;Z;Z=Z.parent){let ee=(I=Z.tree)===null||I===void 0?void 0:I.prop(L.mounted);if(ee&&ee.parser==C)for(let re=this.fragI;re<this.fragments.length;re++){let xe=this.fragments[re];if(xe.from>=Z.to)break;xe.tree==this.curFrag.tree&&N.push({frag:xe,pos:Z.from-xe.offset,mount:ee})}}}return N}}function si(te,x){let C=null,I=x;for(let N=1,Z=0;N<te.length;N++){let ee=te[N-1].to,re=te[N].from;for(;Z<I.length;Z++){let xe=I[Z];if(xe.from>=re)break;xe.to<=ee||(C||(I=C=x.slice()),xe.from<ee?(C[Z]=new ue(xe.from,ee),xe.to>re&&C.splice(Z+1,0,new ue(re,xe.to))):xe.to>re?C[Z--]=new ue(re,xe.to):C.splice(Z--,1))}}return I}function rn(te,x,C,I){let N=0,Z=0,ee=!1,re=!1,xe=-1e9,He=[];for(;;){let Pe=N==te.length?1e9:ee?te[N].to:te[N].from,Qe=Z==x.length?1e9:re?x[Z].to:x[Z].from;if(ee!=re){let tt=Math.max(xe,C),dt=Math.min(Pe,Qe,I);tt<dt&&He.push(new ue(tt,dt))}if(xe=Math.min(Pe,Qe),xe==1e9)break;Pe==xe&&(ee?(ee=!1,N++):ee=!0),Qe==xe&&(re?(re=!1,Z++):re=!0)}return He}function Zi(te,x){let C=[];for(let{pos:I,mount:N,frag:Z}of te){let ee=I+(N.overlay?N.overlay[0].from:0),re=ee+N.tree.length,xe=Math.max(Z.from,ee),He=Math.min(Z.to,re);if(N.overlay){let Pe=N.overlay.map(tt=>new ue(tt.from+I,tt.to+I)),Qe=rn(x,Pe,xe,He);for(let tt=0,dt=xe;;tt++){let ti=tt==Qe.length,qt=ti?He:Qe[tt].from;if(qt>dt&&C.push(new Mi(dt,qt,N.tree,-ee,Z.from>=dt||Z.openStart,Z.to<=qt||Z.openEnd)),ti)break;dt=Qe[tt].to}}else C.push(new Mi(xe,He,N.tree,-ee,Z.from>=ee||Z.openStart,Z.to<=re||Z.openEnd))}return C}},86253:(wn,Nt,q)=>{q.d(Nt,{Gv:()=>bt,QR:()=>Ze,bW:()=>_e,pJ:()=>Ge});var p=q(21649);let we=0;class ue{constructor(ae,be,ze){this.set=ae,this.base=be,this.modified=ze,this.id=we++}static define(ae){if(ae!=null&&ae.base)throw new Error("Can not derive from a modified tag");let be=new ue([],null,[]);if(be.set.push(be),ae)for(let ze of ae.set)be.set.push(ze);return be}static defineModifier(){let ae=new G;return be=>be.modified.indexOf(ae)>-1?be:G.get(be.base||be,be.modified.concat(ae).sort((ze,ke)=>ze.id-ke.id))}}let L=0;class G{constructor(){this.instances=[],this.id=L++}static get(ae,be){if(!be.length)return ae;let ze=be[0].instances.find(Le=>Le.base==ae&&Se(be,Le.modified));if(ze)return ze;let ke=[],Ee=new ue(ke,ae,be);for(let Le of be)Le.instances.push(Ee);let zt=Fe(be);for(let Le of ae.set)if(!Le.modified.length)for(let Yt of zt)ke.push(G.get(Le,Yt));return Ee}}function Se(Xe,ae){return Xe.length==ae.length&&Xe.every((be,ze)=>be==ae[ze])}function Fe(Xe){let ae=[[]];for(let be=0;be<Xe.length;be++)for(let ze=0,ke=ae.length;ze<ke;ze++)ae.push(ae[ze].concat(Xe[be]));return ae.sort((be,ze)=>ze.length-be.length)}function bt(Xe){let ae=Object.create(null);for(let be in Xe){let ze=Xe[be];Array.isArray(ze)||(ze=[ze]);for(let ke of be.split(" "))if(ke){let Ee=[],zt=2,Le=ke;for(let Ft=0;;){if(Le=="..."&&Ft>0&&Ft+3==ke.length){zt=1;break}let gt=/^"(?:[^"\\]|\\.)*?"|[^\/!]+/.exec(Le);if(!gt)throw new RangeError("Invalid path: "+ke);if(Ee.push(gt[0]=="*"?"":gt[0][0]=='"'?JSON.parse(gt[0]):gt[0]),Ft+=gt[0].length,Ft==ke.length)break;let si=ke[Ft++];if(Ft==ke.length&&si=="!"){zt=0;break}if(si!="/")throw new RangeError("Invalid path: "+ke);Le=ke.slice(Ft)}let Yt=Ee.length-1,et=Ee[Yt];if(!et)throw new RangeError("Invalid path: "+ke);let Pi=new xt(ze,zt,Yt>0?Ee.slice(0,Yt):null);ae[et]=Pi.sort(ae[et])}}return ft.add(ae)}const ft=new p.md;class xt{constructor(ae,be,ze,ke){this.tags=ae,this.mode=be,this.context=ze,this.next=ke}get opaque(){return this.mode==0}get inherit(){return this.mode==1}sort(ae){return!ae||ae.depth<this.depth?(this.next=ae,this):(ae.next=this.sort(ae.next),ae)}get depth(){return this.context?this.context.length:0}}xt.empty=new xt([],2,null);function Ze(Xe,ae){let be=Object.create(null);for(let Ee of Xe)if(!Array.isArray(Ee.tag))be[Ee.tag.id]=Ee.class;else for(let zt of Ee.tag)be[zt.id]=Ee.class;let{scope:ze,all:ke=null}=ae||{};return{style:Ee=>{let zt=ke;for(let Le of Ee)for(let Yt of Le.set){let et=be[Yt.id];if(et){zt=zt?zt+" "+et:et;break}}return zt},scope:ze}}function nt(Xe,ae){let be=null;for(let ze of Xe){let ke=ze.style(ae);ke&&(be=be?be+" "+ke:ke)}return be}function _e(Xe,ae,be,ze=0,ke=Xe.length){let Ee=new mi(ze,Array.isArray(ae)?ae:[ae],be);Ee.highlightRange(Xe.cursor(),ze,ke,"",Ee.highlighters),Ee.flush(ke)}function mt(Xe,ae,be,ze,ke,Ee=0,zt=Xe.length){let Le=Ee;function Yt(et,Pi){if(!(et<=Le)){for(let Ft=Xe.slice(Le,et),gt=0;;){let si=Ft.indexOf(`
`,gt),rn=si<0?Ft.length:si;if(rn>gt&&ze(Ft.slice(gt,rn),Pi),si<0)break;ke(),gt=si+1}Le=et}}_e(ae,be,(et,Pi,Ft)=>{Yt(et,""),Yt(Pi,Ft)},Ee,zt),Yt(zt,"")}class mi{constructor(ae,be,ze){this.at=ae,this.highlighters=be,this.span=ze,this.class=""}startSpan(ae,be){be!=this.class&&(this.flush(ae),ae>this.at&&(this.at=ae),this.class=be)}flush(ae){ae>this.at&&this.class&&this.span(this.at,ae,this.class)}highlightRange(ae,be,ze,ke,Ee){let{type:zt,from:Le,to:Yt}=ae;if(Le>=ze||Yt<=be)return;zt.isTop&&(Ee=this.highlighters.filter(si=>!si.scope||si.scope(zt)));let et=ke,Pi=Xt(ae)||xt.empty,Ft=nt(Ee,Pi.tags);if(Ft&&(et&&(et+=" "),et+=Ft,Pi.mode==1&&(ke+=(ke?" ":"")+Ft)),this.startSpan(Math.max(be,Le),et),Pi.opaque)return;let gt=ae.tree&&ae.tree.prop(p.md.mounted);if(gt&&gt.overlay){let si=ae.node.enter(gt.overlay[0].from+Le,1),rn=this.highlighters.filter(te=>!te.scope||te.scope(gt.tree.type)),Zi=ae.firstChild();for(let te=0,x=Le;;te++){let C=te<gt.overlay.length?gt.overlay[te]:null,I=C?C.from+Le:Yt,N=Math.max(be,x),Z=Math.min(ze,I);if(N<Z&&Zi)for(;ae.from<Z&&(this.highlightRange(ae,N,Z,ke,Ee),this.startSpan(Math.min(Z,ae.to),et),!(ae.to>=I||!ae.nextSibling())););if(!C||I>ze)break;x=C.to+Le,x>be&&(this.highlightRange(si.cursor(),Math.max(be,C.from+Le),Math.min(ze,x),"",rn),this.startSpan(Math.min(ze,x),et))}Zi&&ae.parent()}else if(ae.firstChild()){gt&&(ke="");do if(!(ae.to<=be)){if(ae.from>=ze)break;this.highlightRange(ae,be,ze,ke,Ee),this.startSpan(Math.min(ze,ae.to),et)}while(ae.nextSibling());ae.parent()}}}function Xt(Xe){let ae=Xe.type.prop(ft);for(;ae&&ae.context&&!Xe.matchContext(ae.context);)ae=ae.next;return ae||null}const me=ue.define,ut=me(),Kt=me(),bi=me(Kt),fi=me(Kt),Et=me(),ui=me(Et),Oi=me(Et),Pt=me(),Ot=me(Pt),Dt=me(),wt=me(),ai=me(),_t=me(ai),ei=me(),Ge={comment:ut,lineComment:me(ut),blockComment:me(ut),docComment:me(ut),name:Kt,variableName:me(Kt),typeName:bi,tagName:me(bi),propertyName:fi,attributeName:me(fi),className:me(Kt),labelName:me(Kt),namespace:me(Kt),macroName:me(Kt),literal:Et,string:ui,docString:me(ui),character:me(ui),attributeValue:me(ui),number:Oi,integer:me(Oi),float:me(Oi),bool:me(Et),regexp:me(Et),escape:me(Et),color:me(Et),url:me(Et),keyword:Dt,self:me(Dt),null:me(Dt),atom:me(Dt),unit:me(Dt),modifier:me(Dt),operatorKeyword:me(Dt),controlKeyword:me(Dt),definitionKeyword:me(Dt),moduleKeyword:me(Dt),operator:wt,derefOperator:me(wt),arithmeticOperator:me(wt),logicOperator:me(wt),bitwiseOperator:me(wt),compareOperator:me(wt),updateOperator:me(wt),definitionOperator:me(wt),typeOperator:me(wt),controlOperator:me(wt),punctuation:ai,separator:me(ai),bracket:_t,angleBracket:me(_t),squareBracket:me(_t),paren:me(_t),brace:me(_t),content:Pt,heading:Ot,heading1:me(Ot),heading2:me(Ot),heading3:me(Ot),heading4:me(Ot),heading5:me(Ot),heading6:me(Ot),contentSeparator:me(Pt),list:me(Pt),quote:me(Pt),emphasis:me(Pt),strong:me(Pt),link:me(Pt),monospace:me(Pt),strikethrough:me(Pt),inserted:me(),deleted:me(),changed:me(),invalid:me(),meta:ei,documentMeta:me(ei),annotation:me(ei),processingInstruction:me(ei),definition:ue.defineModifier(),constant:ue.defineModifier(),function:ue.defineModifier(),standard:ue.defineModifier(),local:ue.defineModifier(),special:ue.defineModifier()},Mi=Ze([{tag:Ge.link,class:"tok-link"},{tag:Ge.heading,class:"tok-heading"},{tag:Ge.emphasis,class:"tok-emphasis"},{tag:Ge.strong,class:"tok-strong"},{tag:Ge.keyword,class:"tok-keyword"},{tag:Ge.atom,class:"tok-atom"},{tag:Ge.bool,class:"tok-bool"},{tag:Ge.url,class:"tok-url"},{tag:Ge.labelName,class:"tok-labelName"},{tag:Ge.inserted,class:"tok-inserted"},{tag:Ge.deleted,class:"tok-deleted"},{tag:Ge.literal,class:"tok-literal"},{tag:Ge.string,class:"tok-string"},{tag:Ge.number,class:"tok-number"},{tag:[Ge.regexp,Ge.escape,Ge.special(Ge.string)],class:"tok-string2"},{tag:Ge.variableName,class:"tok-variableName"},{tag:Ge.local(Ge.variableName),class:"tok-variableName tok-local"},{tag:Ge.definition(Ge.variableName),class:"tok-variableName tok-definition"},{tag:Ge.special(Ge.variableName),class:"tok-variableName2"},{tag:Ge.definition(Ge.propertyName),class:"tok-propertyName tok-definition"},{tag:Ge.typeName,class:"tok-typeName"},{tag:Ge.namespace,class:"tok-namespace"},{tag:Ge.className,class:"tok-className"},{tag:Ge.macroName,class:"tok-macroName"},{tag:Ge.propertyName,class:"tok-propertyName"},{tag:Ge.operator,class:"tok-operator"},{tag:Ge.comment,class:"tok-comment"},{tag:Ge.meta,class:"tok-meta"},{tag:Ge.invalid,class:"tok-invalid"},{tag:Ge.punctuation,class:"tok-punctuation"}])},37207:(wn,Nt,q)=>{q.d(Nt,{V:()=>G});const p="\u037C",we=typeof Symbol=="undefined"?"__"+p:Symbol.for(p),ue=typeof Symbol=="undefined"?"__styleSet"+Math.floor(Math.random()*1e8):Symbol("styleSet"),L=typeof globalThis!="undefined"?globalThis:typeof window!="undefined"?window:{};class G{constructor(ft,xt){this.rules=[];let{finish:Ze}=xt||{};function nt(mt){return/^@/.test(mt)?[mt]:mt.split(/,\s*/)}function _e(mt,mi,Xt,me){let ut=[],Kt=/^@(\w+)\b/.exec(mt[0]),bi=Kt&&Kt[1]=="keyframes";if(Kt&&mi==null)return Xt.push(mt[0]+";");for(let fi in mi){let Et=mi[fi];if(/&/.test(fi))_e(fi.split(/,\s*/).map(ui=>mt.map(Oi=>ui.replace(/&/,Oi))).reduce((ui,Oi)=>ui.concat(Oi)),Et,Xt);else if(Et&&typeof Et=="object"){if(!Kt)throw new RangeError("The value of a property ("+fi+") should be a primitive value.");_e(nt(fi),Et,ut,bi)}else Et!=null&&ut.push(fi.replace(/_.*/,"").replace(/[A-Z]/g,ui=>"-"+ui.toLowerCase())+": "+Et+";")}(ut.length||bi)&&Xt.push((Ze&&!Kt&&!me?mt.map(Ze):mt).join(", ")+" {"+ut.join(" ")+"}")}for(let mt in ft)_e(nt(mt),ft[mt],this.rules)}getRules(){return this.rules.join(`
`)}static newName(){let ft=L[we]||1;return L[we]=ft+1,p+ft.toString(36)}static mount(ft,xt,Ze){let nt=ft[ue],_e=Ze&&Ze.nonce;nt?_e&&nt.setNonce(_e):nt=new Fe(ft,_e),nt.mount(Array.isArray(xt)?xt:[xt])}}let Se=new Map;class Fe{constructor(ft,xt){let Ze=ft.ownerDocument||ft,nt=Ze.defaultView;if(!ft.head&&ft.adoptedStyleSheets&&nt.CSSStyleSheet){let _e=Se.get(Ze);if(_e)return ft.adoptedStyleSheets=[_e.sheet,...ft.adoptedStyleSheets],ft[ue]=_e;this.sheet=new nt.CSSStyleSheet,ft.adoptedStyleSheets=[this.sheet,...ft.adoptedStyleSheets],Se.set(Ze,this)}else{this.styleTag=Ze.createElement("style"),xt&&this.styleTag.setAttribute("nonce",xt);let _e=ft.head||ft;_e.insertBefore(this.styleTag,_e.firstChild)}this.modules=[],ft[ue]=this}mount(ft){let xt=this.sheet,Ze=0,nt=0;for(let _e=0;_e<ft.length;_e++){let mt=ft[_e],mi=this.modules.indexOf(mt);if(mi<nt&&mi>-1&&(this.modules.splice(mi,1),nt--,mi=-1),mi==-1){if(this.modules.splice(nt++,0,mt),xt)for(let Xt=0;Xt<mt.rules.length;Xt++)xt.insertRule(mt.rules[Xt],Ze++)}else{for(;nt<mi;)Ze+=this.modules[nt++].rules.length;Ze+=mt.rules.length,nt++}}if(!xt){let _e="";for(let mt=0;mt<this.modules.length;mt++)_e+=this.modules[mt].getRules()+`
`;this.styleTag.textContent=_e}}setNonce(ft){this.styleTag&&this.styleTag.getAttribute("nonce")!=ft&&this.styleTag.setAttribute("nonce",ft)}}}}]);})();

//# sourceMappingURL=3761.089fd553.chunk.js.map